Fold 0
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Fold 0
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Fold 0
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 3.313648
Validation R2 Energy = 0.439028
Epoch 1
Train function
Loss = 1.0485e-02, PNorm = 52.9608, GNorm = 2.4521, lr_0 = 8.7143e-04
Validation rmse Energy = 3.294740
Validation R2 Energy = 0.445412
Epoch 2
Train function
Loss = 8.4547e-03, PNorm = 53.0846, GNorm = 1.9141, lr_0 = 9.7024e-04
Validation rmse Energy = 2.496247
Validation R2 Energy = 0.681651
Epoch 3
Train function
Validation rmse Energy = 2.044385
Validation R2 Energy = 0.786473
Epoch 4
Train function
Loss = 2.7032e-03, PNorm = 53.2070, GNorm = 3.0637, lr_0 = 9.3194e-04
Validation rmse Energy = 1.705182
Validation R2 Energy = 0.851451
Epoch 5
Train function
Loss = 2.5567e-03, PNorm = 53.2762, GNorm = 2.3765, lr_0 = 9.0118e-04
Validation rmse Energy = 1.650381
Validation R2 Energy = 0.860846
Epoch 6
Train function
Loss = 1.6311e-03, PNorm = 53.3382, GNorm = 0.3369, lr_0 = 8.6851e-04
Loss = 5.8410e-03, PNorm = 53.3418, GNorm = 2.0214, lr_0 = 8.6560e-04
Validation rmse Energy = 1.492334
Validation R2 Energy = 0.886221
Epoch 7
Train function
Validation rmse Energy = 1.405947
Validation R2 Energy = 0.899013
Epoch 8
Train function
Loss = 1.0288e-03, PNorm = 53.3851, GNorm = 1.1374, lr_0 = 8.3422e-04
Validation rmse Energy = 1.322259
Validation R2 Energy = 0.910677
Epoch 9
Train function
Loss = 8.7018e-04, PNorm = 53.4218, GNorm = 0.5723, lr_0 = 8.0398e-04
Validation rmse Energy = 1.325133
Validation R2 Energy = 0.910289
Epoch 10
Train function
Validation rmse Energy = 1.322428
Validation R2 Energy = 0.910654
Epoch 11
Train function
Loss = 7.0054e-04, PNorm = 53.4517, GNorm = 0.7831, lr_0 = 7.7484e-04
Validation rmse Energy = 1.514850
Validation R2 Energy = 0.882762
Epoch 12
Train function
Loss = 7.9527e-04, PNorm = 53.4846, GNorm = 0.7329, lr_0 = 7.4675e-04
Validation rmse Energy = 1.395051
Validation R2 Energy = 0.900572
Epoch 13
Train function
Loss = 7.4102e-04, PNorm = 53.5134, GNorm = 1.0132, lr_0 = 7.1969e-04
Loss = 3.0611e-03, PNorm = 53.5159, GNorm = 1.2103, lr_0 = 7.1727e-04
Validation rmse Energy = 1.350317
Validation R2 Energy = 0.906846
Epoch 14
Train function
Validation rmse Energy = 1.270140
Validation R2 Energy = 0.917580
Epoch 15
Train function
Loss = 4.8416e-04, PNorm = 53.5445, GNorm = 0.7721, lr_0 = 6.9360e-04
Validation rmse Energy = 1.297142
Validation R2 Energy = 0.914039
Epoch 16
Train function
Loss = 3.8536e-04, PNorm = 53.5647, GNorm = 0.2832, lr_0 = 6.6846e-04
Validation rmse Energy = 1.238393
Validation R2 Energy = 0.921649
Epoch 17
Train function
Validation rmse Energy = 1.211859
Validation R2 Energy = 0.924970
Epoch 18
Train function
Loss = 2.7033e-04, PNorm = 53.5955, GNorm = 0.5899, lr_0 = 6.4207e-04
Validation rmse Energy = 1.223842
Validation R2 Energy = 0.923479
Epoch 19
Train function
Loss = 2.8479e-04, PNorm = 53.6185, GNorm = 0.4464, lr_0 = 6.1879e-04
Validation rmse Energy = 1.231803
Validation R2 Energy = 0.922481
Epoch 20
Train function
Loss = 2.4224e-04, PNorm = 53.6390, GNorm = 0.1722, lr_0 = 5.9837e-04
Validation rmse Energy = 1.194123
Validation R2 Energy = 0.927151
Epoch 21
Train function
Validation rmse Energy = 1.191383
Validation R2 Energy = 0.927484
Epoch 22
Train function
Loss = 2.1566e-04, PNorm = 53.6639, GNorm = 0.3489, lr_0 = 5.7475e-04
Validation rmse Energy = 1.163120
Validation R2 Energy = 0.930884
Epoch 23
Train function
Loss = 1.4608e-04, PNorm = 53.6839, GNorm = 0.1657, lr_0 = 5.5391e-04
Validation rmse Energy = 1.168433
Validation R2 Energy = 0.930251
Epoch 24
Train function
Loss = 1.5589e-04, PNorm = 53.6991, GNorm = 0.5874, lr_0 = 5.3383e-04
Validation rmse Energy = 1.169737
Validation R2 Energy = 0.930096
Epoch 25
Train function
Validation rmse Energy = 1.159039
Validation R2 Energy = 0.931368
Epoch 26
Train function
Loss = 1.0040e-04, PNorm = 53.7165, GNorm = 0.2360, lr_0 = 5.1448e-04
Validation rmse Energy = 1.175594
Validation R2 Energy = 0.929394
Epoch 27
Train function
Loss = 1.1704e-04, PNorm = 53.7301, GNorm = 0.6324, lr_0 = 4.9583e-04
Validation rmse Energy = 1.151259
Validation R2 Energy = 0.932287
Epoch 28
Train function
Validation rmse Energy = 1.154523
Validation R2 Energy = 0.931902
Epoch 29
Train function
Loss = 9.9175e-05, PNorm = 53.7457, GNorm = 0.4523, lr_0 = 4.7626e-04
Validation rmse Energy = 1.149662
Validation R2 Energy = 0.932474
Epoch 30
Train function
Loss = 7.3406e-05, PNorm = 53.7572, GNorm = 0.1031, lr_0 = 4.6054e-04
Validation rmse Energy = 1.129816
Validation R2 Energy = 0.934786
Epoch 31
Train function
Loss = 8.1162e-05, PNorm = 53.7663, GNorm = 0.2067, lr_0 = 4.4384e-04
Loss = 2.3998e-04, PNorm = 53.7670, GNorm = 0.2436, lr_0 = 4.4236e-04
Validation rmse Energy = 1.140012
Validation R2 Energy = 0.933603
Epoch 32
Train function
Validation rmse Energy = 1.142289
Validation R2 Energy = 0.933338
Epoch 33
Train function
Loss = 5.0071e-05, PNorm = 53.7747, GNorm = 0.1687, lr_0 = 4.2632e-04
Validation rmse Energy = 1.126596
Validation R2 Energy = 0.935157
Epoch 34
Train function
Loss = 7.6274e-05, PNorm = 53.7841, GNorm = 0.2864, lr_0 = 4.1087e-04
Validation rmse Energy = 1.140534
Validation R2 Energy = 0.933542
Epoch 35
Train function
Validation rmse Energy = 1.117238
Validation R2 Energy = 0.936230
Epoch 36
Train function
Loss = 5.4743e-05, PNorm = 53.7947, GNorm = 0.2473, lr_0 = 3.9597e-04
Validation rmse Energy = 1.134384
Validation R2 Energy = 0.934257
Epoch 37
Train function
Loss = 3.8920e-05, PNorm = 53.8026, GNorm = 0.0446, lr_0 = 3.8162e-04
Validation rmse Energy = 1.131622
Validation R2 Energy = 0.934577
Epoch 38
Train function
Loss = 3.8091e-05, PNorm = 53.8096, GNorm = 0.0840, lr_0 = 3.6779e-04
Loss = 1.5158e-04, PNorm = 53.8100, GNorm = 0.2493, lr_0 = 3.6656e-04
Validation rmse Energy = 1.144159
Validation R2 Energy = 0.933119
Epoch 39
Train function
Validation rmse Energy = 1.135410
Validation R2 Energy = 0.934138
Epoch 40
Train function
Loss = 3.7869e-05, PNorm = 53.8154, GNorm = 0.1179, lr_0 = 3.5446e-04
Validation rmse Energy = 1.128639
Validation R2 Energy = 0.934921
Epoch 41
Train function
Loss = 3.3600e-05, PNorm = 53.8219, GNorm = 0.0596, lr_0 = 3.4161e-04
Validation rmse Energy = 1.129412
Validation R2 Energy = 0.934832
Epoch 42
Train function
Validation rmse Energy = 1.136551
Validation R2 Energy = 0.934006
Epoch 43
Train function
Loss = 1.5405e-05, PNorm = 53.8272, GNorm = 0.0632, lr_0 = 3.2812e-04
Validation rmse Energy = 1.138387
Validation R2 Energy = 0.933792
Epoch 44
Train function
Loss = 3.3648e-05, PNorm = 53.8327, GNorm = 0.0976, lr_0 = 3.1623e-04
Validation rmse Energy = 1.136965
Validation R2 Energy = 0.933958
Epoch 45
Train function
Loss = 2.9960e-05, PNorm = 53.8374, GNorm = 0.0773, lr_0 = 3.0579e-04
Validation rmse Energy = 1.142422
Validation R2 Energy = 0.933322
Epoch 46
Train function
Validation rmse Energy = 1.135762
Validation R2 Energy = 0.934097
Epoch 47
Train function
Loss = 3.2142e-05, PNorm = 53.8424, GNorm = 0.1119, lr_0 = 2.9372e-04
Validation rmse Energy = 1.138554
Validation R2 Energy = 0.933773
Epoch 48
Train function
Loss = 2.4516e-05, PNorm = 53.8467, GNorm = 0.0891, lr_0 = 2.8307e-04
Validation rmse Energy = 1.129457
Validation R2 Energy = 0.934827
Epoch 49
Train function
Loss = 2.4312e-05, PNorm = 53.8507, GNorm = 0.0770, lr_0 = 2.7281e-04
Validation rmse Energy = 1.125233
Validation R2 Energy = 0.935314
Epoch 50
Train function
Validation rmse Energy = 1.132843
Validation R2 Energy = 0.934436
Epoch 51
Train function
Loss = 1.7122e-05, PNorm = 53.8541, GNorm = 0.2344, lr_0 = 2.6292e-04
Validation rmse Energy = 1.148426
Validation R2 Energy = 0.932620
Epoch 52
Train function
Loss = 2.4998e-05, PNorm = 53.8572, GNorm = 0.0539, lr_0 = 2.5339e-04
Validation rmse Energy = 1.137503
Validation R2 Energy = 0.933895
Epoch 53
Train function
Validation rmse Energy = 1.132806
Validation R2 Energy = 0.934440
Epoch 54
Train function
Loss = 2.0881e-05, PNorm = 53.8610, GNorm = 0.0352, lr_0 = 2.4339e-04
Validation rmse Energy = 1.126599
Validation R2 Energy = 0.935156
Epoch 55
Train function
Loss = 1.4810e-05, PNorm = 53.8639, GNorm = 0.0573, lr_0 = 2.3535e-04
Validation rmse Energy = 1.128037
Validation R2 Energy = 0.934991
Epoch 56
Train function
Loss = 1.8999e-05, PNorm = 53.8668, GNorm = 0.0720, lr_0 = 2.2682e-04
Loss = 6.9916e-05, PNorm = 53.8671, GNorm = 0.1767, lr_0 = 2.2606e-04
Validation rmse Energy = 1.126690
Validation R2 Energy = 0.935146
Epoch 57
Train function
Validation rmse Energy = 1.131792
Validation R2 Energy = 0.934557
Epoch 58
Train function
Loss = 2.4477e-05, PNorm = 53.8696, GNorm = 0.1620, lr_0 = 2.1787e-04
Validation rmse Energy = 1.130072
Validation R2 Energy = 0.934756
Epoch 59
Train function
Loss = 1.6980e-05, PNorm = 53.8718, GNorm = 0.0542, lr_0 = 2.0997e-04
Validation rmse Energy = 1.125854
Validation R2 Energy = 0.935242
Epoch 60
Train function
Validation rmse Energy = 1.131846
Validation R2 Energy = 0.934551
Epoch 61
Train function
Loss = 1.5729e-05, PNorm = 53.8746, GNorm = 0.0535, lr_0 = 2.0236e-04
Validation rmse Energy = 1.127252
Validation R2 Energy = 0.935081
Epoch 62
Train function
Loss = 1.7946e-05, PNorm = 53.8771, GNorm = 0.1303, lr_0 = 1.9502e-04
Validation rmse Energy = 1.135024
Validation R2 Energy = 0.934183
Epoch 63
Train function
Loss = 1.6450e-05, PNorm = 53.8795, GNorm = 0.0453, lr_0 = 1.8795e-04
Loss = 2.0211e-05, PNorm = 53.8797, GNorm = 0.0500, lr_0 = 1.8732e-04
Validation rmse Energy = 1.132512
Validation R2 Energy = 0.934474
Epoch 64
Train function
Validation rmse Energy = 1.130185
Validation R2 Energy = 0.934743
Epoch 65
Train function
Loss = 1.8712e-05, PNorm = 53.8813, GNorm = 0.0297, lr_0 = 1.8114e-04
Validation rmse Energy = 1.128020
Validation R2 Energy = 0.934993
Epoch 66
Train function
Loss = 9.8954e-06, PNorm = 53.8832, GNorm = 0.0896, lr_0 = 1.7458e-04
Validation rmse Energy = 1.126890
Validation R2 Energy = 0.935123
Epoch 67
Train function
Validation rmse Energy = 1.138128
Validation R2 Energy = 0.933823
Epoch 68
Train function
Loss = 1.5954e-05, PNorm = 53.8853, GNorm = 0.0957, lr_0 = 1.6768e-04
Validation rmse Energy = 1.130781
Validation R2 Energy = 0.934674
Epoch 69
Train function
Loss = 1.6091e-05, PNorm = 53.8869, GNorm = 0.0493, lr_0 = 1.6161e-04
Validation rmse Energy = 1.128696
Validation R2 Energy = 0.934915
Epoch 70
Train function
Loss = 1.3939e-05, PNorm = 53.8884, GNorm = 0.0404, lr_0 = 1.5627e-04
Validation rmse Energy = 1.135752
Validation R2 Energy = 0.934098
Epoch 71
Train function
Validation rmse Energy = 1.132728
Validation R2 Energy = 0.934449
Epoch 72
Train function
Loss = 1.3534e-05, PNorm = 53.8896, GNorm = 0.1013, lr_0 = 1.5010e-04
Validation rmse Energy = 1.132335
Validation R2 Energy = 0.934494
Epoch 73
Train function
Loss = 1.3199e-05, PNorm = 53.8919, GNorm = 0.0700, lr_0 = 1.4466e-04
Validation rmse Energy = 1.127491
Validation R2 Energy = 0.935054
Epoch 74
Train function
Loss = 1.3905e-05, PNorm = 53.8935, GNorm = 0.0746, lr_0 = 1.3942e-04
Validation rmse Energy = 1.132024
Validation R2 Energy = 0.934530
Epoch 75
Train function
Validation rmse Energy = 1.129780
Validation R2 Energy = 0.934790
Epoch 76
Train function
Loss = 1.2488e-05, PNorm = 53.8946, GNorm = 0.0472, lr_0 = 1.3436e-04
Validation rmse Energy = 1.131293
Validation R2 Energy = 0.934615
Epoch 77
Train function
Loss = 1.3746e-05, PNorm = 53.8960, GNorm = 0.0553, lr_0 = 1.2949e-04
Validation rmse Energy = 1.128461
Validation R2 Energy = 0.934942
Epoch 78
Train function
Validation rmse Energy = 1.132628
Validation R2 Energy = 0.934461
Epoch 79
Train function
Loss = 1.3095e-05, PNorm = 53.8971, GNorm = 0.0678, lr_0 = 1.2438e-04
Validation rmse Energy = 1.130713
Validation R2 Energy = 0.934682
Epoch 80
Train function
Loss = 1.0982e-05, PNorm = 53.8982, GNorm = 0.0315, lr_0 = 1.2027e-04
Validation rmse Energy = 1.131179
Validation R2 Energy = 0.934628
Epoch 81
Train function
Loss = 1.2461e-05, PNorm = 53.8992, GNorm = 0.1928, lr_0 = 1.1592e-04
Loss = 1.3212e-05, PNorm = 53.8993, GNorm = 0.0319, lr_0 = 1.1553e-04
Validation rmse Energy = 1.131390
Validation R2 Energy = 0.934604
Epoch 82
Train function
Validation rmse Energy = 1.131236
Validation R2 Energy = 0.934622
Epoch 83
Train function
Loss = 1.5572e-05, PNorm = 53.9006, GNorm = 0.0427, lr_0 = 1.1134e-04
Validation rmse Energy = 1.126645
Validation R2 Energy = 0.935151
Epoch 84
Train function
Loss = 1.0960e-05, PNorm = 53.9017, GNorm = 0.0645, lr_0 = 1.0730e-04
Validation rmse Energy = 1.130516
Validation R2 Energy = 0.934705
Epoch 85
Train function
Validation rmse Energy = 1.129628
Validation R2 Energy = 0.934807
Epoch 86
Train function
Loss = 7.0709e-06, PNorm = 53.9027, GNorm = 0.0266, lr_0 = 1.0341e-04
Validation rmse Energy = 1.122797
Validation R2 Energy = 0.935593
Epoch 87
Train function
Loss = 1.4555e-05, PNorm = 53.9037, GNorm = 0.1277, lr_0 = 1.0000e-04
Validation rmse Energy = 1.145447
Validation R2 Energy = 0.932969
Epoch 88
Train function
Loss = 1.5057e-05, PNorm = 53.9047, GNorm = 0.1468, lr_0 = 1.0000e-04
Loss = 2.4612e-05, PNorm = 53.9047, GNorm = 0.1463, lr_0 = 1.0000e-04
Validation rmse Energy = 1.126220
Validation R2 Energy = 0.935200
Epoch 89
Train function
Validation rmse Energy = 1.124909
Validation R2 Energy = 0.935351
Epoch 90
Train function
Loss = 5.5622e-06, PNorm = 53.9056, GNorm = 0.0621, lr_0 = 1.0000e-04
Validation rmse Energy = 1.130786
Validation R2 Energy = 0.934674
Epoch 91
Train function
Loss = 1.0205e-05, PNorm = 53.9066, GNorm = 0.0300, lr_0 = 1.0000e-04
Validation rmse Energy = 1.130707
Validation R2 Energy = 0.934683
Epoch 92
Train function
Validation rmse Energy = 1.130490
Validation R2 Energy = 0.934708
Epoch 93
Train function
Loss = 1.2754e-05, PNorm = 53.9075, GNorm = 0.0437, lr_0 = 1.0000e-04
Validation rmse Energy = 1.125998
Validation R2 Energy = 0.935226
Epoch 94
Train function
Loss = 6.9822e-06, PNorm = 53.9084, GNorm = 0.0694, lr_0 = 1.0000e-04
Validation rmse Energy = 1.127493
Validation R2 Energy = 0.935053
Epoch 95
Train function
Loss = 9.8885e-06, PNorm = 53.9093, GNorm = 0.0302, lr_0 = 1.0000e-04
Validation rmse Energy = 1.127641
Validation R2 Energy = 0.935036
Epoch 96
Train function
Validation rmse Energy = 1.131510
Validation R2 Energy = 0.934590
Epoch 97
Train function
Loss = 1.0697e-05, PNorm = 53.9102, GNorm = 0.0727, lr_0 = 1.0000e-04
Validation rmse Energy = 1.130172
Validation R2 Energy = 0.934744
Epoch 98
Train function
Loss = 1.2195e-05, PNorm = 53.9111, GNorm = 0.0199, lr_0 = 1.0000e-04
Validation rmse Energy = 1.127857
Validation R2 Energy = 0.935012
Epoch 99
Train function
Loss = 1.5672e-05, PNorm = 53.9120, GNorm = 0.2946, lr_0 = 1.0000e-04
Validation rmse Energy = 1.132974
Validation R2 Energy = 0.934420
Model 0 best validation rmse = 1.117238 on epoch 35
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.118383
Model 0 test R2 Energy = 0.925172
Ensemble test rmse  Energy= 1.118383
Ensemble test R2  Energy= 0.925172
Fold 1
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 199,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 360,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 2.325074
Validation R2 Energy = 0.563760
Epoch 1
Train function
Loss = 9.9156e-03, PNorm = 52.9584, GNorm = 4.2657, lr_0 = 8.7143e-04
Validation rmse Energy = 2.364207
Validation R2 Energy = 0.548953
Epoch 2
Train function
Loss = 6.1313e-03, PNorm = 53.0950, GNorm = 3.2646, lr_0 = 9.7024e-04
Validation rmse Energy = 2.096736
Validation R2 Energy = 0.645236
Epoch 3
Train function
Validation rmse Energy = 1.418095
Validation R2 Energy = 0.837721
Epoch 4
Train function
Loss = 3.0222e-03, PNorm = 53.2168, GNorm = 2.2792, lr_0 = 9.3194e-04
Validation rmse Energy = 1.394097
Validation R2 Energy = 0.843167
Epoch 5
Train function
Loss = 1.7347e-03, PNorm = 53.2802, GNorm = 2.3755, lr_0 = 9.0118e-04
Validation rmse Energy = 1.434444
Validation R2 Energy = 0.833958
Epoch 6
Train function
Loss = 1.6792e-03, PNorm = 53.3220, GNorm = 1.5114, lr_0 = 8.6851e-04
Loss = 1.1807e-02, PNorm = 53.3262, GNorm = 2.1385, lr_0 = 8.6560e-04
Validation rmse Energy = 1.052526
Validation R2 Energy = 0.910604
Epoch 7
Train function
Validation rmse Energy = 1.089465
Validation R2 Energy = 0.904219
Epoch 8
Train function
Loss = 7.2023e-04, PNorm = 53.3649, GNorm = 0.4866, lr_0 = 8.3422e-04
Validation rmse Energy = 1.096253
Validation R2 Energy = 0.903022
Epoch 9
Train function
Loss = 7.4664e-04, PNorm = 53.3911, GNorm = 0.5600, lr_0 = 8.0398e-04
Validation rmse Energy = 1.003795
Validation R2 Energy = 0.918690
Epoch 10
Train function
Validation rmse Energy = 0.992956
Validation R2 Energy = 0.920437
Epoch 11
Train function
Loss = 6.5308e-04, PNorm = 53.4209, GNorm = 0.4012, lr_0 = 7.7484e-04
Validation rmse Energy = 0.935015
Validation R2 Energy = 0.929451
Epoch 12
Train function
Loss = 5.3777e-04, PNorm = 53.4444, GNorm = 0.8960, lr_0 = 7.4675e-04
Validation rmse Energy = 0.928715
Validation R2 Energy = 0.930399
Epoch 13
Train function
Loss = 4.4840e-04, PNorm = 53.4685, GNorm = 0.4497, lr_0 = 7.1969e-04
Loss = 4.0929e-03, PNorm = 53.4704, GNorm = 1.6728, lr_0 = 7.1727e-04
Validation rmse Energy = 0.915706
Validation R2 Energy = 0.932335
Epoch 14
Train function
Validation rmse Energy = 0.878854
Validation R2 Energy = 0.937672
Epoch 15
Train function
Loss = 3.8445e-04, PNorm = 53.4903, GNorm = 0.3014, lr_0 = 6.9360e-04
Validation rmse Energy = 0.921199
Validation R2 Energy = 0.931521
Epoch 16
Train function
Loss = 3.6619e-04, PNorm = 53.5154, GNorm = 0.7357, lr_0 = 6.6846e-04
Validation rmse Energy = 0.858958
Validation R2 Energy = 0.940462
Epoch 17
Train function
Validation rmse Energy = 0.808492
Validation R2 Energy = 0.947252
Epoch 18
Train function
Loss = 2.2292e-04, PNorm = 53.5407, GNorm = 0.2112, lr_0 = 6.4207e-04
Validation rmse Energy = 0.826952
Validation R2 Energy = 0.944816
Epoch 19
Train function
Loss = 2.2526e-04, PNorm = 53.5619, GNorm = 0.1208, lr_0 = 6.1879e-04
Validation rmse Energy = 0.823056
Validation R2 Energy = 0.945335
Epoch 20
Train function
Loss = 1.9801e-04, PNorm = 53.5792, GNorm = 0.2746, lr_0 = 5.9837e-04
Validation rmse Energy = 0.804166
Validation R2 Energy = 0.947815
Epoch 21
Train function
Validation rmse Energy = 0.842411
Validation R2 Energy = 0.942734
Epoch 22
Train function
Loss = 1.7505e-04, PNorm = 53.6000, GNorm = 0.5888, lr_0 = 5.7475e-04
Validation rmse Energy = 0.818288
Validation R2 Energy = 0.945966
Epoch 23
Train function
Loss = 1.6682e-04, PNorm = 53.6145, GNorm = 0.2524, lr_0 = 5.5391e-04
Validation rmse Energy = 0.788478
Validation R2 Energy = 0.949832
Epoch 24
Train function
Loss = 2.0208e-04, PNorm = 53.6281, GNorm = 0.2703, lr_0 = 5.3383e-04
Validation rmse Energy = 0.779408
Validation R2 Energy = 0.950979
Epoch 25
Train function
Validation rmse Energy = 0.755591
Validation R2 Energy = 0.953929
Epoch 26
Train function
Loss = 1.7796e-04, PNorm = 53.6488, GNorm = 0.1773, lr_0 = 5.1448e-04
Validation rmse Energy = 0.797413
Validation R2 Energy = 0.948688
Epoch 27
Train function
Loss = 1.2211e-04, PNorm = 53.6603, GNorm = 0.2129, lr_0 = 4.9583e-04
Validation rmse Energy = 0.754664
Validation R2 Energy = 0.954042
Epoch 28
Train function
Validation rmse Energy = 0.770993
Validation R2 Energy = 0.952032
Epoch 29
Train function
Loss = 8.2880e-05, PNorm = 53.6754, GNorm = 0.2360, lr_0 = 4.7626e-04
Validation rmse Energy = 0.744608
Validation R2 Energy = 0.955259
Epoch 30
Train function
Loss = 8.5609e-05, PNorm = 53.6847, GNorm = 0.1450, lr_0 = 4.6054e-04
Validation rmse Energy = 0.765832
Validation R2 Energy = 0.952672
Epoch 31
Train function
Loss = 7.7233e-05, PNorm = 53.6942, GNorm = 0.2342, lr_0 = 4.4384e-04
Loss = 1.5801e-04, PNorm = 53.6952, GNorm = 0.1514, lr_0 = 4.4236e-04
Validation rmse Energy = 0.734162
Validation R2 Energy = 0.956505
Epoch 32
Train function
Validation rmse Energy = 0.730472
Validation R2 Energy = 0.956942
Epoch 33
Train function
Loss = 5.4643e-05, PNorm = 53.7044, GNorm = 0.1232, lr_0 = 4.2632e-04
Validation rmse Energy = 0.728616
Validation R2 Energy = 0.957160
Epoch 34
Train function
Loss = 7.6359e-05, PNorm = 53.7143, GNorm = 0.1216, lr_0 = 4.1087e-04
Validation rmse Energy = 0.751059
Validation R2 Energy = 0.954480
Epoch 35
Train function
Validation rmse Energy = 0.790320
Validation R2 Energy = 0.949597
Epoch 36
Train function
Loss = 1.8158e-04, PNorm = 53.7221, GNorm = 0.9982, lr_0 = 3.9597e-04
Validation rmse Energy = 0.758167
Validation R2 Energy = 0.953615
Epoch 37
Train function
Loss = 7.1178e-05, PNorm = 53.7318, GNorm = 0.2830, lr_0 = 3.8162e-04
Validation rmse Energy = 0.743603
Validation R2 Energy = 0.955380
Epoch 38
Train function
Loss = 7.5010e-05, PNorm = 53.7418, GNorm = 0.1149, lr_0 = 3.6779e-04
Loss = 6.6440e-04, PNorm = 53.7424, GNorm = 0.3858, lr_0 = 3.6656e-04
Validation rmse Energy = 0.726285
Validation R2 Energy = 0.957434
Epoch 39
Train function
Validation rmse Energy = 0.731752
Validation R2 Energy = 0.956790
Epoch 40
Train function
Loss = 6.4012e-05, PNorm = 53.7492, GNorm = 0.2507, lr_0 = 3.5446e-04
Validation rmse Energy = 0.714504
Validation R2 Energy = 0.958803
Epoch 41
Train function
Loss = 5.5828e-05, PNorm = 53.7566, GNorm = 0.3073, lr_0 = 3.4161e-04
Validation rmse Energy = 0.740231
Validation R2 Energy = 0.955783
Epoch 42
Train function
Validation rmse Energy = 0.714444
Validation R2 Energy = 0.958810
Epoch 43
Train function
Loss = 3.4891e-05, PNorm = 53.7639, GNorm = 0.1440, lr_0 = 3.2812e-04
Validation rmse Energy = 0.708084
Validation R2 Energy = 0.959541
Epoch 44
Train function
Loss = 4.3179e-05, PNorm = 53.7693, GNorm = 0.2721, lr_0 = 3.1623e-04
Validation rmse Energy = 0.712882
Validation R2 Energy = 0.958990
Epoch 45
Train function
Loss = 5.0551e-05, PNorm = 53.7741, GNorm = 0.4011, lr_0 = 3.0579e-04
Validation rmse Energy = 0.707861
Validation R2 Energy = 0.959566
Epoch 46
Train function
Validation rmse Energy = 0.713948
Validation R2 Energy = 0.958868
Epoch 47
Train function
Loss = 4.2925e-05, PNorm = 53.7793, GNorm = 0.0863, lr_0 = 2.9372e-04
Validation rmse Energy = 0.705041
Validation R2 Energy = 0.959887
Epoch 48
Train function
Loss = 3.4454e-05, PNorm = 53.7832, GNorm = 0.3139, lr_0 = 2.8307e-04
Validation rmse Energy = 0.704747
Validation R2 Energy = 0.959921
Epoch 49
Train function
Loss = 4.6123e-05, PNorm = 53.7878, GNorm = 0.6594, lr_0 = 2.7281e-04
Validation rmse Energy = 0.704119
Validation R2 Energy = 0.959992
Epoch 50
Train function
Validation rmse Energy = 0.693379
Validation R2 Energy = 0.961203
Epoch 51
Train function
Loss = 3.4041e-05, PNorm = 53.7915, GNorm = 0.3640, lr_0 = 2.6292e-04
Validation rmse Energy = 0.711715
Validation R2 Energy = 0.959124
Epoch 52
Train function
Loss = 3.2081e-05, PNorm = 53.7965, GNorm = 0.2500, lr_0 = 2.5339e-04
Validation rmse Energy = 0.706886
Validation R2 Energy = 0.959677
Epoch 53
Train function
Validation rmse Energy = 0.702487
Validation R2 Energy = 0.960178
Epoch 54
Train function
Loss = 5.0397e-05, PNorm = 53.7999, GNorm = 0.3481, lr_0 = 2.4339e-04
Validation rmse Energy = 0.694965
Validation R2 Energy = 0.961026
Epoch 55
Train function
Loss = 2.6372e-05, PNorm = 53.8030, GNorm = 0.0927, lr_0 = 2.3535e-04
Validation rmse Energy = 0.697232
Validation R2 Energy = 0.960771
Epoch 56
Train function
Loss = 2.5393e-05, PNorm = 53.8064, GNorm = 0.2636, lr_0 = 2.2682e-04
Loss = 5.4223e-05, PNorm = 53.8067, GNorm = 0.1069, lr_0 = 2.2606e-04
Validation rmse Energy = 0.696141
Validation R2 Energy = 0.960894
Epoch 57
Train function
Validation rmse Energy = 0.694077
Validation R2 Energy = 0.961125
Epoch 58
Train function
Loss = 2.3771e-05, PNorm = 53.8094, GNorm = 0.0495, lr_0 = 2.1787e-04
Validation rmse Energy = 0.694412
Validation R2 Energy = 0.961088
Epoch 59
Train function
Loss = 2.0907e-05, PNorm = 53.8124, GNorm = 0.0684, lr_0 = 2.0997e-04
Validation rmse Energy = 0.699875
Validation R2 Energy = 0.960473
Epoch 60
Train function
Validation rmse Energy = 0.696754
Validation R2 Energy = 0.960825
Epoch 61
Train function
Loss = 1.6703e-05, PNorm = 53.8151, GNorm = 0.1555, lr_0 = 2.0236e-04
Validation rmse Energy = 0.696585
Validation R2 Energy = 0.960844
Epoch 62
Train function
Loss = 1.5653e-05, PNorm = 53.8177, GNorm = 0.0469, lr_0 = 1.9502e-04
Validation rmse Energy = 0.697907
Validation R2 Energy = 0.960695
Epoch 63
Train function
Loss = 2.2798e-05, PNorm = 53.8205, GNorm = 0.2806, lr_0 = 1.8795e-04
Loss = 6.4332e-05, PNorm = 53.8207, GNorm = 0.1189, lr_0 = 1.8732e-04
Validation rmse Energy = 0.694609
Validation R2 Energy = 0.961066
Epoch 64
Train function
Validation rmse Energy = 0.704996
Validation R2 Energy = 0.959893
Epoch 65
Train function
Loss = 3.0084e-05, PNorm = 53.8226, GNorm = 0.0632, lr_0 = 1.8114e-04
Validation rmse Energy = 0.694398
Validation R2 Energy = 0.961089
Epoch 66
Train function
Loss = 2.0339e-05, PNorm = 53.8243, GNorm = 0.2049, lr_0 = 1.7458e-04
Validation rmse Energy = 0.704754
Validation R2 Energy = 0.959920
Epoch 67
Train function
Validation rmse Energy = 0.696336
Validation R2 Energy = 0.960872
Epoch 68
Train function
Loss = 1.8077e-05, PNorm = 53.8269, GNorm = 0.0598, lr_0 = 1.6768e-04
Validation rmse Energy = 0.693396
Validation R2 Energy = 0.961202
Epoch 69
Train function
Loss = 2.0485e-05, PNorm = 53.8291, GNorm = 0.0923, lr_0 = 1.6161e-04
Validation rmse Energy = 0.693164
Validation R2 Energy = 0.961228
Epoch 70
Train function
Loss = 2.1040e-05, PNorm = 53.8310, GNorm = 0.2046, lr_0 = 1.5627e-04
Validation rmse Energy = 0.692344
Validation R2 Energy = 0.961319
Epoch 71
Train function
Validation rmse Energy = 0.692216
Validation R2 Energy = 0.961333
Epoch 72
Train function
Loss = 1.5408e-05, PNorm = 53.8326, GNorm = 0.0518, lr_0 = 1.5010e-04
Validation rmse Energy = 0.691465
Validation R2 Energy = 0.961417
Epoch 73
Train function
Loss = 1.8641e-05, PNorm = 53.8348, GNorm = 0.1507, lr_0 = 1.4466e-04
Validation rmse Energy = 0.697056
Validation R2 Energy = 0.960791
Epoch 74
Train function
Loss = 1.5722e-05, PNorm = 53.8364, GNorm = 0.0515, lr_0 = 1.3942e-04
Validation rmse Energy = 0.691246
Validation R2 Energy = 0.961442
Epoch 75
Train function
Validation rmse Energy = 0.688495
Validation R2 Energy = 0.961748
Epoch 76
Train function
Loss = 1.1179e-05, PNorm = 53.8376, GNorm = 0.0392, lr_0 = 1.3436e-04
Validation rmse Energy = 0.693153
Validation R2 Energy = 0.961229
Epoch 77
Train function
Loss = 1.4675e-05, PNorm = 53.8391, GNorm = 0.0642, lr_0 = 1.2949e-04
Validation rmse Energy = 0.691837
Validation R2 Energy = 0.961376
Epoch 78
Train function
Validation rmse Energy = 0.686514
Validation R2 Energy = 0.961968
Epoch 79
Train function
Loss = 1.1500e-05, PNorm = 53.8406, GNorm = 0.1002, lr_0 = 1.2438e-04
Validation rmse Energy = 0.691624
Validation R2 Energy = 0.961400
Epoch 80
Train function
Loss = 1.2076e-05, PNorm = 53.8420, GNorm = 0.0422, lr_0 = 1.2027e-04
Validation rmse Energy = 0.694861
Validation R2 Energy = 0.961038
Epoch 81
Train function
Loss = 1.2878e-05, PNorm = 53.8432, GNorm = 0.0673, lr_0 = 1.1592e-04
Loss = 2.0191e-04, PNorm = 53.8433, GNorm = 0.3182, lr_0 = 1.1553e-04
Validation rmse Energy = 0.699389
Validation R2 Energy = 0.960528
Epoch 82
Train function
Validation rmse Energy = 0.685833
Validation R2 Energy = 0.962043
Epoch 83
Train function
Loss = 1.2226e-05, PNorm = 53.8448, GNorm = 0.0444, lr_0 = 1.1134e-04
Validation rmse Energy = 0.684480
Validation R2 Energy = 0.962193
Epoch 84
Train function
Loss = 1.1524e-05, PNorm = 53.8459, GNorm = 0.1172, lr_0 = 1.0730e-04
Validation rmse Energy = 0.694993
Validation R2 Energy = 0.961023
Epoch 85
Train function
Validation rmse Energy = 0.688191
Validation R2 Energy = 0.961782
Epoch 86
Train function
Loss = 8.5960e-06, PNorm = 53.8471, GNorm = 0.0943, lr_0 = 1.0341e-04
Validation rmse Energy = 0.690054
Validation R2 Energy = 0.961575
Epoch 87
Train function
Loss = 1.4768e-05, PNorm = 53.8482, GNorm = 0.0462, lr_0 = 1.0000e-04
Validation rmse Energy = 0.693897
Validation R2 Energy = 0.961145
Epoch 88
Train function
Loss = 1.3409e-05, PNorm = 53.8494, GNorm = 0.0977, lr_0 = 1.0000e-04
Loss = 1.9416e-04, PNorm = 53.8495, GNorm = 0.2948, lr_0 = 1.0000e-04
Validation rmse Energy = 0.690959
Validation R2 Energy = 0.961474
Epoch 89
Train function
Validation rmse Energy = 0.688088
Validation R2 Energy = 0.961793
Epoch 90
Train function
Loss = 1.3232e-05, PNorm = 53.8506, GNorm = 0.0439, lr_0 = 1.0000e-04
Validation rmse Energy = 0.686083
Validation R2 Energy = 0.962016
Epoch 91
Train function
Loss = 1.0204e-05, PNorm = 53.8519, GNorm = 0.0553, lr_0 = 1.0000e-04
Validation rmse Energy = 0.693143
Validation R2 Energy = 0.961230
Epoch 92
Train function
Validation rmse Energy = 0.695970
Validation R2 Energy = 0.960913
Epoch 93
Train function
Loss = 1.6116e-05, PNorm = 53.8534, GNorm = 0.1297, lr_0 = 1.0000e-04
Validation rmse Energy = 0.686838
Validation R2 Energy = 0.961932
Epoch 94
Train function
Loss = 1.2175e-05, PNorm = 53.8542, GNorm = 0.0446, lr_0 = 1.0000e-04
Validation rmse Energy = 0.690315
Validation R2 Energy = 0.961546
Epoch 95
Train function
Loss = 1.0373e-05, PNorm = 53.8552, GNorm = 0.0608, lr_0 = 1.0000e-04
Validation rmse Energy = 0.686766
Validation R2 Energy = 0.961940
Epoch 96
Train function
Validation rmse Energy = 0.687780
Validation R2 Energy = 0.961828
Epoch 97
Train function
Loss = 1.3725e-05, PNorm = 53.8562, GNorm = 0.0316, lr_0 = 1.0000e-04
Validation rmse Energy = 0.690083
Validation R2 Energy = 0.961571
Epoch 98
Train function
Loss = 1.2183e-05, PNorm = 53.8573, GNorm = 0.0294, lr_0 = 1.0000e-04
Validation rmse Energy = 0.689668
Validation R2 Energy = 0.961618
Epoch 99
Train function
Loss = 1.2846e-05, PNorm = 53.8587, GNorm = 0.0963, lr_0 = 1.0000e-04
Validation rmse Energy = 0.685849
Validation R2 Energy = 0.962042
Model 0 best validation rmse = 0.684480 on epoch 83
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 0.989051
Model 0 test R2 Energy = 0.941478
Ensemble test rmse  Energy= 0.989051
Ensemble test R2  Energy= 0.941478
Fold 2
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 199,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 360,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 2.274410
Validation R2 Energy = 0.519533
Epoch 1
Train function
Loss = 8.1720e-03, PNorm = 52.9583, GNorm = 2.7356, lr_0 = 8.7143e-04
Validation rmse Energy = 1.860029
Validation R2 Energy = 0.678660
Epoch 2
Train function
Loss = 5.0282e-03, PNorm = 53.0851, GNorm = 4.7902, lr_0 = 9.7024e-04
Validation rmse Energy = 1.690181
Validation R2 Energy = 0.734666
Epoch 3
Train function
Validation rmse Energy = 1.445455
Validation R2 Energy = 0.805940
Epoch 4
Train function
Loss = 1.6765e-03, PNorm = 53.1885, GNorm = 1.2970, lr_0 = 9.3194e-04
Validation rmse Energy = 1.342619
Validation R2 Energy = 0.832571
Epoch 5
Train function
Loss = 1.4294e-03, PNorm = 53.2405, GNorm = 1.0718, lr_0 = 9.0118e-04
Validation rmse Energy = 1.340659
Validation R2 Energy = 0.833059
Epoch 6
Train function
Loss = 1.1567e-03, PNorm = 53.2873, GNorm = 0.8496, lr_0 = 8.6851e-04
Loss = 5.6172e-03, PNorm = 53.2910, GNorm = 1.0512, lr_0 = 8.6560e-04
Validation rmse Energy = 1.419619
Validation R2 Energy = 0.812816
Epoch 7
Train function
Validation rmse Energy = 1.194938
Validation R2 Energy = 0.867378
Epoch 8
Train function
Loss = 9.2068e-04, PNorm = 53.3251, GNorm = 0.8063, lr_0 = 8.3422e-04
Validation rmse Energy = 1.253808
Validation R2 Energy = 0.853988
Epoch 9
Train function
Loss = 9.8043e-04, PNorm = 53.3522, GNorm = 1.5005, lr_0 = 8.0398e-04
Validation rmse Energy = 0.992494
Validation R2 Energy = 0.908508
Epoch 10
Train function
Validation rmse Energy = 0.931499
Validation R2 Energy = 0.919408
Epoch 11
Train function
Loss = 4.8747e-04, PNorm = 53.3891, GNorm = 0.9910, lr_0 = 7.7484e-04
Validation rmse Energy = 0.996468
Validation R2 Energy = 0.907774
Epoch 12
Train function
Loss = 7.6419e-04, PNorm = 53.4163, GNorm = 1.0997, lr_0 = 7.4675e-04
Validation rmse Energy = 0.934782
Validation R2 Energy = 0.918839
Epoch 13
Train function
Loss = 4.9703e-04, PNorm = 53.4378, GNorm = 1.0295, lr_0 = 7.1969e-04
Loss = 3.4862e-03, PNorm = 53.4400, GNorm = 0.6120, lr_0 = 7.1727e-04
Validation rmse Energy = 0.971233
Validation R2 Energy = 0.912386
Epoch 14
Train function
Validation rmse Energy = 0.919655
Validation R2 Energy = 0.921445
Epoch 15
Train function
Loss = 3.8522e-04, PNorm = 53.4619, GNorm = 0.6482, lr_0 = 6.9360e-04
Validation rmse Energy = 1.052678
Validation R2 Energy = 0.897076
Epoch 16
Train function
Loss = 4.5484e-04, PNorm = 53.4794, GNorm = 1.5543, lr_0 = 6.6846e-04
Validation rmse Energy = 1.045558
Validation R2 Energy = 0.898464
Epoch 17
Train function
Validation rmse Energy = 1.010311
Validation R2 Energy = 0.905194
Epoch 18
Train function
Loss = 2.5019e-04, PNorm = 53.5015, GNorm = 0.7652, lr_0 = 6.4207e-04
Validation rmse Energy = 0.920162
Validation R2 Energy = 0.921358
Epoch 19
Train function
Loss = 2.8189e-04, PNorm = 53.5184, GNorm = 0.4813, lr_0 = 6.1879e-04
Validation rmse Energy = 0.928109
Validation R2 Energy = 0.919994
Epoch 20
Train function
Loss = 2.1873e-04, PNorm = 53.5324, GNorm = 0.1572, lr_0 = 5.9837e-04
Validation rmse Energy = 0.946816
Validation R2 Energy = 0.916736
Epoch 21
Train function
Validation rmse Energy = 0.950011
Validation R2 Energy = 0.916173
Epoch 22
Train function
Loss = 2.3215e-04, PNorm = 53.5494, GNorm = 0.5525, lr_0 = 5.7475e-04
Validation rmse Energy = 0.866028
Validation R2 Energy = 0.930339
Epoch 23
Train function
Loss = 1.3253e-04, PNorm = 53.5648, GNorm = 0.3820, lr_0 = 5.5391e-04
Validation rmse Energy = 0.837460
Validation R2 Energy = 0.934859
Epoch 24
Train function
Loss = 1.6264e-04, PNorm = 53.5741, GNorm = 0.4475, lr_0 = 5.3383e-04
Validation rmse Energy = 0.876488
Validation R2 Energy = 0.928646
Epoch 25
Train function
Validation rmse Energy = 0.853622
Validation R2 Energy = 0.932320
Epoch 26
Train function
Loss = 1.5373e-04, PNorm = 53.5894, GNorm = 0.4196, lr_0 = 5.1448e-04
Validation rmse Energy = 0.831167
Validation R2 Energy = 0.935834
Epoch 27
Train function
Loss = 1.7675e-04, PNorm = 53.5951, GNorm = 0.2651, lr_0 = 4.9583e-04
Validation rmse Energy = 0.853471
Validation R2 Energy = 0.932344
Epoch 28
Train function
Validation rmse Energy = 0.816651
Validation R2 Energy = 0.938056
Epoch 29
Train function
Loss = 7.8441e-05, PNorm = 53.6120, GNorm = 0.2680, lr_0 = 4.7626e-04
Validation rmse Energy = 0.833088
Validation R2 Energy = 0.935537
Epoch 30
Train function
Loss = 7.9367e-05, PNorm = 53.6183, GNorm = 0.1475, lr_0 = 4.6054e-04
Validation rmse Energy = 0.844685
Validation R2 Energy = 0.933730
Epoch 31
Train function
Loss = 9.2494e-05, PNorm = 53.6297, GNorm = 0.1485, lr_0 = 4.4384e-04
Loss = 2.7191e-04, PNorm = 53.6306, GNorm = 0.3935, lr_0 = 4.4236e-04
Validation rmse Energy = 0.820997
Validation R2 Energy = 0.937395
Epoch 32
Train function
Validation rmse Energy = 0.818685
Validation R2 Energy = 0.937747
Epoch 33
Train function
Loss = 9.7240e-05, PNorm = 53.6357, GNorm = 0.3256, lr_0 = 4.2632e-04
Validation rmse Energy = 0.830717
Validation R2 Energy = 0.935904
Epoch 34
Train function
Loss = 5.8885e-05, PNorm = 53.6452, GNorm = 0.1432, lr_0 = 4.1087e-04
Validation rmse Energy = 0.815772
Validation R2 Energy = 0.938189
Epoch 35
Train function
Validation rmse Energy = 0.836740
Validation R2 Energy = 0.934971
Epoch 36
Train function
Loss = 4.3495e-05, PNorm = 53.6527, GNorm = 0.0781, lr_0 = 3.9597e-04
Validation rmse Energy = 0.820581
Validation R2 Energy = 0.937458
Epoch 37
Train function
Loss = 7.2514e-05, PNorm = 53.6582, GNorm = 0.1174, lr_0 = 3.8162e-04
Validation rmse Energy = 0.824483
Validation R2 Energy = 0.936862
Epoch 38
Train function
Loss = 6.4613e-05, PNorm = 53.6664, GNorm = 0.1812, lr_0 = 3.6779e-04
Loss = 7.2804e-05, PNorm = 53.6673, GNorm = 0.1254, lr_0 = 3.6656e-04
Validation rmse Energy = 0.820704
Validation R2 Energy = 0.937440
Epoch 39
Train function
Validation rmse Energy = 0.819310
Validation R2 Energy = 0.937652
Epoch 40
Train function
Loss = 4.3467e-05, PNorm = 53.6718, GNorm = 0.1485, lr_0 = 3.5446e-04
Validation rmse Energy = 0.823019
Validation R2 Energy = 0.937086
Epoch 41
Train function
Loss = 3.5924e-05, PNorm = 53.6776, GNorm = 0.1751, lr_0 = 3.4161e-04
Validation rmse Energy = 0.818811
Validation R2 Energy = 0.937728
Epoch 42
Train function
Validation rmse Energy = 0.823405
Validation R2 Energy = 0.937027
Epoch 43
Train function
Loss = 4.9413e-05, PNorm = 53.6826, GNorm = 0.2197, lr_0 = 3.2812e-04
Validation rmse Energy = 0.854515
Validation R2 Energy = 0.932179
Epoch 44
Train function
Loss = 3.2088e-05, PNorm = 53.6877, GNorm = 0.1943, lr_0 = 3.1623e-04
Validation rmse Energy = 0.833326
Validation R2 Energy = 0.935501
Epoch 45
Train function
Loss = 5.8394e-05, PNorm = 53.6917, GNorm = 0.2222, lr_0 = 3.0579e-04
Validation rmse Energy = 0.862016
Validation R2 Energy = 0.930983
Epoch 46
Train function
Validation rmse Energy = 0.814772
Validation R2 Energy = 0.938341
Epoch 47
Train function
Loss = 3.5078e-05, PNorm = 53.6986, GNorm = 0.1446, lr_0 = 2.9372e-04
Validation rmse Energy = 0.837231
Validation R2 Energy = 0.934895
Epoch 48
Train function
Loss = 3.8518e-05, PNorm = 53.7038, GNorm = 0.3522, lr_0 = 2.8307e-04
Validation rmse Energy = 0.808120
Validation R2 Energy = 0.939344
Epoch 49
Train function
Loss = 4.0667e-05, PNorm = 53.7077, GNorm = 0.3748, lr_0 = 2.7281e-04
Validation rmse Energy = 0.810659
Validation R2 Energy = 0.938962
Epoch 50
Train function
Validation rmse Energy = 0.823182
Validation R2 Energy = 0.937061
Epoch 51
Train function
Loss = 2.3705e-05, PNorm = 53.7106, GNorm = 0.2566, lr_0 = 2.6292e-04
Validation rmse Energy = 0.807596
Validation R2 Energy = 0.939422
Epoch 52
Train function
Loss = 3.0723e-05, PNorm = 53.7130, GNorm = 0.2227, lr_0 = 2.5339e-04
Validation rmse Energy = 0.816188
Validation R2 Energy = 0.938126
Epoch 53
Train function
Validation rmse Energy = 0.811979
Validation R2 Energy = 0.938763
Epoch 54
Train function
Loss = 2.0176e-05, PNorm = 53.7176, GNorm = 0.0970, lr_0 = 2.4339e-04
Validation rmse Energy = 0.809423
Validation R2 Energy = 0.939148
Epoch 55
Train function
Loss = 2.1907e-05, PNorm = 53.7199, GNorm = 0.0981, lr_0 = 2.3535e-04
Validation rmse Energy = 0.821579
Validation R2 Energy = 0.937306
Epoch 56
Train function
Loss = 1.9115e-05, PNorm = 53.7227, GNorm = 0.0641, lr_0 = 2.2682e-04
Loss = 8.3657e-05, PNorm = 53.7230, GNorm = 0.1778, lr_0 = 2.2606e-04
Validation rmse Energy = 0.812978
Validation R2 Energy = 0.938612
Epoch 57
Train function
Validation rmse Energy = 0.813360
Validation R2 Energy = 0.938554
Epoch 58
Train function
Loss = 1.3592e-05, PNorm = 53.7258, GNorm = 0.0612, lr_0 = 2.1787e-04
Validation rmse Energy = 0.815235
Validation R2 Energy = 0.938271
Epoch 59
Train function
Loss = 1.6436e-05, PNorm = 53.7280, GNorm = 0.0828, lr_0 = 2.0997e-04
Validation rmse Energy = 0.810763
Validation R2 Energy = 0.938946
Epoch 60
Train function
Validation rmse Energy = 0.803578
Validation R2 Energy = 0.940023
Epoch 61
Train function
Loss = 2.8987e-05, PNorm = 53.7313, GNorm = 0.1618, lr_0 = 2.0236e-04
Validation rmse Energy = 0.809457
Validation R2 Energy = 0.939143
Epoch 62
Train function
Loss = 1.2580e-05, PNorm = 53.7327, GNorm = 0.0572, lr_0 = 1.9502e-04
Validation rmse Energy = 0.817733
Validation R2 Energy = 0.937892
Epoch 63
Train function
Loss = 1.7934e-05, PNorm = 53.7351, GNorm = 0.0735, lr_0 = 1.8795e-04
Loss = 1.6677e-04, PNorm = 53.7354, GNorm = 0.2916, lr_0 = 1.8732e-04
Validation rmse Energy = 0.810169
Validation R2 Energy = 0.939036
Epoch 64
Train function
Validation rmse Energy = 0.812036
Validation R2 Energy = 0.938754
Epoch 65
Train function
Loss = 9.3216e-06, PNorm = 53.7373, GNorm = 0.0485, lr_0 = 1.8114e-04
Validation rmse Energy = 0.815702
Validation R2 Energy = 0.938200
Epoch 66
Train function
Loss = 1.2476e-05, PNorm = 53.7393, GNorm = 0.0497, lr_0 = 1.7458e-04
Validation rmse Energy = 0.821448
Validation R2 Energy = 0.937326
Epoch 67
Train function
Validation rmse Energy = 0.811022
Validation R2 Energy = 0.938907
Epoch 68
Train function
Loss = 1.0613e-05, PNorm = 53.7413, GNorm = 0.0618, lr_0 = 1.6768e-04
Validation rmse Energy = 0.817511
Validation R2 Energy = 0.937926
Epoch 69
Train function
Loss = 1.0210e-05, PNorm = 53.7427, GNorm = 0.0502, lr_0 = 1.6161e-04
Validation rmse Energy = 0.812691
Validation R2 Energy = 0.938655
Epoch 70
Train function
Loss = 1.2462e-05, PNorm = 53.7444, GNorm = 0.0546, lr_0 = 1.5627e-04
Validation rmse Energy = 0.815399
Validation R2 Energy = 0.938246
Epoch 71
Train function
Validation rmse Energy = 0.811465
Validation R2 Energy = 0.938840
Epoch 72
Train function
Loss = 7.2713e-06, PNorm = 53.7460, GNorm = 0.0497, lr_0 = 1.5010e-04
Validation rmse Energy = 0.814865
Validation R2 Energy = 0.938327
Epoch 73
Train function
Loss = 1.1203e-05, PNorm = 53.7473, GNorm = 0.0547, lr_0 = 1.4466e-04
Validation rmse Energy = 0.810030
Validation R2 Energy = 0.939056
Epoch 74
Train function
Loss = 1.2088e-05, PNorm = 53.7489, GNorm = 0.1178, lr_0 = 1.3942e-04
Validation rmse Energy = 0.817454
Validation R2 Energy = 0.937934
Epoch 75
Train function
Validation rmse Energy = 0.809083
Validation R2 Energy = 0.939199
Epoch 76
Train function
Loss = 1.5170e-05, PNorm = 53.7505, GNorm = 0.0691, lr_0 = 1.3436e-04
Validation rmse Energy = 0.808267
Validation R2 Energy = 0.939321
Epoch 77
Train function
Loss = 1.2268e-05, PNorm = 53.7521, GNorm = 0.0650, lr_0 = 1.2949e-04
Validation rmse Energy = 0.811683
Validation R2 Energy = 0.938807
Epoch 78
Train function
Validation rmse Energy = 0.814571
Validation R2 Energy = 0.938371
Epoch 79
Train function
Loss = 6.5061e-06, PNorm = 53.7537, GNorm = 0.0331, lr_0 = 1.2438e-04
Validation rmse Energy = 0.820986
Validation R2 Energy = 0.937397
Epoch 80
Train function
Loss = 1.3019e-05, PNorm = 53.7551, GNorm = 0.1014, lr_0 = 1.2027e-04
Validation rmse Energy = 0.813270
Validation R2 Energy = 0.938568
Epoch 81
Train function
Loss = 9.1042e-06, PNorm = 53.7564, GNorm = 0.0456, lr_0 = 1.1592e-04
Loss = 3.5352e-05, PNorm = 53.7564, GNorm = 0.0664, lr_0 = 1.1553e-04
Validation rmse Energy = 0.813040
Validation R2 Energy = 0.938603
Epoch 82
Train function
Validation rmse Energy = 0.808841
Validation R2 Energy = 0.939235
Epoch 83
Train function
Loss = 1.0867e-05, PNorm = 53.7575, GNorm = 0.1046, lr_0 = 1.1134e-04
Validation rmse Energy = 0.812194
Validation R2 Energy = 0.938730
Epoch 84
Train function
Loss = 9.2652e-06, PNorm = 53.7586, GNorm = 0.0436, lr_0 = 1.0730e-04
Validation rmse Energy = 0.815013
Validation R2 Energy = 0.938304
Epoch 85
Train function
Validation rmse Energy = 0.818412
Validation R2 Energy = 0.937789
Epoch 86
Train function
Loss = 8.8163e-06, PNorm = 53.7597, GNorm = 0.0509, lr_0 = 1.0341e-04
Validation rmse Energy = 0.813720
Validation R2 Energy = 0.938500
Epoch 87
Train function
Loss = 6.6682e-06, PNorm = 53.7606, GNorm = 0.0595, lr_0 = 1.0000e-04
Validation rmse Energy = 0.812546
Validation R2 Energy = 0.938677
Epoch 88
Train function
Loss = 8.6217e-06, PNorm = 53.7615, GNorm = 0.0559, lr_0 = 1.0000e-04
Loss = 1.8756e-05, PNorm = 53.7616, GNorm = 0.0638, lr_0 = 1.0000e-04
Validation rmse Energy = 0.809103
Validation R2 Energy = 0.939196
Epoch 89
Train function
Validation rmse Energy = 0.812845
Validation R2 Energy = 0.938632
Epoch 90
Train function
Loss = 7.2392e-06, PNorm = 53.7624, GNorm = 0.0565, lr_0 = 1.0000e-04
Validation rmse Energy = 0.812181
Validation R2 Energy = 0.938732
Epoch 91
Train function
Loss = 7.1826e-06, PNorm = 53.7632, GNorm = 0.0274, lr_0 = 1.0000e-04
Validation rmse Energy = 0.811485
Validation R2 Energy = 0.938837
Epoch 92
Train function
Validation rmse Energy = 0.808985
Validation R2 Energy = 0.939213
Epoch 93
Train function
Loss = 4.9479e-06, PNorm = 53.7641, GNorm = 0.1067, lr_0 = 1.0000e-04
Validation rmse Energy = 0.811014
Validation R2 Energy = 0.938908
Epoch 94
Train function
Loss = 9.3627e-06, PNorm = 53.7650, GNorm = 0.0180, lr_0 = 1.0000e-04
Validation rmse Energy = 0.811510
Validation R2 Energy = 0.938834
Epoch 95
Train function
Loss = 7.5884e-06, PNorm = 53.7658, GNorm = 0.0566, lr_0 = 1.0000e-04
Validation rmse Energy = 0.817324
Validation R2 Energy = 0.937954
Epoch 96
Train function
Validation rmse Energy = 0.814076
Validation R2 Energy = 0.938446
Epoch 97
Train function
Loss = 3.8004e-06, PNorm = 53.7669, GNorm = 0.0500, lr_0 = 1.0000e-04
Validation rmse Energy = 0.807406
Validation R2 Energy = 0.939451
Epoch 98
Train function
Loss = 4.9911e-06, PNorm = 53.7678, GNorm = 0.0765, lr_0 = 1.0000e-04
Validation rmse Energy = 0.811858
Validation R2 Energy = 0.938781
Epoch 99
Train function
Loss = 7.1708e-06, PNorm = 53.7686, GNorm = 0.0618, lr_0 = 1.0000e-04
Validation rmse Energy = 0.809048
Validation R2 Energy = 0.939204
Model 0 best validation rmse = 0.803578 on epoch 60
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.086317
Model 0 test R2 Energy = 0.929401
Ensemble test rmse  Energy= 1.086317
Ensemble test R2  Energy= 0.929401
Fold 3
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 199,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 360,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 2.853420
Validation R2 Energy = 0.507867
Epoch 1
Train function
Loss = 7.7477e-03, PNorm = 52.9598, GNorm = 1.4927, lr_0 = 8.7143e-04
Validation rmse Energy = 2.797154
Validation R2 Energy = 0.527084
Epoch 2
Train function
Loss = 6.2909e-03, PNorm = 53.0906, GNorm = 0.8936, lr_0 = 9.7024e-04
Validation rmse Energy = 1.929710
Validation R2 Energy = 0.774921
Epoch 3
Train function
Validation rmse Energy = 1.497231
Validation R2 Energy = 0.864503
Epoch 4
Train function
Loss = 2.2766e-03, PNorm = 53.2070, GNorm = 0.4246, lr_0 = 9.3194e-04
Validation rmse Energy = 1.331033
Validation R2 Energy = 0.892915
Epoch 5
Train function
Loss = 1.3975e-03, PNorm = 53.2782, GNorm = 0.3537, lr_0 = 9.0118e-04
Validation rmse Energy = 1.182576
Validation R2 Energy = 0.915470
Epoch 6
Train function
Loss = 1.0987e-03, PNorm = 53.3309, GNorm = 0.7279, lr_0 = 8.6851e-04
Loss = 2.5784e-03, PNorm = 53.3350, GNorm = 0.8310, lr_0 = 8.6560e-04
Validation rmse Energy = 1.314762
Validation R2 Energy = 0.895517
Epoch 7
Train function
Validation rmse Energy = 1.234538
Validation R2 Energy = 0.907879
Epoch 8
Train function
Loss = 6.4809e-04, PNorm = 53.3770, GNorm = 0.5866, lr_0 = 8.3422e-04
Validation rmse Energy = 1.195744
Validation R2 Energy = 0.913577
Epoch 9
Train function
Loss = 6.0290e-04, PNorm = 53.4108, GNorm = 1.0528, lr_0 = 8.0398e-04
Validation rmse Energy = 1.173126
Validation R2 Energy = 0.916816
Epoch 10
Train function
Validation rmse Energy = 1.146971
Validation R2 Energy = 0.920484
Epoch 11
Train function
Loss = 5.8336e-04, PNorm = 53.4373, GNorm = 0.5038, lr_0 = 7.7484e-04
Validation rmse Energy = 1.156205
Validation R2 Energy = 0.919198
Epoch 12
Train function
Loss = 3.4803e-04, PNorm = 53.4643, GNorm = 0.3988, lr_0 = 7.4675e-04
Validation rmse Energy = 1.074475
Validation R2 Energy = 0.930218
Epoch 13
Train function
Loss = 2.7816e-04, PNorm = 53.4843, GNorm = 0.1684, lr_0 = 7.1969e-04
Loss = 1.1436e-03, PNorm = 53.4865, GNorm = 0.4115, lr_0 = 7.1727e-04
Validation rmse Energy = 1.088062
Validation R2 Energy = 0.928442
Epoch 14
Train function
Validation rmse Energy = 1.096663
Validation R2 Energy = 0.927306
Epoch 15
Train function
Loss = 2.3355e-04, PNorm = 53.5076, GNorm = 0.3309, lr_0 = 6.9360e-04
Validation rmse Energy = 1.057221
Validation R2 Energy = 0.932441
Epoch 16
Train function
Loss = 2.1285e-04, PNorm = 53.5253, GNorm = 0.3444, lr_0 = 6.6846e-04
Validation rmse Energy = 1.118187
Validation R2 Energy = 0.924425
Epoch 17
Train function
Validation rmse Energy = 1.073789
Validation R2 Energy = 0.930307
Epoch 18
Train function
Loss = 1.5525e-04, PNorm = 53.5450, GNorm = 0.5406, lr_0 = 6.4207e-04
Validation rmse Energy = 1.088232
Validation R2 Energy = 0.928420
Epoch 19
Train function
Loss = 1.7860e-04, PNorm = 53.5586, GNorm = 0.2845, lr_0 = 6.1879e-04
Validation rmse Energy = 1.045127
Validation R2 Energy = 0.933978
Epoch 20
Train function
Loss = 1.4526e-04, PNorm = 53.5719, GNorm = 0.3690, lr_0 = 5.9837e-04
Validation rmse Energy = 1.124222
Validation R2 Energy = 0.923607
Epoch 21
Train function
Validation rmse Energy = 1.028851
Validation R2 Energy = 0.936018
Epoch 22
Train function
Loss = 1.0377e-04, PNorm = 53.5866, GNorm = 0.2044, lr_0 = 5.7475e-04
Validation rmse Energy = 1.054192
Validation R2 Energy = 0.932828
Epoch 23
Train function
Loss = 1.0453e-04, PNorm = 53.5990, GNorm = 0.2894, lr_0 = 5.5391e-04
Validation rmse Energy = 1.049180
Validation R2 Energy = 0.933465
Epoch 24
Train function
Loss = 1.0407e-04, PNorm = 53.6128, GNorm = 0.3020, lr_0 = 5.3383e-04
Validation rmse Energy = 1.063854
Validation R2 Energy = 0.931591
Epoch 25
Train function
Validation rmse Energy = 1.073220
Validation R2 Energy = 0.930381
Epoch 26
Train function
Loss = 1.0230e-04, PNorm = 53.6228, GNorm = 0.1668, lr_0 = 5.1448e-04
Validation rmse Energy = 1.038723
Validation R2 Energy = 0.934785
Epoch 27
Train function
Loss = 6.9951e-05, PNorm = 53.6328, GNorm = 0.2174, lr_0 = 4.9583e-04
Validation rmse Energy = 1.069223
Validation R2 Energy = 0.930898
Epoch 28
Train function
Validation rmse Energy = 1.119752
Validation R2 Energy = 0.924213
Epoch 29
Train function
Loss = 5.7771e-05, PNorm = 53.6408, GNorm = 0.2330, lr_0 = 4.7626e-04
Validation rmse Energy = 1.043080
Validation R2 Energy = 0.934236
Epoch 30
Train function
Loss = 7.6370e-05, PNorm = 53.6494, GNorm = 0.2345, lr_0 = 4.6054e-04
Validation rmse Energy = 1.039081
Validation R2 Energy = 0.934740
Epoch 31
Train function
Loss = 6.1906e-05, PNorm = 53.6560, GNorm = 0.3826, lr_0 = 4.4384e-04
Loss = 1.9776e-04, PNorm = 53.6570, GNorm = 0.4485, lr_0 = 4.4236e-04
Validation rmse Energy = 1.060503
Validation R2 Energy = 0.932021
Epoch 32
Train function
Validation rmse Energy = 1.044032
Validation R2 Energy = 0.934116
Epoch 33
Train function
Loss = 4.0576e-05, PNorm = 53.6666, GNorm = 0.0718, lr_0 = 4.2632e-04
Validation rmse Energy = 1.053899
Validation R2 Energy = 0.932865
Epoch 34
Train function
Loss = 6.9185e-05, PNorm = 53.6740, GNorm = 0.2022, lr_0 = 4.1087e-04
Validation rmse Energy = 1.055777
Validation R2 Energy = 0.932626
Epoch 35
Train function
Validation rmse Energy = 1.021467
Validation R2 Energy = 0.936933
Epoch 36
Train function
Loss = 3.0749e-05, PNorm = 53.6806, GNorm = 0.2007, lr_0 = 3.9597e-04
Validation rmse Energy = 1.042012
Validation R2 Energy = 0.934371
Epoch 37
Train function
Loss = 3.7305e-05, PNorm = 53.6862, GNorm = 0.1860, lr_0 = 3.8162e-04
Validation rmse Energy = 1.033025
Validation R2 Energy = 0.935498
Epoch 38
Train function
Loss = 3.9069e-05, PNorm = 53.6919, GNorm = 0.1478, lr_0 = 3.6779e-04
Loss = 6.4038e-05, PNorm = 53.6922, GNorm = 0.0968, lr_0 = 3.6656e-04
Validation rmse Energy = 1.033974
Validation R2 Energy = 0.935380
Epoch 39
Train function
Validation rmse Energy = 1.026452
Validation R2 Energy = 0.936316
Epoch 40
Train function
Loss = 4.4424e-05, PNorm = 53.6963, GNorm = 0.2192, lr_0 = 3.5446e-04
Validation rmse Energy = 1.053739
Validation R2 Energy = 0.932885
Epoch 41
Train function
Loss = 3.0853e-05, PNorm = 53.7007, GNorm = 0.1026, lr_0 = 3.4161e-04
Validation rmse Energy = 1.035699
Validation R2 Energy = 0.935164
Epoch 42
Train function
Validation rmse Energy = 1.053019
Validation R2 Energy = 0.932977
Epoch 43
Train function
Loss = 3.1085e-05, PNorm = 53.7062, GNorm = 0.2456, lr_0 = 3.2812e-04
Validation rmse Energy = 1.047635
Validation R2 Energy = 0.933661
Epoch 44
Train function
Loss = 3.2088e-05, PNorm = 53.7112, GNorm = 0.2234, lr_0 = 3.1623e-04
Validation rmse Energy = 1.024127
Validation R2 Energy = 0.936604
Epoch 45
Train function
Loss = 2.9261e-05, PNorm = 53.7145, GNorm = 0.2130, lr_0 = 3.0579e-04
Validation rmse Energy = 1.036019
Validation R2 Energy = 0.935124
Epoch 46
Train function
Validation rmse Energy = 1.046697
Validation R2 Energy = 0.933779
Epoch 47
Train function
Loss = 3.8378e-05, PNorm = 53.7190, GNorm = 0.4497, lr_0 = 2.9372e-04
Validation rmse Energy = 1.025729
Validation R2 Energy = 0.936406
Epoch 48
Train function
Loss = 3.4876e-05, PNorm = 53.7231, GNorm = 0.3015, lr_0 = 2.8307e-04
Validation rmse Energy = 1.039082
Validation R2 Energy = 0.934739
Epoch 49
Train function
Loss = 3.0079e-05, PNorm = 53.7269, GNorm = 0.1229, lr_0 = 2.7281e-04
Validation rmse Energy = 1.035290
Validation R2 Energy = 0.935215
Epoch 50
Train function
Validation rmse Energy = 1.036865
Validation R2 Energy = 0.935018
Epoch 51
Train function
Loss = 3.6113e-05, PNorm = 53.7301, GNorm = 0.2288, lr_0 = 2.6292e-04
Validation rmse Energy = 1.049738
Validation R2 Energy = 0.933394
Epoch 52
Train function
Loss = 2.2079e-05, PNorm = 53.7328, GNorm = 0.0648, lr_0 = 2.5339e-04
Validation rmse Energy = 1.034305
Validation R2 Energy = 0.935338
Epoch 53
Train function
Validation rmse Energy = 1.042411
Validation R2 Energy = 0.934321
Epoch 54
Train function
Loss = 2.2975e-05, PNorm = 53.7366, GNorm = 0.1452, lr_0 = 2.4339e-04
Validation rmse Energy = 1.043009
Validation R2 Energy = 0.934245
Epoch 55
Train function
Loss = 2.1937e-05, PNorm = 53.7397, GNorm = 0.1101, lr_0 = 2.3535e-04
Validation rmse Energy = 1.037031
Validation R2 Energy = 0.934997
Epoch 56
Train function
Loss = 1.9607e-05, PNorm = 53.7423, GNorm = 0.0899, lr_0 = 2.2682e-04
Loss = 2.3412e-05, PNorm = 53.7425, GNorm = 0.0569, lr_0 = 2.2606e-04
Validation rmse Energy = 1.039241
Validation R2 Energy = 0.934719
Epoch 57
Train function
Validation rmse Energy = 1.043800
Validation R2 Energy = 0.934145
Epoch 58
Train function
Loss = 1.5070e-05, PNorm = 53.7444, GNorm = 0.0929, lr_0 = 2.1787e-04
Validation rmse Energy = 1.037525
Validation R2 Energy = 0.934935
Epoch 59
Train function
Loss = 1.6294e-05, PNorm = 53.7463, GNorm = 0.0696, lr_0 = 2.0997e-04
Validation rmse Energy = 1.041608
Validation R2 Energy = 0.934422
Epoch 60
Train function
Validation rmse Energy = 1.041663
Validation R2 Energy = 0.934415
Epoch 61
Train function
Loss = 1.5382e-05, PNorm = 53.7481, GNorm = 0.0855, lr_0 = 2.0236e-04
Validation rmse Energy = 1.042454
Validation R2 Energy = 0.934315
Epoch 62
Train function
Loss = 1.5422e-05, PNorm = 53.7501, GNorm = 0.0589, lr_0 = 1.9502e-04
Validation rmse Energy = 1.037722
Validation R2 Energy = 0.934910
Epoch 63
Train function
Loss = 1.4594e-05, PNorm = 53.7521, GNorm = 0.0699, lr_0 = 1.8795e-04
Loss = 5.0083e-05, PNorm = 53.7522, GNorm = 0.0843, lr_0 = 1.8732e-04
Validation rmse Energy = 1.044204
Validation R2 Energy = 0.934094
Epoch 64
Train function
Validation rmse Energy = 1.038708
Validation R2 Energy = 0.934786
Epoch 65
Train function
Loss = 1.0369e-05, PNorm = 53.7538, GNorm = 0.0848, lr_0 = 1.8114e-04
Validation rmse Energy = 1.034513
Validation R2 Energy = 0.935312
Epoch 66
Train function
Loss = 1.0578e-05, PNorm = 53.7556, GNorm = 0.0926, lr_0 = 1.7458e-04
Validation rmse Energy = 1.040446
Validation R2 Energy = 0.934568
Epoch 67
Train function
Validation rmse Energy = 1.040460
Validation R2 Energy = 0.934566
Epoch 68
Train function
Loss = 6.3472e-06, PNorm = 53.7570, GNorm = 0.0524, lr_0 = 1.6768e-04
Validation rmse Energy = 1.040858
Validation R2 Energy = 0.934516
Epoch 69
Train function
Loss = 1.2288e-05, PNorm = 53.7586, GNorm = 0.1699, lr_0 = 1.6161e-04
Validation rmse Energy = 1.036545
Validation R2 Energy = 0.935058
Epoch 70
Train function
Loss = 1.5550e-05, PNorm = 53.7596, GNorm = 0.1232, lr_0 = 1.5627e-04
Validation rmse Energy = 1.045153
Validation R2 Energy = 0.933975
Epoch 71
Train function
Validation rmse Energy = 1.037051
Validation R2 Energy = 0.934994
Epoch 72
Train function
Loss = 7.7317e-06, PNorm = 53.7613, GNorm = 0.0919, lr_0 = 1.5010e-04
Validation rmse Energy = 1.041450
Validation R2 Energy = 0.934442
Epoch 73
Train function
Loss = 1.4536e-05, PNorm = 53.7631, GNorm = 0.0486, lr_0 = 1.4466e-04
Validation rmse Energy = 1.047814
Validation R2 Energy = 0.933638
Epoch 74
Train function
Loss = 1.0669e-05, PNorm = 53.7648, GNorm = 0.0577, lr_0 = 1.3942e-04
Validation rmse Energy = 1.043299
Validation R2 Energy = 0.934209
Epoch 75
Train function
Validation rmse Energy = 1.040345
Validation R2 Energy = 0.934581
Epoch 76
Train function
Loss = 7.9777e-06, PNorm = 53.7660, GNorm = 0.0682, lr_0 = 1.3436e-04
Validation rmse Energy = 1.042734
Validation R2 Energy = 0.934280
Epoch 77
Train function
Loss = 9.1984e-06, PNorm = 53.7673, GNorm = 0.0299, lr_0 = 1.2949e-04
Validation rmse Energy = 1.040535
Validation R2 Energy = 0.934557
Epoch 78
Train function
Validation rmse Energy = 1.042093
Validation R2 Energy = 0.934361
Epoch 79
Train function
Loss = 1.2388e-05, PNorm = 53.7685, GNorm = 0.0353, lr_0 = 1.2438e-04
Validation rmse Energy = 1.040868
Validation R2 Energy = 0.934515
Epoch 80
Train function
Loss = 9.3357e-06, PNorm = 53.7696, GNorm = 0.0330, lr_0 = 1.2027e-04
Validation rmse Energy = 1.046020
Validation R2 Energy = 0.933865
Epoch 81
Train function
Loss = 8.8131e-06, PNorm = 53.7706, GNorm = 0.0584, lr_0 = 1.1592e-04
Loss = 1.7382e-05, PNorm = 53.7707, GNorm = 0.1108, lr_0 = 1.1553e-04
Validation rmse Energy = 1.040580
Validation R2 Energy = 0.934551
Epoch 82
Train function
Validation rmse Energy = 1.042398
Validation R2 Energy = 0.934322
Epoch 83
Train function
Loss = 8.1542e-06, PNorm = 53.7717, GNorm = 0.0400, lr_0 = 1.1134e-04
Validation rmse Energy = 1.042476
Validation R2 Energy = 0.934312
Epoch 84
Train function
Loss = 8.5468e-06, PNorm = 53.7725, GNorm = 0.0448, lr_0 = 1.0730e-04
Validation rmse Energy = 1.043691
Validation R2 Energy = 0.934159
Epoch 85
Train function
Validation rmse Energy = 1.042557
Validation R2 Energy = 0.934302
Epoch 86
Train function
Loss = 1.2367e-05, PNorm = 53.7734, GNorm = 0.0529, lr_0 = 1.0341e-04
Validation rmse Energy = 1.043540
Validation R2 Energy = 0.934178
Epoch 87
Train function
Loss = 6.2864e-06, PNorm = 53.7744, GNorm = 0.0137, lr_0 = 1.0000e-04
Validation rmse Energy = 1.042346
Validation R2 Energy = 0.934329
Epoch 88
Train function
Loss = 7.6377e-06, PNorm = 53.7753, GNorm = 0.0399, lr_0 = 1.0000e-04
Loss = 1.7417e-05, PNorm = 53.7755, GNorm = 0.0471, lr_0 = 1.0000e-04
Validation rmse Energy = 1.041994
Validation R2 Energy = 0.934373
Epoch 89
Train function
Validation rmse Energy = 1.044020
Validation R2 Energy = 0.934118
Epoch 90
Train function
Loss = 7.3287e-06, PNorm = 53.7764, GNorm = 0.0622, lr_0 = 1.0000e-04
Validation rmse Energy = 1.041874
Validation R2 Energy = 0.934388
Epoch 91
Train function
Loss = 8.6127e-06, PNorm = 53.7772, GNorm = 0.0536, lr_0 = 1.0000e-04
Validation rmse Energy = 1.045148
Validation R2 Energy = 0.933975
Epoch 92
Train function
Validation rmse Energy = 1.043265
Validation R2 Energy = 0.934213
Epoch 93
Train function
Loss = 1.5170e-05, PNorm = 53.7782, GNorm = 0.1849, lr_0 = 1.0000e-04
Validation rmse Energy = 1.044576
Validation R2 Energy = 0.934047
Epoch 94
Train function
Loss = 5.8678e-06, PNorm = 53.7790, GNorm = 0.0345, lr_0 = 1.0000e-04
Validation rmse Energy = 1.042506
Validation R2 Energy = 0.934309
Epoch 95
Train function
Loss = 5.3420e-06, PNorm = 53.7798, GNorm = 0.0313, lr_0 = 1.0000e-04
Validation rmse Energy = 1.045193
Validation R2 Energy = 0.933970
Epoch 96
Train function
Validation rmse Energy = 1.043448
Validation R2 Energy = 0.934190
Epoch 97
Train function
Loss = 1.0663e-05, PNorm = 53.7809, GNorm = 0.1421, lr_0 = 1.0000e-04
Validation rmse Energy = 1.044724
Validation R2 Energy = 0.934029
Epoch 98
Train function
Loss = 6.6200e-06, PNorm = 53.7821, GNorm = 0.0352, lr_0 = 1.0000e-04
Validation rmse Energy = 1.043036
Validation R2 Energy = 0.934242
Epoch 99
Train function
Loss = 7.3034e-06, PNorm = 53.7832, GNorm = 0.0511, lr_0 = 1.0000e-04
Validation rmse Energy = 1.040329
Validation R2 Energy = 0.934583
Model 0 best validation rmse = 1.021467 on epoch 35
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.003269
Model 0 test R2 Energy = 0.939783
Ensemble test rmse  Energy= 1.003269
Ensemble test R2  Energy= 0.939783
4-fold cross validation
	Seed 0 ==> test rmse = 1.118383
	Seed 0 ==> test R2 = 0.925172
	Seed 1 ==> test rmse = 0.989051
	Seed 1 ==> test R2 = 0.941478
	Seed 2 ==> test rmse = 1.086317
	Seed 2 ==> test R2 = 0.929401
	Seed 3 ==> test rmse = 1.003269
	Seed 3 ==> test R2 = 0.939783
Overall val rmse Energy= 0.906691 +/- 0.171401
Overall val R2 Energy = 0.943845 +/- 0.010689
Overall test rmse Energy = 1.049255 +/- 0.054524
Overall test R2 Energy = 0.933958 +/- 0.006864
Elapsed time = 0:06:43
Fold 0
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 3.313648
Validation R2 Energy = 0.439028
Epoch 1
Train function
Loss = 1.0485e-02, PNorm = 52.9608, GNorm = 2.4521, lr_0 = 8.7143e-04
Validation rmse Energy = 3.294740
Validation R2 Energy = 0.445412
Epoch 2
Train function
Loss = 8.4547e-03, PNorm = 53.0846, GNorm = 1.9141, lr_0 = 9.7024e-04
Validation rmse Energy = 2.496247
Validation R2 Energy = 0.681651
Epoch 3
Train function
Validation rmse Energy = 2.044385
Validation R2 Energy = 0.786473
Epoch 4
Train function
Loss = 2.7032e-03, PNorm = 53.2070, GNorm = 3.0637, lr_0 = 9.3194e-04
Validation rmse Energy = 1.705182
Validation R2 Energy = 0.851451
Epoch 5
Train function
Loss = 2.5567e-03, PNorm = 53.2762, GNorm = 2.3765, lr_0 = 9.0118e-04
Validation rmse Energy = 1.650381
Validation R2 Energy = 0.860846
Epoch 6
Train function
Loss = 1.6311e-03, PNorm = 53.3382, GNorm = 0.3369, lr_0 = 8.6851e-04
Loss = 5.8410e-03, PNorm = 53.3418, GNorm = 2.0214, lr_0 = 8.6560e-04
Validation rmse Energy = 1.492334
Validation R2 Energy = 0.886221
Epoch 7
Train function
Validation rmse Energy = 1.405947
Validation R2 Energy = 0.899013
Epoch 8
Train function
Loss = 1.0288e-03, PNorm = 53.3851, GNorm = 1.1374, lr_0 = 8.3422e-04
Validation rmse Energy = 1.322259
Validation R2 Energy = 0.910677
Epoch 9
Train function
Loss = 8.7018e-04, PNorm = 53.4218, GNorm = 0.5723, lr_0 = 8.0398e-04
Validation rmse Energy = 1.325133
Validation R2 Energy = 0.910289
Epoch 10
Train function
Validation rmse Energy = 1.322428
Validation R2 Energy = 0.910654
Epoch 11
Train function
Loss = 7.0054e-04, PNorm = 53.4517, GNorm = 0.7831, lr_0 = 7.7484e-04
Validation rmse Energy = 1.514850
Validation R2 Energy = 0.882762
Epoch 12
Train function
Loss = 7.9527e-04, PNorm = 53.4846, GNorm = 0.7329, lr_0 = 7.4675e-04
Validation rmse Energy = 1.395051
Validation R2 Energy = 0.900572
Epoch 13
Train function
Loss = 7.4102e-04, PNorm = 53.5134, GNorm = 1.0132, lr_0 = 7.1969e-04
Loss = 3.0611e-03, PNorm = 53.5159, GNorm = 1.2103, lr_0 = 7.1727e-04
Validation rmse Energy = 1.350317
Validation R2 Energy = 0.906846
Epoch 14
Train function
Validation rmse Energy = 1.270140
Validation R2 Energy = 0.917580
Epoch 15
Train function
Loss = 4.8416e-04, PNorm = 53.5445, GNorm = 0.7721, lr_0 = 6.9360e-04
Validation rmse Energy = 1.297142
Validation R2 Energy = 0.914039
Epoch 16
Train function
Loss = 3.8536e-04, PNorm = 53.5647, GNorm = 0.2832, lr_0 = 6.6846e-04
Validation rmse Energy = 1.238393
Validation R2 Energy = 0.921649
Epoch 17
Train function
Validation rmse Energy = 1.211859
Validation R2 Energy = 0.924970
Epoch 18
Train function
Loss = 2.7033e-04, PNorm = 53.5955, GNorm = 0.5899, lr_0 = 6.4207e-04
Validation rmse Energy = 1.223842
Validation R2 Energy = 0.923479
Epoch 19
Train function
Loss = 2.8479e-04, PNorm = 53.6185, GNorm = 0.4464, lr_0 = 6.1879e-04
Validation rmse Energy = 1.231803
Validation R2 Energy = 0.922481
Epoch 20
Train function
Loss = 2.4224e-04, PNorm = 53.6390, GNorm = 0.1722, lr_0 = 5.9837e-04
Validation rmse Energy = 1.194123
Validation R2 Energy = 0.927151
Epoch 21
Train function
Validation rmse Energy = 1.191383
Validation R2 Energy = 0.927484
Epoch 22
Train function
Loss = 2.1566e-04, PNorm = 53.6639, GNorm = 0.3489, lr_0 = 5.7475e-04
Validation rmse Energy = 1.163120
Validation R2 Energy = 0.930884
Epoch 23
Train function
Loss = 1.4608e-04, PNorm = 53.6839, GNorm = 0.1657, lr_0 = 5.5391e-04
Validation rmse Energy = 1.168433
Validation R2 Energy = 0.930251
Epoch 24
Train function
Loss = 1.5589e-04, PNorm = 53.6991, GNorm = 0.5874, lr_0 = 5.3383e-04
Validation rmse Energy = 1.169737
Validation R2 Energy = 0.930096
Epoch 25
Train function
Validation rmse Energy = 1.159039
Validation R2 Energy = 0.931368
Epoch 26
Train function
Loss = 1.0040e-04, PNorm = 53.7165, GNorm = 0.2360, lr_0 = 5.1448e-04
Validation rmse Energy = 1.175594
Validation R2 Energy = 0.929394
Epoch 27
Train function
Loss = 1.1704e-04, PNorm = 53.7301, GNorm = 0.6324, lr_0 = 4.9583e-04
Validation rmse Energy = 1.151259
Validation R2 Energy = 0.932287
Epoch 28
Train function
Validation rmse Energy = 1.154523
Validation R2 Energy = 0.931902
Epoch 29
Train function
Loss = 9.9175e-05, PNorm = 53.7457, GNorm = 0.4523, lr_0 = 4.7626e-04
Validation rmse Energy = 1.149662
Validation R2 Energy = 0.932474
Epoch 30
Train function
Loss = 7.3406e-05, PNorm = 53.7572, GNorm = 0.1031, lr_0 = 4.6054e-04
Validation rmse Energy = 1.129816
Validation R2 Energy = 0.934786
Epoch 31
Train function
Loss = 8.1162e-05, PNorm = 53.7663, GNorm = 0.2067, lr_0 = 4.4384e-04
Loss = 2.3998e-04, PNorm = 53.7670, GNorm = 0.2436, lr_0 = 4.4236e-04
Validation rmse Energy = 1.140012
Validation R2 Energy = 0.933603
Epoch 32
Train function
Validation rmse Energy = 1.142289
Validation R2 Energy = 0.933338
Epoch 33
Train function
Loss = 5.0071e-05, PNorm = 53.7747, GNorm = 0.1687, lr_0 = 4.2632e-04
Validation rmse Energy = 1.126596
Validation R2 Energy = 0.935157
Epoch 34
Train function
Loss = 7.6274e-05, PNorm = 53.7841, GNorm = 0.2864, lr_0 = 4.1087e-04
Validation rmse Energy = 1.140534
Validation R2 Energy = 0.933542
Epoch 35
Train function
Validation rmse Energy = 1.117238
Validation R2 Energy = 0.936230
Epoch 36
Train function
Loss = 5.4743e-05, PNorm = 53.7947, GNorm = 0.2473, lr_0 = 3.9597e-04
Validation rmse Energy = 1.134384
Validation R2 Energy = 0.934257
Epoch 37
Train function
Loss = 3.8920e-05, PNorm = 53.8026, GNorm = 0.0446, lr_0 = 3.8162e-04
Validation rmse Energy = 1.131622
Validation R2 Energy = 0.934577
Epoch 38
Train function
Loss = 3.8091e-05, PNorm = 53.8096, GNorm = 0.0840, lr_0 = 3.6779e-04
Loss = 1.5158e-04, PNorm = 53.8100, GNorm = 0.2493, lr_0 = 3.6656e-04
Validation rmse Energy = 1.144159
Validation R2 Energy = 0.933119
Epoch 39
Train function
Validation rmse Energy = 1.135410
Validation R2 Energy = 0.934138
Epoch 40
Train function
Loss = 3.7869e-05, PNorm = 53.8154, GNorm = 0.1179, lr_0 = 3.5446e-04
Validation rmse Energy = 1.128639
Validation R2 Energy = 0.934921
Epoch 41
Train function
Loss = 3.3600e-05, PNorm = 53.8219, GNorm = 0.0596, lr_0 = 3.4161e-04
Validation rmse Energy = 1.129412
Validation R2 Energy = 0.934832
Epoch 42
Train function
Validation rmse Energy = 1.136551
Validation R2 Energy = 0.934006
Epoch 43
Train function
Loss = 1.5405e-05, PNorm = 53.8272, GNorm = 0.0632, lr_0 = 3.2812e-04
Validation rmse Energy = 1.138387
Validation R2 Energy = 0.933792
Epoch 44
Train function
Loss = 3.3648e-05, PNorm = 53.8327, GNorm = 0.0976, lr_0 = 3.1623e-04
Validation rmse Energy = 1.136965
Validation R2 Energy = 0.933958
Epoch 45
Train function
Loss = 2.9960e-05, PNorm = 53.8374, GNorm = 0.0773, lr_0 = 3.0579e-04
Validation rmse Energy = 1.142422
Validation R2 Energy = 0.933322
Epoch 46
Train function
Validation rmse Energy = 1.135762
Validation R2 Energy = 0.934097
Epoch 47
Train function
Loss = 3.2142e-05, PNorm = 53.8424, GNorm = 0.1119, lr_0 = 2.9372e-04
Validation rmse Energy = 1.138554
Validation R2 Energy = 0.933773
Epoch 48
Train function
Loss = 2.4516e-05, PNorm = 53.8467, GNorm = 0.0891, lr_0 = 2.8307e-04
Validation rmse Energy = 1.129457
Validation R2 Energy = 0.934827
Epoch 49
Train function
Loss = 2.4312e-05, PNorm = 53.8507, GNorm = 0.0770, lr_0 = 2.7281e-04
Validation rmse Energy = 1.125233
Validation R2 Energy = 0.935314
Epoch 50
Train function
Validation rmse Energy = 1.132843
Validation R2 Energy = 0.934436
Epoch 51
Train function
Loss = 1.7122e-05, PNorm = 53.8541, GNorm = 0.2344, lr_0 = 2.6292e-04
Validation rmse Energy = 1.148426
Validation R2 Energy = 0.932620
Epoch 52
Train function
Loss = 2.4998e-05, PNorm = 53.8572, GNorm = 0.0539, lr_0 = 2.5339e-04
Validation rmse Energy = 1.137503
Validation R2 Energy = 0.933895
Epoch 53
Train function
Validation rmse Energy = 1.132806
Validation R2 Energy = 0.934440
Epoch 54
Train function
Loss = 2.0881e-05, PNorm = 53.8610, GNorm = 0.0352, lr_0 = 2.4339e-04
Validation rmse Energy = 1.126599
Validation R2 Energy = 0.935156
Epoch 55
Train function
Loss = 1.4810e-05, PNorm = 53.8639, GNorm = 0.0573, lr_0 = 2.3535e-04
Validation rmse Energy = 1.128037
Validation R2 Energy = 0.934991
Epoch 56
Train function
Loss = 1.8999e-05, PNorm = 53.8668, GNorm = 0.0720, lr_0 = 2.2682e-04
Loss = 6.9916e-05, PNorm = 53.8671, GNorm = 0.1767, lr_0 = 2.2606e-04
Validation rmse Energy = 1.126690
Validation R2 Energy = 0.935146
Epoch 57
Train function
Validation rmse Energy = 1.131792
Validation R2 Energy = 0.934557
Epoch 58
Train function
Loss = 2.4477e-05, PNorm = 53.8696, GNorm = 0.1620, lr_0 = 2.1787e-04
Validation rmse Energy = 1.130072
Validation R2 Energy = 0.934756
Epoch 59
Train function
Loss = 1.6980e-05, PNorm = 53.8718, GNorm = 0.0542, lr_0 = 2.0997e-04
Validation rmse Energy = 1.125854
Validation R2 Energy = 0.935242
Epoch 60
Train function
Validation rmse Energy = 1.131846
Validation R2 Energy = 0.934551
Epoch 61
Train function
Loss = 1.5729e-05, PNorm = 53.8746, GNorm = 0.0535, lr_0 = 2.0236e-04
Validation rmse Energy = 1.127252
Validation R2 Energy = 0.935081
Epoch 62
Train function
Loss = 1.7946e-05, PNorm = 53.8771, GNorm = 0.1303, lr_0 = 1.9502e-04
Validation rmse Energy = 1.135024
Validation R2 Energy = 0.934183
Epoch 63
Train function
Loss = 1.6450e-05, PNorm = 53.8795, GNorm = 0.0453, lr_0 = 1.8795e-04
Loss = 2.0211e-05, PNorm = 53.8797, GNorm = 0.0500, lr_0 = 1.8732e-04
Validation rmse Energy = 1.132512
Validation R2 Energy = 0.934474
Epoch 64
Train function
Validation rmse Energy = 1.130185
Validation R2 Energy = 0.934743
Epoch 65
Train function
Loss = 1.8712e-05, PNorm = 53.8813, GNorm = 0.0297, lr_0 = 1.8114e-04
Validation rmse Energy = 1.128020
Validation R2 Energy = 0.934993
Epoch 66
Train function
Loss = 9.8954e-06, PNorm = 53.8832, GNorm = 0.0896, lr_0 = 1.7458e-04
Validation rmse Energy = 1.126890
Validation R2 Energy = 0.935123
Epoch 67
Train function
Validation rmse Energy = 1.138128
Validation R2 Energy = 0.933823
Epoch 68
Train function
Loss = 1.5954e-05, PNorm = 53.8853, GNorm = 0.0957, lr_0 = 1.6768e-04
Validation rmse Energy = 1.130781
Validation R2 Energy = 0.934674
Epoch 69
Train function
Loss = 1.6091e-05, PNorm = 53.8869, GNorm = 0.0493, lr_0 = 1.6161e-04
Validation rmse Energy = 1.128696
Validation R2 Energy = 0.934915
Epoch 70
Train function
Loss = 1.3939e-05, PNorm = 53.8884, GNorm = 0.0404, lr_0 = 1.5627e-04
Validation rmse Energy = 1.135752
Validation R2 Energy = 0.934098
Epoch 71
Train function
Validation rmse Energy = 1.132728
Validation R2 Energy = 0.934449
Epoch 72
Train function
Loss = 1.3534e-05, PNorm = 53.8896, GNorm = 0.1013, lr_0 = 1.5010e-04
Validation rmse Energy = 1.132335
Validation R2 Energy = 0.934494
Epoch 73
Train function
Loss = 1.3199e-05, PNorm = 53.8919, GNorm = 0.0700, lr_0 = 1.4466e-04
Validation rmse Energy = 1.127491
Validation R2 Energy = 0.935054
Epoch 74
Train function
Loss = 1.3905e-05, PNorm = 53.8935, GNorm = 0.0746, lr_0 = 1.3942e-04
Validation rmse Energy = 1.132024
Validation R2 Energy = 0.934530
Epoch 75
Train function
Validation rmse Energy = 1.129780
Validation R2 Energy = 0.934790
Epoch 76
Train function
Loss = 1.2488e-05, PNorm = 53.8946, GNorm = 0.0472, lr_0 = 1.3436e-04
Validation rmse Energy = 1.131293
Validation R2 Energy = 0.934615
Epoch 77
Train function
Loss = 1.3746e-05, PNorm = 53.8960, GNorm = 0.0553, lr_0 = 1.2949e-04
Validation rmse Energy = 1.128461
Validation R2 Energy = 0.934942
Epoch 78
Train function
Validation rmse Energy = 1.132628
Validation R2 Energy = 0.934461
Epoch 79
Train function
Loss = 1.3095e-05, PNorm = 53.8971, GNorm = 0.0678, lr_0 = 1.2438e-04
Validation rmse Energy = 1.130713
Validation R2 Energy = 0.934682
Epoch 80
Train function
Loss = 1.0982e-05, PNorm = 53.8982, GNorm = 0.0315, lr_0 = 1.2027e-04
Validation rmse Energy = 1.131179
Validation R2 Energy = 0.934628
Epoch 81
Train function
Loss = 1.2461e-05, PNorm = 53.8992, GNorm = 0.1928, lr_0 = 1.1592e-04
Loss = 1.3212e-05, PNorm = 53.8993, GNorm = 0.0319, lr_0 = 1.1553e-04
Validation rmse Energy = 1.131390
Validation R2 Energy = 0.934604
Epoch 82
Train function
Validation rmse Energy = 1.131236
Validation R2 Energy = 0.934622
Epoch 83
Train function
Loss = 1.5572e-05, PNorm = 53.9006, GNorm = 0.0427, lr_0 = 1.1134e-04
Validation rmse Energy = 1.126645
Validation R2 Energy = 0.935151
Epoch 84
Train function
Loss = 1.0960e-05, PNorm = 53.9017, GNorm = 0.0645, lr_0 = 1.0730e-04
Validation rmse Energy = 1.130516
Validation R2 Energy = 0.934705
Epoch 85
Train function
Validation rmse Energy = 1.129628
Validation R2 Energy = 0.934807
Epoch 86
Train function
Loss = 7.0709e-06, PNorm = 53.9027, GNorm = 0.0266, lr_0 = 1.0341e-04
Validation rmse Energy = 1.122797
Validation R2 Energy = 0.935593
Epoch 87
Train function
Loss = 1.4555e-05, PNorm = 53.9037, GNorm = 0.1277, lr_0 = 1.0000e-04
Validation rmse Energy = 1.145447
Validation R2 Energy = 0.932969
Epoch 88
Train function
Loss = 1.5057e-05, PNorm = 53.9047, GNorm = 0.1468, lr_0 = 1.0000e-04
Loss = 2.4612e-05, PNorm = 53.9047, GNorm = 0.1463, lr_0 = 1.0000e-04
Validation rmse Energy = 1.126220
Validation R2 Energy = 0.935200
Epoch 89
Train function
Validation rmse Energy = 1.124909
Validation R2 Energy = 0.935351
Epoch 90
Train function
Loss = 5.5622e-06, PNorm = 53.9056, GNorm = 0.0621, lr_0 = 1.0000e-04
Validation rmse Energy = 1.130786
Validation R2 Energy = 0.934674
Epoch 91
Train function
Loss = 1.0205e-05, PNorm = 53.9066, GNorm = 0.0300, lr_0 = 1.0000e-04
Validation rmse Energy = 1.130707
Validation R2 Energy = 0.934683
Epoch 92
Train function
Validation rmse Energy = 1.130490
Validation R2 Energy = 0.934708
Epoch 93
Train function
Loss = 1.2754e-05, PNorm = 53.9075, GNorm = 0.0437, lr_0 = 1.0000e-04
Validation rmse Energy = 1.125998
Validation R2 Energy = 0.935226
Epoch 94
Train function
Loss = 6.9822e-06, PNorm = 53.9084, GNorm = 0.0694, lr_0 = 1.0000e-04
Validation rmse Energy = 1.127493
Validation R2 Energy = 0.935053
Epoch 95
Train function
Loss = 9.8885e-06, PNorm = 53.9093, GNorm = 0.0302, lr_0 = 1.0000e-04
Validation rmse Energy = 1.127641
Validation R2 Energy = 0.935036
Epoch 96
Train function
Validation rmse Energy = 1.131510
Validation R2 Energy = 0.934590
Epoch 97
Train function
Loss = 1.0697e-05, PNorm = 53.9102, GNorm = 0.0727, lr_0 = 1.0000e-04
Validation rmse Energy = 1.130172
Validation R2 Energy = 0.934744
Epoch 98
Train function
Loss = 1.2195e-05, PNorm = 53.9111, GNorm = 0.0199, lr_0 = 1.0000e-04
Validation rmse Energy = 1.127857
Validation R2 Energy = 0.935012
Epoch 99
Train function
Loss = 1.5672e-05, PNorm = 53.9120, GNorm = 0.2946, lr_0 = 1.0000e-04
Validation rmse Energy = 1.132974
Validation R2 Energy = 0.934420
Model 0 best validation rmse = 1.117238 on epoch 35
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Fold 0
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 10 | train size = 7 | val size = 3 | test size = 10
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Loss = 1.5260e-01, PNorm = 52.9115, GNorm = 6.9065, lr_0 = 1.0000e-04
Validation rmse Energy = 2.894974
Validation R2 Energy = -1.057150
Epoch 1
Train function
Loss = 1.1855e-01, PNorm = 52.9119, GNorm = 6.0967, lr_0 = 1.0000e-04
Validation rmse Energy = 2.665025
Validation R2 Energy = -0.743328
Epoch 2
Train function
Loss = 8.9717e-02, PNorm = 52.9125, GNorm = 4.4063, lr_0 = 1.0000e-04
Validation rmse Energy = 2.377368
Validation R2 Energy = -0.387297
Epoch 3
Train function
Loss = 6.8884e-02, PNorm = 52.9133, GNorm = 3.7393, lr_0 = 1.0000e-04
Validation rmse Energy = 2.182401
Validation R2 Energy = -0.169084
Epoch 4
Train function
Loss = 5.4709e-02, PNorm = 52.9142, GNorm = 4.5475, lr_0 = 1.0000e-04
Validation rmse Energy = 2.096028
Validation R2 Energy = -0.078378
Epoch 5
Train function
Loss = 4.1286e-02, PNorm = 52.9152, GNorm = 2.8787, lr_0 = 1.0000e-04
Validation rmse Energy = 2.062464
Validation R2 Energy = -0.044117
Epoch 6
Train function
Loss = 3.2835e-02, PNorm = 52.9163, GNorm = 2.4922, lr_0 = 1.0000e-04
Validation rmse Energy = 1.988551
Validation R2 Energy = 0.029378
Epoch 7
Train function
Validation rmse Energy = 1.854000
Validation R2 Energy = 0.156284
Epoch 8
Train function
Validation rmse Energy = 1.752558
Validation R2 Energy = 0.246087
Epoch 9
Train function
Validation rmse Energy = 1.746960
Validation R2 Energy = 0.250895
Epoch 10
Train function
Validation rmse Energy = 1.780684
Validation R2 Energy = 0.221695
Epoch 11
Train function
Validation rmse Energy = 1.766674
Validation R2 Energy = 0.233893
Epoch 12
Train function
Validation rmse Energy = 1.742818
Validation R2 Energy = 0.254443
Epoch 13
Train function
Validation rmse Energy = 1.783806
Validation R2 Energy = 0.218962
Epoch 14
Train function
Validation rmse Energy = 1.878301
Validation R2 Energy = 0.134022
Epoch 15
Train function
Validation rmse Energy = 1.946274
Validation R2 Energy = 0.070210
Epoch 16
Train function
Validation rmse Energy = 1.963524
Validation R2 Energy = 0.053656
Epoch 17
Train function
Validation rmse Energy = 1.999548
Validation R2 Energy = 0.018613
Epoch 18
Train function
Validation rmse Energy = 2.066356
Validation R2 Energy = -0.048061
Epoch 19
Train function
Validation rmse Energy = 2.097365
Validation R2 Energy = -0.079753
Epoch 20
Train function
Validation rmse Energy = 2.077422
Validation R2 Energy = -0.059317
Epoch 21
Train function
Validation rmse Energy = 2.080313
Validation R2 Energy = -0.062268
Epoch 22
Train function
Validation rmse Energy = 2.100728
Validation R2 Energy = -0.083219
Epoch 23
Train function
Validation rmse Energy = 2.070215
Validation R2 Energy = -0.051980
Epoch 24
Train function
Validation rmse Energy = 2.044620
Validation R2 Energy = -0.026128
Epoch 25
Train function
Validation rmse Energy = 2.058446
Validation R2 Energy = -0.040054
Epoch 26
Train function
Validation rmse Energy = 2.041559
Validation R2 Energy = -0.023058
Epoch 27
Train function
Validation rmse Energy = 2.031519
Validation R2 Energy = -0.013020
Epoch 28
Train function
Validation rmse Energy = 2.060278
Validation R2 Energy = -0.041905
Epoch 29
Train function
Validation rmse Energy = 2.060058
Validation R2 Energy = -0.041683
Epoch 30
Train function
Validation rmse Energy = 2.069290
Validation R2 Energy = -0.051040
Epoch 31
Train function
Validation rmse Energy = 2.104183
Validation R2 Energy = -0.086785
Epoch 32
Train function
Validation rmse Energy = 2.108063
Validation R2 Energy = -0.090797
Epoch 33
Train function
Validation rmse Energy = 2.117800
Validation R2 Energy = -0.100897
Epoch 34
Train function
Validation rmse Energy = 2.143751
Validation R2 Energy = -0.128042
Epoch 35
Train function
Validation rmse Energy = 2.136502
Validation R2 Energy = -0.120426
Epoch 36
Train function
Validation rmse Energy = 2.134662
Validation R2 Energy = -0.118497
Epoch 37
Train function
Validation rmse Energy = 2.142542
Validation R2 Energy = -0.126770
Epoch 38
Train function
Validation rmse Energy = 2.120400
Validation R2 Energy = -0.103601
Epoch 39
Train function
Validation rmse Energy = 2.109164
Validation R2 Energy = -0.091936
Epoch 40
Train function
Validation rmse Energy = 2.107242
Validation R2 Energy = -0.089947
Epoch 41
Train function
Validation rmse Energy = 2.085202
Validation R2 Energy = -0.067267
Epoch 42
Train function
Validation rmse Energy = 2.084520
Validation R2 Energy = -0.066568
Epoch 43
Train function
Validation rmse Energy = 2.089268
Validation R2 Energy = -0.071433
Epoch 44
Train function
Validation rmse Energy = 2.083042
Validation R2 Energy = -0.065056
Epoch 45
Train function
Validation rmse Energy = 2.099887
Validation R2 Energy = -0.082352
Epoch 46
Train function
Validation rmse Energy = 2.108542
Validation R2 Energy = -0.091293
Epoch 47
Train function
Validation rmse Energy = 2.111084
Validation R2 Energy = -0.093925
Epoch 48
Train function
Validation rmse Energy = 2.128650
Validation R2 Energy = -0.112206
Epoch 49
Train function
Validation rmse Energy = 2.125810
Validation R2 Energy = -0.109240
Epoch 50
Train function
Validation rmse Energy = 2.126572
Validation R2 Energy = -0.110036
Epoch 51
Train function
Validation rmse Energy = 2.132235
Validation R2 Energy = -0.115955
Epoch 52
Train function
Validation rmse Energy = 2.120334
Validation R2 Energy = -0.103533
Epoch 53
Train function
Validation rmse Energy = 2.122830
Validation R2 Energy = -0.106133
Epoch 54
Train function
Validation rmse Energy = 2.118643
Validation R2 Energy = -0.101773
Epoch 55
Train function
Validation rmse Energy = 2.111490
Validation R2 Energy = -0.094346
Epoch 56
Train function
Validation rmse Energy = 2.117501
Validation R2 Energy = -0.100586
Epoch 57
Train function
Validation rmse Energy = 2.110311
Validation R2 Energy = -0.093124
Epoch 58
Train function
Validation rmse Energy = 2.115443
Validation R2 Energy = -0.098448
Epoch 59
Train function
Validation rmse Energy = 2.118038
Validation R2 Energy = -0.101144
Epoch 60
Train function
Validation rmse Energy = 2.117313
Validation R2 Energy = -0.100391
Epoch 61
Train function
Validation rmse Energy = 2.126851
Validation R2 Energy = -0.110326
Epoch 62
Train function
Validation rmse Energy = 2.123584
Validation R2 Energy = -0.106918
Epoch 63
Train function
Validation rmse Energy = 2.130106
Validation R2 Energy = -0.113727
Epoch 64
Train function
Validation rmse Energy = 2.128704
Validation R2 Energy = -0.112262
Epoch 65
Train function
Validation rmse Energy = 2.126422
Validation R2 Energy = -0.109878
Epoch 66
Train function
Validation rmse Energy = 2.127488
Validation R2 Energy = -0.110992
Epoch 67
Train function
Validation rmse Energy = 2.118927
Validation R2 Energy = -0.102068
Epoch 68
Train function
Validation rmse Energy = 2.121209
Validation R2 Energy = -0.104444
Epoch 69
Train function
Validation rmse Energy = 2.113008
Validation R2 Energy = -0.095920
Epoch 70
Train function
Validation rmse Energy = 2.116028
Validation R2 Energy = -0.099055
Epoch 71
Train function
Loss = 1.3259e-05, PNorm = 52.9332, GNorm = 0.2870, lr_0 = 1.0000e-04
Validation rmse Energy = 2.112754
Validation R2 Energy = -0.095656
Epoch 72
Train function
Loss = 8.9350e-06, PNorm = 52.9332, GNorm = 0.1833, lr_0 = 1.0000e-04
Validation rmse Energy = 2.115892
Validation R2 Energy = -0.098914
Epoch 73
Train function
Loss = 5.0271e-06, PNorm = 52.9332, GNorm = 0.0907, lr_0 = 1.0000e-04
Validation rmse Energy = 2.117489
Validation R2 Energy = -0.100573
Epoch 74
Train function
Loss = 2.4123e-06, PNorm = 52.9332, GNorm = 0.0243, lr_0 = 1.0000e-04
Validation rmse Energy = 2.119044
Validation R2 Energy = -0.102190
Epoch 75
Train function
Loss = 1.5835e-06, PNorm = 52.9332, GNorm = 0.0960, lr_0 = 1.0000e-04
Validation rmse Energy = 2.122941
Validation R2 Energy = -0.106248
Epoch 76
Train function
Loss = 2.5263e-06, PNorm = 52.9333, GNorm = 0.1724, lr_0 = 1.0000e-04
Validation rmse Energy = 2.121224
Validation R2 Energy = -0.104460
Epoch 77
Train function
Loss = 4.9241e-06, PNorm = 52.9333, GNorm = 0.2529, lr_0 = 1.0000e-04
Validation rmse Energy = 2.125900
Validation R2 Energy = -0.109333
Epoch 78
Train function
Validation rmse Energy = 2.120034
Validation R2 Energy = -0.103221
Epoch 79
Train function
Validation rmse Energy = 2.126495
Validation R2 Energy = -0.109955
Epoch 80
Train function
Validation rmse Energy = 2.115683
Validation R2 Energy = -0.098697
Epoch 81
Train function
Validation rmse Energy = 2.127714
Validation R2 Energy = -0.111228
Epoch 82
Train function
Validation rmse Energy = 2.109071
Validation R2 Energy = -0.091840
Epoch 83
Train function
Validation rmse Energy = 2.133376
Validation R2 Energy = -0.117150
Epoch 84
Train function
Validation rmse Energy = 2.101809
Validation R2 Energy = -0.084334
Epoch 85
Train function
Validation rmse Energy = 2.142149
Validation R2 Energy = -0.126357
Epoch 86
Train function
Validation rmse Energy = 2.100828
Validation R2 Energy = -0.083322
Epoch 87
Train function
Validation rmse Energy = 2.134562
Validation R2 Energy = -0.118392
Epoch 88
Train function
Validation rmse Energy = 2.117489
Validation R2 Energy = -0.100573
Epoch 89
Train function
Validation rmse Energy = 2.112917
Validation R2 Energy = -0.095825
Epoch 90
Train function
Validation rmse Energy = 2.137505
Validation R2 Energy = -0.121478
Epoch 91
Train function
Validation rmse Energy = 2.106919
Validation R2 Energy = -0.089613
Epoch 92
Train function
Validation rmse Energy = 2.127363
Validation R2 Energy = -0.110861
Epoch 93
Train function
Validation rmse Energy = 2.120609
Validation R2 Energy = -0.103819
Epoch 94
Train function
Validation rmse Energy = 2.107006
Validation R2 Energy = -0.089703
Epoch 95
Train function
Validation rmse Energy = 2.129515
Validation R2 Energy = -0.113110
Epoch 96
Train function
Validation rmse Energy = 2.108349
Validation R2 Energy = -0.091092
Epoch 97
Train function
Validation rmse Energy = 2.115373
Validation R2 Energy = -0.098375
Epoch 98
Train function
Validation rmse Energy = 2.124967
Validation R2 Energy = -0.108361
Epoch 99
Train function
Validation rmse Energy = 2.107770
Validation R2 Energy = -0.090494
Model 0 best validation rmse = 1.742818 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Fold 0
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 10 | train size = 7 | val size = 3 | test size = 10
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Loss = 1.5260e-01, PNorm = 52.9115, GNorm = 6.9065, lr_0 = 1.0000e-04
Validation rmse Energy = 2.894974
Validation R2 Energy = -1.057150
Epoch 1
Train function
Loss = 1.1855e-01, PNorm = 52.9119, GNorm = 6.0967, lr_0 = 1.0000e-04
Validation rmse Energy = 2.665025
Validation R2 Energy = -0.743328
Epoch 2
Train function
Loss = 8.9717e-02, PNorm = 52.9125, GNorm = 4.4063, lr_0 = 1.0000e-04
Validation rmse Energy = 2.377368
Validation R2 Energy = -0.387297
Epoch 3
Train function
Loss = 6.8884e-02, PNorm = 52.9133, GNorm = 3.7393, lr_0 = 1.0000e-04
Validation rmse Energy = 2.182401
Validation R2 Energy = -0.169084
Epoch 4
Train function
Loss = 5.4709e-02, PNorm = 52.9142, GNorm = 4.5475, lr_0 = 1.0000e-04
Validation rmse Energy = 2.096028
Validation R2 Energy = -0.078378
Epoch 5
Train function
Loss = 4.1286e-02, PNorm = 52.9152, GNorm = 2.8787, lr_0 = 1.0000e-04
Validation rmse Energy = 2.062464
Validation R2 Energy = -0.044117
Epoch 6
Train function
Loss = 3.2835e-02, PNorm = 52.9163, GNorm = 2.4922, lr_0 = 1.0000e-04
Validation rmse Energy = 1.988551
Validation R2 Energy = 0.029378
Epoch 7
Train function
Validation rmse Energy = 1.854000
Validation R2 Energy = 0.156284
Epoch 8
Train function
Validation rmse Energy = 1.752558
Validation R2 Energy = 0.246087
Epoch 9
Train function
Validation rmse Energy = 1.746960
Validation R2 Energy = 0.250895
Epoch 10
Train function
Validation rmse Energy = 1.780684
Validation R2 Energy = 0.221695
Epoch 11
Train function
Validation rmse Energy = 1.766674
Validation R2 Energy = 0.233893
Epoch 12
Train function
Validation rmse Energy = 1.742818
Validation R2 Energy = 0.254443
Epoch 13
Train function
Validation rmse Energy = 1.783806
Validation R2 Energy = 0.218962
Epoch 14
Train function
Validation rmse Energy = 1.878301
Validation R2 Energy = 0.134022
Epoch 15
Train function
Validation rmse Energy = 1.946274
Validation R2 Energy = 0.070210
Epoch 16
Train function
Validation rmse Energy = 1.963524
Validation R2 Energy = 0.053656
Epoch 17
Train function
Validation rmse Energy = 1.999548
Validation R2 Energy = 0.018613
Epoch 18
Train function
Validation rmse Energy = 2.066356
Validation R2 Energy = -0.048061
Epoch 19
Train function
Validation rmse Energy = 2.097365
Validation R2 Energy = -0.079753
Epoch 20
Train function
Validation rmse Energy = 2.077422
Validation R2 Energy = -0.059317
Epoch 21
Train function
Validation rmse Energy = 2.080313
Validation R2 Energy = -0.062268
Epoch 22
Train function
Validation rmse Energy = 2.100728
Validation R2 Energy = -0.083219
Epoch 23
Train function
Validation rmse Energy = 2.070215
Validation R2 Energy = -0.051980
Epoch 24
Train function
Validation rmse Energy = 2.044620
Validation R2 Energy = -0.026128
Epoch 25
Train function
Validation rmse Energy = 2.058446
Validation R2 Energy = -0.040054
Epoch 26
Train function
Validation rmse Energy = 2.041559
Validation R2 Energy = -0.023058
Epoch 27
Train function
Validation rmse Energy = 2.031519
Validation R2 Energy = -0.013020
Epoch 28
Train function
Validation rmse Energy = 2.060278
Validation R2 Energy = -0.041905
Epoch 29
Train function
Validation rmse Energy = 2.060058
Validation R2 Energy = -0.041683
Epoch 30
Train function
Validation rmse Energy = 2.069290
Validation R2 Energy = -0.051040
Epoch 31
Train function
Validation rmse Energy = 2.104183
Validation R2 Energy = -0.086785
Epoch 32
Train function
Validation rmse Energy = 2.108063
Validation R2 Energy = -0.090797
Epoch 33
Train function
Validation rmse Energy = 2.117800
Validation R2 Energy = -0.100897
Epoch 34
Train function
Validation rmse Energy = 2.143751
Validation R2 Energy = -0.128042
Epoch 35
Train function
Validation rmse Energy = 2.136502
Validation R2 Energy = -0.120426
Epoch 36
Train function
Validation rmse Energy = 2.134662
Validation R2 Energy = -0.118497
Epoch 37
Train function
Validation rmse Energy = 2.142542
Validation R2 Energy = -0.126770
Epoch 38
Train function
Validation rmse Energy = 2.120400
Validation R2 Energy = -0.103601
Epoch 39
Train function
Validation rmse Energy = 2.109164
Validation R2 Energy = -0.091936
Epoch 40
Train function
Validation rmse Energy = 2.107242
Validation R2 Energy = -0.089947
Epoch 41
Train function
Validation rmse Energy = 2.085202
Validation R2 Energy = -0.067267
Epoch 42
Train function
Validation rmse Energy = 2.084520
Validation R2 Energy = -0.066568
Epoch 43
Train function
Validation rmse Energy = 2.089268
Validation R2 Energy = -0.071433
Epoch 44
Train function
Validation rmse Energy = 2.083042
Validation R2 Energy = -0.065056
Epoch 45
Train function
Validation rmse Energy = 2.099887
Validation R2 Energy = -0.082352
Epoch 46
Train function
Validation rmse Energy = 2.108542
Validation R2 Energy = -0.091293
Epoch 47
Train function
Validation rmse Energy = 2.111084
Validation R2 Energy = -0.093925
Epoch 48
Train function
Validation rmse Energy = 2.128650
Validation R2 Energy = -0.112206
Epoch 49
Train function
Validation rmse Energy = 2.125810
Validation R2 Energy = -0.109240
Epoch 50
Train function
Validation rmse Energy = 2.126572
Validation R2 Energy = -0.110036
Epoch 51
Train function
Validation rmse Energy = 2.132235
Validation R2 Energy = -0.115955
Epoch 52
Train function
Validation rmse Energy = 2.120334
Validation R2 Energy = -0.103533
Epoch 53
Train function
Validation rmse Energy = 2.122830
Validation R2 Energy = -0.106133
Epoch 54
Train function
Validation rmse Energy = 2.118643
Validation R2 Energy = -0.101773
Epoch 55
Train function
Validation rmse Energy = 2.111490
Validation R2 Energy = -0.094346
Epoch 56
Train function
Validation rmse Energy = 2.117501
Validation R2 Energy = -0.100586
Epoch 57
Train function
Validation rmse Energy = 2.110311
Validation R2 Energy = -0.093124
Epoch 58
Train function
Validation rmse Energy = 2.115443
Validation R2 Energy = -0.098448
Epoch 59
Train function
Validation rmse Energy = 2.118038
Validation R2 Energy = -0.101144
Epoch 60
Train function
Validation rmse Energy = 2.117313
Validation R2 Energy = -0.100391
Epoch 61
Train function
Validation rmse Energy = 2.126851
Validation R2 Energy = -0.110326
Epoch 62
Train function
Validation rmse Energy = 2.123584
Validation R2 Energy = -0.106918
Epoch 63
Train function
Validation rmse Energy = 2.130106
Validation R2 Energy = -0.113727
Epoch 64
Train function
Validation rmse Energy = 2.128704
Validation R2 Energy = -0.112262
Epoch 65
Train function
Validation rmse Energy = 2.126422
Validation R2 Energy = -0.109878
Epoch 66
Train function
Validation rmse Energy = 2.127488
Validation R2 Energy = -0.110992
Epoch 67
Train function
Validation rmse Energy = 2.118927
Validation R2 Energy = -0.102068
Epoch 68
Train function
Validation rmse Energy = 2.121209
Validation R2 Energy = -0.104444
Epoch 69
Train function
Validation rmse Energy = 2.113008
Validation R2 Energy = -0.095920
Epoch 70
Train function
Validation rmse Energy = 2.116028
Validation R2 Energy = -0.099055
Epoch 71
Train function
Loss = 1.3259e-05, PNorm = 52.9332, GNorm = 0.2870, lr_0 = 1.0000e-04
Validation rmse Energy = 2.112754
Validation R2 Energy = -0.095656
Epoch 72
Train function
Loss = 8.9350e-06, PNorm = 52.9332, GNorm = 0.1833, lr_0 = 1.0000e-04
Validation rmse Energy = 2.115892
Validation R2 Energy = -0.098914
Epoch 73
Train function
Loss = 5.0271e-06, PNorm = 52.9332, GNorm = 0.0907, lr_0 = 1.0000e-04
Validation rmse Energy = 2.117489
Validation R2 Energy = -0.100573
Epoch 74
Train function
Loss = 2.4123e-06, PNorm = 52.9332, GNorm = 0.0243, lr_0 = 1.0000e-04
Validation rmse Energy = 2.119044
Validation R2 Energy = -0.102190
Epoch 75
Train function
Loss = 1.5835e-06, PNorm = 52.9332, GNorm = 0.0960, lr_0 = 1.0000e-04
Validation rmse Energy = 2.122941
Validation R2 Energy = -0.106248
Epoch 76
Train function
Loss = 2.5263e-06, PNorm = 52.9333, GNorm = 0.1724, lr_0 = 1.0000e-04
Validation rmse Energy = 2.121224
Validation R2 Energy = -0.104460
Epoch 77
Train function
Loss = 4.9241e-06, PNorm = 52.9333, GNorm = 0.2529, lr_0 = 1.0000e-04
Validation rmse Energy = 2.125900
Validation R2 Energy = -0.109333
Epoch 78
Train function
Validation rmse Energy = 2.120034
Validation R2 Energy = -0.103221
Epoch 79
Train function
Validation rmse Energy = 2.126495
Validation R2 Energy = -0.109955
Epoch 80
Train function
Validation rmse Energy = 2.115683
Validation R2 Energy = -0.098697
Epoch 81
Train function
Validation rmse Energy = 2.127714
Validation R2 Energy = -0.111228
Epoch 82
Train function
Validation rmse Energy = 2.109071
Validation R2 Energy = -0.091840
Epoch 83
Train function
Validation rmse Energy = 2.133376
Validation R2 Energy = -0.117150
Epoch 84
Train function
Validation rmse Energy = 2.101809
Validation R2 Energy = -0.084334
Epoch 85
Train function
Validation rmse Energy = 2.142149
Validation R2 Energy = -0.126357
Epoch 86
Train function
Validation rmse Energy = 2.100828
Validation R2 Energy = -0.083322
Epoch 87
Train function
Validation rmse Energy = 2.134562
Validation R2 Energy = -0.118392
Epoch 88
Train function
Validation rmse Energy = 2.117489
Validation R2 Energy = -0.100573
Epoch 89
Train function
Validation rmse Energy = 2.112917
Validation R2 Energy = -0.095825
Epoch 90
Train function
Validation rmse Energy = 2.137505
Validation R2 Energy = -0.121478
Epoch 91
Train function
Validation rmse Energy = 2.106919
Validation R2 Energy = -0.089613
Epoch 92
Train function
Validation rmse Energy = 2.127363
Validation R2 Energy = -0.110861
Epoch 93
Train function
Validation rmse Energy = 2.120609
Validation R2 Energy = -0.103819
Epoch 94
Train function
Validation rmse Energy = 2.107006
Validation R2 Energy = -0.089703
Epoch 95
Train function
Validation rmse Energy = 2.129515
Validation R2 Energy = -0.113110
Epoch 96
Train function
Validation rmse Energy = 2.108349
Validation R2 Energy = -0.091092
Epoch 97
Train function
Validation rmse Energy = 2.115373
Validation R2 Energy = -0.098375
Epoch 98
Train function
Validation rmse Energy = 2.124967
Validation R2 Energy = -0.108361
Epoch 99
Train function
Validation rmse Energy = 2.107770
Validation R2 Energy = -0.090494
Model 0 best validation rmse = 1.742818 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Fold 0
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 10 | train size = 7 | val size = 3 | test size = 10
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Loss = 1.5260e-01, PNorm = 52.9115, GNorm = 6.9065, lr_0 = 1.0000e-04
Validation rmse Energy = 2.894974
Validation R2 Energy = -1.057150
Epoch 1
Train function
Loss = 1.1855e-01, PNorm = 52.9119, GNorm = 6.0967, lr_0 = 1.0000e-04
Validation rmse Energy = 2.665025
Validation R2 Energy = -0.743328
Epoch 2
Train function
Loss = 8.9717e-02, PNorm = 52.9125, GNorm = 4.4063, lr_0 = 1.0000e-04
Validation rmse Energy = 2.377368
Validation R2 Energy = -0.387297
Epoch 3
Train function
Loss = 6.8884e-02, PNorm = 52.9133, GNorm = 3.7393, lr_0 = 1.0000e-04
Validation rmse Energy = 2.182401
Validation R2 Energy = -0.169084
Epoch 4
Train function
Loss = 5.4709e-02, PNorm = 52.9142, GNorm = 4.5475, lr_0 = 1.0000e-04
Validation rmse Energy = 2.096028
Validation R2 Energy = -0.078378
Epoch 5
Train function
Loss = 4.1286e-02, PNorm = 52.9152, GNorm = 2.8787, lr_0 = 1.0000e-04
Validation rmse Energy = 2.062464
Validation R2 Energy = -0.044117
Epoch 6
Train function
Loss = 3.2835e-02, PNorm = 52.9163, GNorm = 2.4922, lr_0 = 1.0000e-04
Validation rmse Energy = 1.988551
Validation R2 Energy = 0.029378
Epoch 7
Train function
Validation rmse Energy = 1.854000
Validation R2 Energy = 0.156284
Epoch 8
Train function
Validation rmse Energy = 1.752558
Validation R2 Energy = 0.246087
Epoch 9
Train function
Validation rmse Energy = 1.746960
Validation R2 Energy = 0.250895
Epoch 10
Train function
Validation rmse Energy = 1.780684
Validation R2 Energy = 0.221695
Epoch 11
Train function
Validation rmse Energy = 1.766674
Validation R2 Energy = 0.233893
Epoch 12
Train function
Validation rmse Energy = 1.742818
Validation R2 Energy = 0.254443
Epoch 13
Train function
Validation rmse Energy = 1.783806
Validation R2 Energy = 0.218962
Epoch 14
Train function
Validation rmse Energy = 1.878301
Validation R2 Energy = 0.134022
Epoch 15
Train function
Validation rmse Energy = 1.946274
Validation R2 Energy = 0.070210
Epoch 16
Train function
Validation rmse Energy = 1.963524
Validation R2 Energy = 0.053656
Epoch 17
Train function
Validation rmse Energy = 1.999548
Validation R2 Energy = 0.018613
Epoch 18
Train function
Validation rmse Energy = 2.066356
Validation R2 Energy = -0.048061
Epoch 19
Train function
Validation rmse Energy = 2.097365
Validation R2 Energy = -0.079753
Epoch 20
Train function
Validation rmse Energy = 2.077422
Validation R2 Energy = -0.059317
Epoch 21
Train function
Validation rmse Energy = 2.080313
Validation R2 Energy = -0.062268
Epoch 22
Train function
Validation rmse Energy = 2.100728
Validation R2 Energy = -0.083219
Epoch 23
Train function
Validation rmse Energy = 2.070215
Validation R2 Energy = -0.051980
Epoch 24
Train function
Validation rmse Energy = 2.044620
Validation R2 Energy = -0.026128
Epoch 25
Train function
Validation rmse Energy = 2.058446
Validation R2 Energy = -0.040054
Epoch 26
Train function
Validation rmse Energy = 2.041559
Validation R2 Energy = -0.023058
Epoch 27
Train function
Validation rmse Energy = 2.031519
Validation R2 Energy = -0.013020
Epoch 28
Train function
Validation rmse Energy = 2.060278
Validation R2 Energy = -0.041905
Epoch 29
Train function
Validation rmse Energy = 2.060058
Validation R2 Energy = -0.041683
Epoch 30
Train function
Validation rmse Energy = 2.069290
Validation R2 Energy = -0.051040
Epoch 31
Train function
Validation rmse Energy = 2.104183
Validation R2 Energy = -0.086785
Epoch 32
Train function
Validation rmse Energy = 2.108063
Validation R2 Energy = -0.090797
Epoch 33
Train function
Validation rmse Energy = 2.117800
Validation R2 Energy = -0.100897
Epoch 34
Train function
Validation rmse Energy = 2.143751
Validation R2 Energy = -0.128042
Epoch 35
Train function
Validation rmse Energy = 2.136502
Validation R2 Energy = -0.120426
Epoch 36
Train function
Validation rmse Energy = 2.134662
Validation R2 Energy = -0.118497
Epoch 37
Train function
Validation rmse Energy = 2.142542
Validation R2 Energy = -0.126770
Epoch 38
Train function
Validation rmse Energy = 2.120400
Validation R2 Energy = -0.103601
Epoch 39
Train function
Validation rmse Energy = 2.109164
Validation R2 Energy = -0.091936
Epoch 40
Train function
Validation rmse Energy = 2.107242
Validation R2 Energy = -0.089947
Epoch 41
Train function
Validation rmse Energy = 2.085202
Validation R2 Energy = -0.067267
Epoch 42
Train function
Validation rmse Energy = 2.084520
Validation R2 Energy = -0.066568
Epoch 43
Train function
Validation rmse Energy = 2.089268
Validation R2 Energy = -0.071433
Epoch 44
Train function
Validation rmse Energy = 2.083042
Validation R2 Energy = -0.065056
Epoch 45
Train function
Validation rmse Energy = 2.099887
Validation R2 Energy = -0.082352
Epoch 46
Train function
Validation rmse Energy = 2.108542
Validation R2 Energy = -0.091293
Epoch 47
Train function
Validation rmse Energy = 2.111084
Validation R2 Energy = -0.093925
Epoch 48
Train function
Validation rmse Energy = 2.128650
Validation R2 Energy = -0.112206
Epoch 49
Train function
Validation rmse Energy = 2.125810
Validation R2 Energy = -0.109240
Epoch 50
Train function
Validation rmse Energy = 2.126572
Validation R2 Energy = -0.110036
Epoch 51
Train function
Validation rmse Energy = 2.132235
Validation R2 Energy = -0.115955
Epoch 52
Train function
Validation rmse Energy = 2.120334
Validation R2 Energy = -0.103533
Epoch 53
Train function
Validation rmse Energy = 2.122830
Validation R2 Energy = -0.106133
Epoch 54
Train function
Validation rmse Energy = 2.118643
Validation R2 Energy = -0.101773
Epoch 55
Train function
Validation rmse Energy = 2.111490
Validation R2 Energy = -0.094346
Epoch 56
Train function
Validation rmse Energy = 2.117501
Validation R2 Energy = -0.100586
Epoch 57
Train function
Validation rmse Energy = 2.110311
Validation R2 Energy = -0.093124
Epoch 58
Train function
Validation rmse Energy = 2.115443
Validation R2 Energy = -0.098448
Epoch 59
Train function
Validation rmse Energy = 2.118038
Validation R2 Energy = -0.101144
Epoch 60
Train function
Validation rmse Energy = 2.117313
Validation R2 Energy = -0.100391
Epoch 61
Train function
Validation rmse Energy = 2.126851
Validation R2 Energy = -0.110326
Epoch 62
Train function
Validation rmse Energy = 2.123584
Validation R2 Energy = -0.106918
Epoch 63
Train function
Validation rmse Energy = 2.130106
Validation R2 Energy = -0.113727
Epoch 64
Train function
Validation rmse Energy = 2.128704
Validation R2 Energy = -0.112262
Epoch 65
Train function
Validation rmse Energy = 2.126422
Validation R2 Energy = -0.109878
Epoch 66
Train function
Validation rmse Energy = 2.127488
Validation R2 Energy = -0.110992
Epoch 67
Train function
Validation rmse Energy = 2.118927
Validation R2 Energy = -0.102068
Epoch 68
Train function
Validation rmse Energy = 2.121209
Validation R2 Energy = -0.104444
Epoch 69
Train function
Validation rmse Energy = 2.113008
Validation R2 Energy = -0.095920
Epoch 70
Train function
Validation rmse Energy = 2.116028
Validation R2 Energy = -0.099055
Epoch 71
Train function
Loss = 1.3259e-05, PNorm = 52.9332, GNorm = 0.2870, lr_0 = 1.0000e-04
Validation rmse Energy = 2.112754
Validation R2 Energy = -0.095656
Epoch 72
Train function
Loss = 8.9350e-06, PNorm = 52.9332, GNorm = 0.1833, lr_0 = 1.0000e-04
Validation rmse Energy = 2.115892
Validation R2 Energy = -0.098914
Epoch 73
Train function
Loss = 5.0271e-06, PNorm = 52.9332, GNorm = 0.0907, lr_0 = 1.0000e-04
Validation rmse Energy = 2.117489
Validation R2 Energy = -0.100573
Epoch 74
Train function
Loss = 2.4123e-06, PNorm = 52.9332, GNorm = 0.0243, lr_0 = 1.0000e-04
Validation rmse Energy = 2.119044
Validation R2 Energy = -0.102190
Epoch 75
Train function
Loss = 1.5835e-06, PNorm = 52.9332, GNorm = 0.0960, lr_0 = 1.0000e-04
Validation rmse Energy = 2.122941
Validation R2 Energy = -0.106248
Epoch 76
Train function
Loss = 2.5263e-06, PNorm = 52.9333, GNorm = 0.1724, lr_0 = 1.0000e-04
Validation rmse Energy = 2.121224
Validation R2 Energy = -0.104460
Epoch 77
Train function
Loss = 4.9241e-06, PNorm = 52.9333, GNorm = 0.2529, lr_0 = 1.0000e-04
Validation rmse Energy = 2.125900
Validation R2 Energy = -0.109333
Epoch 78
Train function
Validation rmse Energy = 2.120034
Validation R2 Energy = -0.103221
Epoch 79
Train function
Validation rmse Energy = 2.126495
Validation R2 Energy = -0.109955
Epoch 80
Train function
Validation rmse Energy = 2.115683
Validation R2 Energy = -0.098697
Epoch 81
Train function
Validation rmse Energy = 2.127714
Validation R2 Energy = -0.111228
Epoch 82
Train function
Validation rmse Energy = 2.109071
Validation R2 Energy = -0.091840
Epoch 83
Train function
Validation rmse Energy = 2.133376
Validation R2 Energy = -0.117150
Epoch 84
Train function
Validation rmse Energy = 2.101809
Validation R2 Energy = -0.084334
Epoch 85
Train function
Validation rmse Energy = 2.142149
Validation R2 Energy = -0.126357
Epoch 86
Train function
Validation rmse Energy = 2.100828
Validation R2 Energy = -0.083322
Epoch 87
Train function
Validation rmse Energy = 2.134562
Validation R2 Energy = -0.118392
Epoch 88
Train function
Validation rmse Energy = 2.117489
Validation R2 Energy = -0.100573
Epoch 89
Train function
Validation rmse Energy = 2.112917
Validation R2 Energy = -0.095825
Epoch 90
Train function
Validation rmse Energy = 2.137505
Validation R2 Energy = -0.121478
Epoch 91
Train function
Validation rmse Energy = 2.106919
Validation R2 Energy = -0.089613
Epoch 92
Train function
Validation rmse Energy = 2.127363
Validation R2 Energy = -0.110861
Epoch 93
Train function
Validation rmse Energy = 2.120609
Validation R2 Energy = -0.103819
Epoch 94
Train function
Validation rmse Energy = 2.107006
Validation R2 Energy = -0.089703
Epoch 95
Train function
Validation rmse Energy = 2.129515
Validation R2 Energy = -0.113110
Epoch 96
Train function
Validation rmse Energy = 2.108349
Validation R2 Energy = -0.091092
Epoch 97
Train function
Validation rmse Energy = 2.115373
Validation R2 Energy = -0.098375
Epoch 98
Train function
Validation rmse Energy = 2.124967
Validation R2 Energy = -0.108361
Epoch 99
Train function
Validation rmse Energy = 2.107770
Validation R2 Energy = -0.090494
Model 0 best validation rmse = 1.742818 on epoch 12
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 2.242065
Model 0 test R2 Energy = 0.541611
Ensemble test rmse  Energy= 2.242065
Ensemble test R2  Energy= 0.541611
Fold 1
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 199,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 7,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 10 | train size = 7 | val size = 3 | test size = 10
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Loss = 1.4078e-01, PNorm = 52.9115, GNorm = 7.0827, lr_0 = 1.0000e-04
Validation rmse Energy = 1.564925
Validation R2 Energy = -0.355680
Epoch 1
Train function
Loss = 1.0997e-01, PNorm = 52.9119, GNorm = 6.1541, lr_0 = 1.0000e-04
Validation rmse Energy = 1.405122
Validation R2 Energy = -0.092944
Epoch 2
Train function
Loss = 8.3245e-02, PNorm = 52.9124, GNorm = 4.5362, lr_0 = 1.0000e-04
Validation rmse Energy = 1.188678
Validation R2 Energy = 0.217835
Epoch 3
Train function
Loss = 6.3297e-02, PNorm = 52.9132, GNorm = 3.4369, lr_0 = 1.0000e-04
Validation rmse Energy = 1.075748
Validation R2 Energy = 0.359393
Epoch 4
Train function
Loss = 5.0582e-02, PNorm = 52.9140, GNorm = 4.4637, lr_0 = 1.0000e-04
Validation rmse Energy = 1.139226
Validation R2 Energy = 0.281562
Epoch 5
Train function
Loss = 3.7933e-02, PNorm = 52.9149, GNorm = 3.6548, lr_0 = 1.0000e-04
Validation rmse Energy = 1.392013
Validation R2 Energy = -0.072647
Epoch 6
Train function
Loss = 2.7678e-02, PNorm = 52.9160, GNorm = 2.2008, lr_0 = 1.0000e-04
Validation rmse Energy = 1.681907
Validation R2 Energy = -0.565936
Epoch 7
Train function
Validation rmse Energy = 1.844173
Validation R2 Energy = -0.882666
Epoch 8
Train function
Validation rmse Energy = 1.937267
Validation R2 Energy = -1.077539
Epoch 9
Train function
Validation rmse Energy = 2.179140
Validation R2 Energy = -1.628695
Epoch 10
Train function
Validation rmse Energy = 2.506266
Validation R2 Energy = -2.477158
Epoch 11
Train function
Validation rmse Energy = 2.616920
Validation R2 Energy = -2.790974
Epoch 12
Train function
Validation rmse Energy = 2.522748
Validation R2 Energy = -2.523042
Epoch 13
Train function
Validation rmse Energy = 2.532707
Validation R2 Energy = -2.550913
Epoch 14
Train function
Validation rmse Energy = 2.630931
Validation R2 Energy = -2.831677
Epoch 15
Train function
Validation rmse Energy = 2.560581
Validation R2 Energy = -2.629501
Epoch 16
Train function
Validation rmse Energy = 2.375310
Validation R2 Energy = -2.123277
Epoch 17
Train function
Validation rmse Energy = 2.336724
Validation R2 Energy = -2.022630
Epoch 18
Train function
Validation rmse Energy = 2.386779
Validation R2 Energy = -2.153511
Epoch 19
Train function
Validation rmse Energy = 2.292356
Validation R2 Energy = -1.908935
Epoch 20
Train function
Validation rmse Energy = 2.147761
Validation R2 Energy = -1.553536
Epoch 21
Train function
Validation rmse Energy = 2.163611
Validation R2 Energy = -1.591364
Epoch 22
Train function
Validation rmse Energy = 2.216664
Validation R2 Energy = -1.720005
Epoch 23
Train function
Validation rmse Energy = 2.135954
Validation R2 Energy = -1.525537
Epoch 24
Train function
Validation rmse Energy = 2.083457
Validation R2 Energy = -1.402918
Epoch 25
Train function
Validation rmse Energy = 2.168038
Validation R2 Energy = -1.601978
Epoch 26
Train function
Validation rmse Energy = 2.199943
Validation R2 Energy = -1.679124
Epoch 27
Train function
Validation rmse Energy = 2.144829
Validation R2 Energy = -1.546568
Epoch 28
Train function
Validation rmse Energy = 2.190290
Validation R2 Energy = -1.655664
Epoch 29
Train function
Validation rmse Energy = 2.270480
Validation R2 Energy = -1.853682
Epoch 30
Train function
Validation rmse Energy = 2.232593
Validation R2 Energy = -1.759237
Epoch 31
Train function
Validation rmse Energy = 2.223637
Validation R2 Energy = -1.737145
Epoch 32
Train function
Validation rmse Energy = 2.297753
Validation R2 Energy = -1.922649
Epoch 33
Train function
Validation rmse Energy = 2.275811
Validation R2 Energy = -1.867098
Epoch 34
Train function
Validation rmse Energy = 2.230974
Validation R2 Energy = -1.755239
Epoch 35
Train function
Validation rmse Energy = 2.280548
Validation R2 Energy = -1.879045
Epoch 36
Train function
Validation rmse Energy = 2.271450
Validation R2 Energy = -1.856119
Epoch 37
Train function
Validation rmse Energy = 2.212127
Validation R2 Energy = -1.708882
Epoch 38
Train function
Validation rmse Energy = 2.238513
Validation R2 Energy = -1.773891
Epoch 39
Train function
Validation rmse Energy = 2.240435
Validation R2 Energy = -1.778655
Epoch 40
Train function
Validation rmse Energy = 2.179936
Validation R2 Energy = -1.630616
Epoch 41
Train function
Validation rmse Energy = 2.190955
Validation R2 Energy = -1.657279
Epoch 42
Train function
Validation rmse Energy = 2.202610
Validation R2 Energy = -1.685625
Epoch 43
Train function
Validation rmse Energy = 2.152272
Validation R2 Energy = -1.564273
Epoch 44
Train function
Validation rmse Energy = 2.163428
Validation R2 Energy = -1.590925
Epoch 45
Train function
Validation rmse Energy = 2.188181
Validation R2 Energy = -1.650552
Epoch 46
Train function
Validation rmse Energy = 2.153779
Validation R2 Energy = -1.567866
Epoch 47
Train function
Validation rmse Energy = 2.171057
Validation R2 Energy = -1.609231
Epoch 48
Train function
Validation rmse Energy = 2.199066
Validation R2 Energy = -1.676988
Epoch 49
Train function
Validation rmse Energy = 2.171732
Validation R2 Energy = -1.610855
Epoch 50
Train function
Validation rmse Energy = 2.191526
Validation R2 Energy = -1.658663
Epoch 51
Train function
Validation rmse Energy = 2.213509
Validation R2 Energy = -1.712269
Epoch 52
Train function
Validation rmse Energy = 2.187915
Validation R2 Energy = -1.649910
Epoch 53
Train function
Validation rmse Energy = 2.209828
Validation R2 Energy = -1.703254
Epoch 54
Train function
Validation rmse Energy = 2.216532
Validation R2 Energy = -1.719681
Epoch 55
Train function
Validation rmse Energy = 2.190546
Validation R2 Energy = -1.656285
Epoch 56
Train function
Validation rmse Energy = 2.210059
Validation R2 Energy = -1.703821
Epoch 57
Train function
Validation rmse Energy = 2.198771
Validation R2 Energy = -1.676272
Epoch 58
Train function
Validation rmse Energy = 2.180536
Validation R2 Energy = -1.632066
Epoch 59
Train function
Validation rmse Energy = 2.199748
Validation R2 Energy = -1.678649
Epoch 60
Train function
Validation rmse Energy = 2.180899
Validation R2 Energy = -1.632942
Epoch 61
Train function
Validation rmse Energy = 2.181515
Validation R2 Energy = -1.634429
Epoch 62
Train function
Validation rmse Energy = 2.196920
Validation R2 Energy = -1.671768
Epoch 63
Train function
Validation rmse Energy = 2.179670
Validation R2 Energy = -1.629974
Epoch 64
Train function
Validation rmse Energy = 2.197526
Validation R2 Energy = -1.673241
Epoch 65
Train function
Validation rmse Energy = 2.199959
Validation R2 Energy = -1.679164
Epoch 66
Train function
Validation rmse Energy = 2.194427
Validation R2 Energy = -1.665706
Epoch 67
Train function
Validation rmse Energy = 2.215352
Validation R2 Energy = -1.716788
Epoch 68
Train function
Validation rmse Energy = 2.202322
Validation R2 Energy = -1.684923
Epoch 69
Train function
Validation rmse Energy = 2.214249
Validation R2 Energy = -1.714081
Epoch 70
Train function
Validation rmse Energy = 2.214281
Validation R2 Energy = -1.714161
Epoch 71
Train function
Loss = 4.6255e-06, PNorm = 52.9348, GNorm = 0.0788, lr_0 = 1.0000e-04
Validation rmse Energy = 2.205475
Validation R2 Energy = -1.692616
Epoch 72
Train function
Loss = 6.9075e-06, PNorm = 52.9348, GNorm = 0.1893, lr_0 = 1.0000e-04
Validation rmse Energy = 2.217323
Validation R2 Energy = -1.721624
Epoch 73
Train function
Loss = 8.2494e-06, PNorm = 52.9348, GNorm = 0.2481, lr_0 = 1.0000e-04
Validation rmse Energy = 2.200268
Validation R2 Energy = -1.679917
Epoch 74
Train function
Loss = 7.2650e-06, PNorm = 52.9348, GNorm = 0.2314, lr_0 = 1.0000e-04
Validation rmse Energy = 2.210219
Validation R2 Energy = -1.704211
Epoch 75
Train function
Loss = 4.7774e-06, PNorm = 52.9348, GNorm = 0.1613, lr_0 = 1.0000e-04
Validation rmse Energy = 2.201305
Validation R2 Energy = -1.682443
Epoch 76
Train function
Loss = 2.6326e-06, PNorm = 52.9348, GNorm = 0.0660, lr_0 = 1.0000e-04
Validation rmse Energy = 2.200631
Validation R2 Energy = -1.680800
Epoch 77
Train function
Loss = 2.0305e-06, PNorm = 52.9348, GNorm = 0.0419, lr_0 = 1.0000e-04
Validation rmse Energy = 2.204756
Validation R2 Energy = -1.690860
Epoch 78
Train function
Validation rmse Energy = 2.194778
Validation R2 Energy = -1.666559
Epoch 79
Train function
Validation rmse Energy = 2.207018
Validation R2 Energy = -1.696385
Epoch 80
Train function
Validation rmse Energy = 2.194100
Validation R2 Energy = -1.664911
Epoch 81
Train function
Validation rmse Energy = 2.207760
Validation R2 Energy = -1.698198
Epoch 82
Train function
Validation rmse Energy = 2.196964
Validation R2 Energy = -1.671873
Epoch 83
Train function
Validation rmse Energy = 2.207768
Validation R2 Energy = -1.698216
Epoch 84
Train function
Validation rmse Energy = 2.200545
Validation R2 Energy = -1.680592
Epoch 85
Train function
Validation rmse Energy = 2.207143
Validation R2 Energy = -1.696690
Epoch 86
Train function
Validation rmse Energy = 2.202737
Validation R2 Energy = -1.685935
Epoch 87
Train function
Validation rmse Energy = 2.206034
Validation R2 Energy = -1.693980
Epoch 88
Train function
Validation rmse Energy = 2.203378
Validation R2 Energy = -1.687499
Epoch 89
Train function
Validation rmse Energy = 2.204956
Validation R2 Energy = -1.691349
Epoch 90
Train function
Validation rmse Energy = 2.203067
Validation R2 Energy = -1.686738
Epoch 91
Train function
Validation rmse Energy = 2.203995
Validation R2 Energy = -1.689002
Epoch 92
Train function
Validation rmse Energy = 2.201932
Validation R2 Energy = -1.683971
Epoch 93
Train function
Validation rmse Energy = 2.203191
Validation R2 Energy = -1.687041
Epoch 94
Train function
Validation rmse Energy = 2.200221
Validation R2 Energy = -1.679801
Epoch 95
Train function
Validation rmse Energy = 2.203591
Validation R2 Energy = -1.688017
Epoch 96
Train function
Validation rmse Energy = 2.198121
Validation R2 Energy = -1.674688
Epoch 97
Train function
Validation rmse Energy = 2.207025
Validation R2 Energy = -1.696401
Epoch 98
Train function
Validation rmse Energy = 2.193706
Validation R2 Energy = -1.663956
Epoch 99
Train function
Validation rmse Energy = 2.217027
Validation R2 Energy = -1.720897
Model 0 best validation rmse = 1.075748 on epoch 3
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 2.362148
Model 0 test R2 Energy = 0.491194
Ensemble test rmse  Energy= 2.362148
Ensemble test R2  Energy= 0.491194
Fold 2
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 199,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 7,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 10 | train size = 8 | val size = 2 | test size = 10
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Loss = 1.2164e-01, PNorm = 52.9115, GNorm = 8.0965, lr_0 = 1.0000e-04
Validation rmse Energy = 5.018393
Validation R2 Energy = -10.268003
Epoch 1
Train function
Loss = 9.0874e-02, PNorm = 52.9118, GNorm = 4.4671, lr_0 = 1.0000e-04
Validation rmse Energy = 4.770641
Validation R2 Energy = -9.182892
Epoch 2
Train function
Loss = 7.7372e-02, PNorm = 52.9123, GNorm = 5.2658, lr_0 = 1.0000e-04
Validation rmse Energy = 4.775129
Validation R2 Energy = -9.202057
Epoch 3
Train function
Loss = 6.2818e-02, PNorm = 52.9128, GNorm = 3.6412, lr_0 = 1.0000e-04
Validation rmse Energy = 4.862514
Validation R2 Energy = -9.578870
Epoch 4
Train function
Loss = 5.2576e-02, PNorm = 52.9135, GNorm = 2.2023, lr_0 = 1.0000e-04
Validation rmse Energy = 4.908542
Validation R2 Energy = -9.780094
Epoch 5
Train function
Loss = 4.7752e-02, PNorm = 52.9142, GNorm = 3.3223, lr_0 = 1.0000e-04
Validation rmse Energy = 4.833184
Validation R2 Energy = -9.451634
Epoch 6
Train function
Validation rmse Energy = 4.658135
Validation R2 Energy = -8.708268
Epoch 7
Train function
Validation rmse Energy = 4.444393
Validation R2 Energy = -7.837768
Epoch 8
Train function
Validation rmse Energy = 4.284131
Validation R2 Energy = -7.211889
Epoch 9
Train function
Validation rmse Energy = 4.229392
Validation R2 Energy = -7.003383
Epoch 10
Train function
Validation rmse Energy = 4.264782
Validation R2 Energy = -7.137880
Epoch 11
Train function
Validation rmse Energy = 4.322718
Validation R2 Energy = -7.360485
Epoch 12
Train function
Validation rmse Energy = 4.330792
Validation R2 Energy = -7.391745
Epoch 13
Train function
Validation rmse Energy = 4.270331
Validation R2 Energy = -7.159072
Epoch 14
Train function
Validation rmse Energy = 4.187142
Validation R2 Energy = -6.844278
Epoch 15
Train function
Validation rmse Energy = 4.147843
Validation R2 Energy = -6.697722
Epoch 16
Train function
Validation rmse Energy = 4.184813
Validation R2 Energy = -6.835556
Epoch 17
Train function
Validation rmse Energy = 4.274898
Validation R2 Energy = -7.176530
Epoch 18
Train function
Validation rmse Energy = 4.353365
Validation R2 Energy = -7.479452
Epoch 19
Train function
Validation rmse Energy = 4.363578
Validation R2 Energy = -7.519286
Epoch 20
Train function
Validation rmse Energy = 4.314166
Validation R2 Energy = -7.327437
Epoch 21
Train function
Validation rmse Energy = 4.262723
Validation R2 Energy = -7.130023
Epoch 22
Train function
Validation rmse Energy = 4.261456
Validation R2 Energy = -7.125193
Epoch 23
Train function
Validation rmse Energy = 4.309540
Validation R2 Energy = -7.309588
Epoch 24
Train function
Validation rmse Energy = 4.355763
Validation R2 Energy = -7.488797
Epoch 25
Train function
Validation rmse Energy = 4.350341
Validation R2 Energy = -7.467676
Epoch 26
Train function
Validation rmse Energy = 4.299156
Validation R2 Energy = -7.269589
Epoch 27
Train function
Validation rmse Energy = 4.256395
Validation R2 Energy = -7.105902
Epoch 28
Train function
Validation rmse Energy = 4.265986
Validation R2 Energy = -7.142476
Epoch 29
Train function
Validation rmse Energy = 4.312494
Validation R2 Energy = -7.320981
Epoch 30
Train function
Validation rmse Energy = 4.340709
Validation R2 Energy = -7.430221
Epoch 31
Train function
Validation rmse Energy = 4.318321
Validation R2 Energy = -7.343485
Epoch 32
Train function
Validation rmse Energy = 4.275809
Validation R2 Energy = -7.180017
Epoch 33
Train function
Validation rmse Energy = 4.268877
Validation R2 Energy = -7.153517
Epoch 34
Train function
Validation rmse Energy = 4.307258
Validation R2 Energy = -7.300791
Epoch 35
Train function
Validation rmse Energy = 4.343300
Validation R2 Energy = -7.440287
Epoch 36
Train function
Validation rmse Energy = 4.335181
Validation R2 Energy = -7.408763
Epoch 37
Train function
Validation rmse Energy = 4.304184
Validation R2 Energy = -7.288945
Epoch 38
Train function
Validation rmse Energy = 4.301268
Validation R2 Energy = -7.277718
Epoch 39
Train function
Validation rmse Energy = 4.333460
Validation R2 Energy = -7.402089
Epoch 40
Train function
Validation rmse Energy = 4.356496
Validation R2 Energy = -7.491654
Epoch 41
Train function
Validation rmse Energy = 4.340659
Validation R2 Energy = -7.430026
Epoch 42
Train function
Validation rmse Energy = 4.313932
Validation R2 Energy = -7.326532
Epoch 43
Train function
Validation rmse Energy = 4.316874
Validation R2 Energy = -7.337893
Epoch 44
Train function
Validation rmse Energy = 4.343773
Validation R2 Energy = -7.442126
Epoch 45
Train function
Validation rmse Energy = 4.354545
Validation R2 Energy = -7.484048
Epoch 46
Train function
Validation rmse Energy = 4.337026
Validation R2 Energy = -7.415923
Epoch 47
Train function
Validation rmse Energy = 4.321371
Validation R2 Energy = -7.355275
Epoch 48
Train function
Validation rmse Energy = 4.331170
Validation R2 Energy = -7.393208
Epoch 49
Train function
Validation rmse Energy = 4.350329
Validation R2 Energy = -7.467630
Epoch 50
Train function
Validation rmse Energy = 4.349437
Validation R2 Energy = -7.464156
Epoch 51
Train function
Validation rmse Energy = 4.331564
Validation R2 Energy = -7.394738
Epoch 52
Train function
Validation rmse Energy = 4.324785
Validation R2 Energy = -7.368482
Epoch 53
Train function
Validation rmse Energy = 4.336986
Validation R2 Energy = -7.415766
Epoch 54
Train function
Validation rmse Energy = 4.345446
Validation R2 Energy = -7.448632
Epoch 55
Train function
Validation rmse Energy = 4.334230
Validation R2 Energy = -7.405074
Epoch 56
Train function
Validation rmse Energy = 4.318835
Validation R2 Energy = -7.345470
Epoch 57
Train function
Validation rmse Energy = 4.319878
Validation R2 Energy = -7.349502
Epoch 58
Train function
Validation rmse Energy = 4.330437
Validation R2 Energy = -7.390370
Epoch 59
Train function
Validation rmse Energy = 4.329524
Validation R2 Energy = -7.386831
Epoch 60
Train function
Validation rmse Energy = 4.317485
Validation R2 Energy = -7.340254
Epoch 61
Train function
Validation rmse Energy = 4.314150
Validation R2 Energy = -7.327374
Epoch 62
Train function
Loss = 4.5975e-05, PNorm = 52.9457, GNorm = 0.1997, lr_0 = 1.0000e-04
Validation rmse Energy = 4.324855
Validation R2 Energy = -7.368751
Epoch 63
Train function
Loss = 3.5776e-05, PNorm = 52.9458, GNorm = 0.0671, lr_0 = 1.0000e-04
Validation rmse Energy = 4.332195
Validation R2 Energy = -7.397184
Epoch 64
Train function
Loss = 3.4489e-05, PNorm = 52.9458, GNorm = 0.1858, lr_0 = 1.0000e-04
Validation rmse Energy = 4.326059
Validation R2 Energy = -7.373412
Epoch 65
Train function
Loss = 2.2772e-05, PNorm = 52.9459, GNorm = 0.0494, lr_0 = 1.0000e-04
Validation rmse Energy = 4.320629
Validation R2 Energy = -7.352407
Epoch 66
Train function
Loss = 1.9962e-05, PNorm = 52.9460, GNorm = 0.1677, lr_0 = 1.0000e-04
Validation rmse Energy = 4.327623
Validation R2 Energy = -7.379467
Epoch 67
Train function
Loss = 1.0305e-05, PNorm = 52.9461, GNorm = 0.0419, lr_0 = 1.0000e-04
Validation rmse Energy = 4.336071
Validation R2 Energy = -7.412214
Epoch 68
Train function
Validation rmse Energy = 4.332224
Validation R2 Energy = -7.397295
Epoch 69
Train function
Validation rmse Energy = 4.325166
Validation R2 Energy = -7.369955
Epoch 70
Train function
Validation rmse Energy = 4.328123
Validation R2 Energy = -7.381403
Epoch 71
Train function
Validation rmse Energy = 4.334595
Validation R2 Energy = -7.406490
Epoch 72
Train function
Validation rmse Energy = 4.331884
Validation R2 Energy = -7.395979
Epoch 73
Train function
Validation rmse Energy = 4.325021
Validation R2 Energy = -7.369396
Epoch 74
Train function
Validation rmse Energy = 4.326265
Validation R2 Energy = -7.374209
Epoch 75
Train function
Validation rmse Energy = 4.332248
Validation R2 Energy = -7.397388
Epoch 76
Train function
Validation rmse Energy = 4.331537
Validation R2 Energy = -7.394632
Epoch 77
Train function
Validation rmse Energy = 4.326568
Validation R2 Energy = -7.375382
Epoch 78
Train function
Validation rmse Energy = 4.327831
Validation R2 Energy = -7.380275
Epoch 79
Train function
Validation rmse Energy = 4.333272
Validation R2 Energy = -7.401359
Epoch 80
Train function
Validation rmse Energy = 4.333011
Validation R2 Energy = -7.400347
Epoch 81
Train function
Validation rmse Energy = 4.328534
Validation R2 Energy = -7.382997
Epoch 82
Train function
Validation rmse Energy = 4.328835
Validation R2 Energy = -7.384164
Epoch 83
Train function
Validation rmse Energy = 4.332528
Validation R2 Energy = -7.398472
Epoch 84
Train function
Validation rmse Energy = 4.331393
Validation R2 Energy = -7.394074
Epoch 85
Train function
Validation rmse Energy = 4.326975
Validation R2 Energy = -7.376960
Epoch 86
Train function
Validation rmse Energy = 4.326948
Validation R2 Energy = -7.376856
Epoch 87
Train function
Validation rmse Energy = 4.329708
Validation R2 Energy = -7.387544
Epoch 88
Train function
Validation rmse Energy = 4.328461
Validation R2 Energy = -7.382716
Epoch 89
Train function
Validation rmse Energy = 4.325216
Validation R2 Energy = -7.370149
Epoch 90
Train function
Validation rmse Energy = 4.326138
Validation R2 Energy = -7.373719
Epoch 91
Train function
Validation rmse Energy = 4.328849
Validation R2 Energy = -7.384218
Epoch 92
Train function
Validation rmse Energy = 4.327845
Validation R2 Energy = -7.380329
Epoch 93
Train function
Validation rmse Energy = 4.325769
Validation R2 Energy = -7.372291
Epoch 94
Train function
Validation rmse Energy = 4.327263
Validation R2 Energy = -7.378073
Epoch 95
Train function
Validation rmse Energy = 4.329221
Validation R2 Energy = -7.385660
Epoch 96
Train function
Validation rmse Energy = 4.327736
Validation R2 Energy = -7.379905
Epoch 97
Train function
Validation rmse Energy = 4.326232
Validation R2 Energy = -7.374083
Epoch 98
Train function
Validation rmse Energy = 4.327772
Validation R2 Energy = -7.380043
Epoch 99
Train function
Validation rmse Energy = 4.328748
Validation R2 Energy = -7.383824
Model 0 best validation rmse = 4.147843 on epoch 15
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 2.475596
Model 0 test R2 Energy = 0.441147
Ensemble test rmse  Energy= 2.475596
Ensemble test R2  Energy= 0.441147
Fold 3
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 199,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 8,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 10 | train size = 8 | val size = 2 | test size = 10
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Loss = 1.2568e-01, PNorm = 52.9115, GNorm = 7.6871, lr_0 = 1.0000e-04
Validation rmse Energy = 2.260373
Validation R2 Energy = -5.450307
Epoch 1
Train function
Loss = 9.2581e-02, PNorm = 52.9120, GNorm = 4.5604, lr_0 = 1.0000e-04
Validation rmse Energy = 2.772910
Validation R2 Energy = -8.707143
Epoch 2
Train function
Loss = 7.5600e-02, PNorm = 52.9125, GNorm = 4.9658, lr_0 = 1.0000e-04
Validation rmse Energy = 2.647147
Validation R2 Energy = -7.846592
Epoch 3
Train function
Loss = 5.8946e-02, PNorm = 52.9132, GNorm = 4.0119, lr_0 = 1.0000e-04
Validation rmse Energy = 2.136603
Validation R2 Energy = -4.763251
Epoch 4
Train function
Loss = 4.5829e-02, PNorm = 52.9141, GNorm = 2.3856, lr_0 = 1.0000e-04
Validation rmse Energy = 1.605301
Validation R2 Energy = -2.253367
Epoch 5
Train function
Loss = 3.8732e-02, PNorm = 52.9150, GNorm = 2.7549, lr_0 = 1.0000e-04
Validation rmse Energy = 1.356185
Validation R2 Energy = -1.321977
Epoch 6
Train function
Validation rmse Energy = 1.493426
Validation R2 Energy = -1.815708
Epoch 7
Train function
Validation rmse Energy = 1.823244
Validation R2 Energy = -3.196717
Epoch 8
Train function
Validation rmse Energy = 2.049189
Validation R2 Energy = -4.301321
Epoch 9
Train function
Validation rmse Energy = 1.896745
Validation R2 Energy = -3.541905
Epoch 10
Train function
Validation rmse Energy = 1.381408
Validation R2 Energy = -1.409152
Epoch 11
Train function
Validation rmse Energy = 0.785349
Validation R2 Energy = 0.221345
Epoch 12
Train function
Validation rmse Energy = 0.521273
Validation R2 Energy = 0.656956
Epoch 13
Train function
Validation rmse Energy = 0.641339
Validation R2 Energy = 0.480728
Epoch 14
Train function
Validation rmse Energy = 0.923144
Validation R2 Energy = -0.075867
Epoch 15
Train function
Validation rmse Energy = 0.978709
Validation R2 Energy = -0.209281
Epoch 16
Train function
Validation rmse Energy = 0.731575
Validation R2 Energy = 0.324325
Epoch 17
Train function
Validation rmse Energy = 0.477563
Validation R2 Energy = 0.712073
Epoch 18
Train function
Validation rmse Energy = 0.558378
Validation R2 Energy = 0.606381
Epoch 19
Train function
Validation rmse Energy = 0.921305
Validation R2 Energy = -0.071585
Epoch 20
Train function
Validation rmse Energy = 1.276571
Validation R2 Energy = -1.057357
Epoch 21
Train function
Validation rmse Energy = 1.330059
Validation R2 Energy = -1.233376
Epoch 22
Train function
Validation rmse Energy = 1.204004
Validation R2 Energy = -0.830106
Epoch 23
Train function
Validation rmse Energy = 1.194574
Validation R2 Energy = -0.801550
Epoch 24
Train function
Validation rmse Energy = 1.367439
Validation R2 Energy = -1.360672
Epoch 25
Train function
Validation rmse Energy = 1.516708
Validation R2 Energy = -1.904181
Epoch 26
Train function
Validation rmse Energy = 1.391774
Validation R2 Energy = -1.445444
Epoch 27
Train function
Validation rmse Energy = 1.132645
Validation R2 Energy = -0.619599
Epoch 28
Train function
Validation rmse Energy = 1.029398
Validation R2 Energy = -0.337786
Epoch 29
Train function
Validation rmse Energy = 1.093447
Validation R2 Energy = -0.509439
Epoch 30
Train function
Validation rmse Energy = 1.121351
Validation R2 Energy = -0.587461
Epoch 31
Train function
Validation rmse Energy = 1.004151
Validation R2 Energy = -0.272969
Epoch 32
Train function
Validation rmse Energy = 0.951334
Validation R2 Energy = -0.142578
Epoch 33
Train function
Validation rmse Energy = 1.048980
Validation R2 Energy = -0.389168
Epoch 34
Train function
Validation rmse Energy = 1.202613
Validation R2 Energy = -0.825879
Epoch 35
Train function
Validation rmse Energy = 1.227325
Validation R2 Energy = -0.901687
Epoch 36
Train function
Validation rmse Energy = 1.167420
Validation R2 Energy = -0.720577
Epoch 37
Train function
Validation rmse Energy = 1.160201
Validation R2 Energy = -0.699365
Epoch 38
Train function
Validation rmse Energy = 1.210791
Validation R2 Energy = -0.850796
Epoch 39
Train function
Validation rmse Energy = 1.209762
Validation R2 Energy = -0.847652
Epoch 40
Train function
Validation rmse Energy = 1.104945
Validation R2 Energy = -0.541351
Epoch 41
Train function
Validation rmse Energy = 1.027544
Validation R2 Energy = -0.332973
Epoch 42
Train function
Validation rmse Energy = 1.051043
Validation R2 Energy = -0.394636
Epoch 43
Train function
Validation rmse Energy = 1.113323
Validation R2 Energy = -0.564812
Epoch 44
Train function
Validation rmse Energy = 1.100060
Validation R2 Energy = -0.527750
Epoch 45
Train function
Validation rmse Energy = 1.072396
Validation R2 Energy = -0.451879
Epoch 46
Train function
Validation rmse Energy = 1.115039
Validation R2 Energy = -0.569639
Epoch 47
Train function
Validation rmse Energy = 1.187568
Validation R2 Energy = -0.780478
Epoch 48
Train function
Validation rmse Energy = 1.183524
Validation R2 Energy = -0.768373
Epoch 49
Train function
Validation rmse Energy = 1.120479
Validation R2 Energy = -0.584994
Epoch 50
Train function
Validation rmse Energy = 1.094942
Validation R2 Energy = -0.513568
Epoch 51
Train function
Validation rmse Energy = 1.113540
Validation R2 Energy = -0.565424
Epoch 52
Train function
Validation rmse Energy = 1.099241
Validation R2 Energy = -0.525478
Epoch 53
Train function
Validation rmse Energy = 1.043939
Validation R2 Energy = -0.375847
Epoch 54
Train function
Validation rmse Energy = 1.029564
Validation R2 Energy = -0.338219
Epoch 55
Train function
Validation rmse Energy = 1.073873
Validation R2 Energy = -0.455880
Epoch 56
Train function
Validation rmse Energy = 1.105422
Validation R2 Energy = -0.542682
Epoch 57
Train function
Validation rmse Energy = 1.091140
Validation R2 Energy = -0.503076
Epoch 58
Train function
Validation rmse Energy = 1.090665
Validation R2 Energy = -0.501768
Epoch 59
Train function
Validation rmse Energy = 1.124758
Validation R2 Energy = -0.597121
Epoch 60
Train function
Validation rmse Energy = 1.136923
Validation R2 Energy = -0.631858
Epoch 61
Train function
Validation rmse Energy = 1.101732
Validation R2 Energy = -0.532399
Epoch 62
Train function
Loss = 1.7653e-05, PNorm = 52.9388, GNorm = 0.0787, lr_0 = 1.0000e-04
Validation rmse Energy = 1.079774
Validation R2 Energy = -0.471924
Epoch 63
Train function
Loss = 1.9494e-05, PNorm = 52.9388, GNorm = 0.1972, lr_0 = 1.0000e-04
Validation rmse Energy = 1.096759
Validation R2 Energy = -0.518598
Epoch 64
Train function
Loss = 1.4252e-05, PNorm = 52.9388, GNorm = 0.0836, lr_0 = 1.0000e-04
Validation rmse Energy = 1.105191
Validation R2 Energy = -0.542038
Epoch 65
Train function
Loss = 1.6965e-05, PNorm = 52.9388, GNorm = 0.1882, lr_0 = 1.0000e-04
Validation rmse Energy = 1.085319
Validation R2 Energy = -0.487082
Epoch 66
Train function
Loss = 1.1464e-05, PNorm = 52.9389, GNorm = 0.0837, lr_0 = 1.0000e-04
Validation rmse Energy = 1.086066
Validation R2 Energy = -0.489128
Epoch 67
Train function
Loss = 1.1002e-05, PNorm = 52.9389, GNorm = 0.1572, lr_0 = 1.0000e-04
Validation rmse Energy = 1.118078
Validation R2 Energy = -0.578207
Epoch 68
Train function
Validation rmse Energy = 1.131149
Validation R2 Energy = -0.615325
Epoch 69
Train function
Validation rmse Energy = 1.113673
Validation R2 Energy = -0.565796
Epoch 70
Train function
Validation rmse Energy = 1.108409
Validation R2 Energy = -0.551029
Epoch 71
Train function
Validation rmse Energy = 1.118843
Validation R2 Energy = -0.580368
Epoch 72
Train function
Validation rmse Energy = 1.107701
Validation R2 Energy = -0.549048
Epoch 73
Train function
Validation rmse Energy = 1.081864
Validation R2 Energy = -0.477629
Epoch 74
Train function
Validation rmse Energy = 1.080479
Validation R2 Energy = -0.473849
Epoch 75
Train function
Validation rmse Energy = 1.095447
Validation R2 Energy = -0.514967
Epoch 76
Train function
Validation rmse Energy = 1.094483
Validation R2 Energy = -0.512300
Epoch 77
Train function
Validation rmse Energy = 1.090663
Validation R2 Energy = -0.501762
Epoch 78
Train function
Validation rmse Energy = 1.106795
Validation R2 Energy = -0.546516
Epoch 79
Train function
Validation rmse Energy = 1.120948
Validation R2 Energy = -0.586321
Epoch 80
Train function
Validation rmse Energy = 1.112243
Validation R2 Energy = -0.561779
Epoch 81
Train function
Validation rmse Energy = 1.104117
Validation R2 Energy = -0.539041
Epoch 82
Train function
Validation rmse Energy = 1.109417
Validation R2 Energy = -0.553853
Epoch 83
Train function
Validation rmse Energy = 1.105905
Validation R2 Energy = -0.544030
Epoch 84
Train function
Validation rmse Energy = 1.091908
Validation R2 Energy = -0.505192
Epoch 85
Train function
Validation rmse Energy = 1.092263
Validation R2 Energy = -0.506171
Epoch 86
Train function
Validation rmse Energy = 1.102588
Validation R2 Energy = -0.534781
Epoch 87
Train function
Validation rmse Energy = 1.101233
Validation R2 Energy = -0.531010
Epoch 88
Train function
Validation rmse Energy = 1.097807
Validation R2 Energy = -0.521501
Epoch 89
Train function
Validation rmse Energy = 1.105688
Validation R2 Energy = -0.543425
Epoch 90
Train function
Validation rmse Energy = 1.108581
Validation R2 Energy = -0.551511
Epoch 91
Train function
Validation rmse Energy = 1.099073
Validation R2 Energy = -0.525010
Epoch 92
Train function
Validation rmse Energy = 1.095773
Validation R2 Energy = -0.515868
Epoch 93
Train function
Validation rmse Energy = 1.099794
Validation R2 Energy = -0.527012
Epoch 94
Train function
Validation rmse Energy = 1.095999
Validation R2 Energy = -0.516494
Epoch 95
Train function
Validation rmse Energy = 1.091944
Validation R2 Energy = -0.505293
Epoch 96
Train function
Validation rmse Energy = 1.098782
Validation R2 Energy = -0.524203
Epoch 97
Train function
Validation rmse Energy = 1.103554
Validation R2 Energy = -0.537471
Epoch 98
Train function
Validation rmse Energy = 1.100203
Validation R2 Energy = -0.528149
Epoch 99
Train function
Validation rmse Energy = 1.101501
Validation R2 Energy = -0.531756
Model 0 best validation rmse = 0.477563 on epoch 17
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 2.048360
Model 0 test R2 Energy = 0.617395
Ensemble test rmse  Energy= 2.048360
Ensemble test R2  Energy= 0.617395
4-fold cross validation
	Seed 0 ==> test rmse = 2.242065
	Seed 0 ==> test R2 = 0.541611
	Seed 1 ==> test rmse = 2.362148
	Seed 1 ==> test R2 = 0.491194
	Seed 2 ==> test rmse = 2.475596
	Seed 2 ==> test R2 = 0.441147
	Seed 3 ==> test rmse = 2.048360
	Seed 3 ==> test R2 = 0.617395
Overall val rmse Energy= 1.860993 +/- 1.394107
Overall val R2 Energy = -1.342953 +/- 3.096221
Overall test rmse Energy = 2.282042 +/- 0.158181
Overall test R2 Energy = 0.522837 +/- 0.065131
Elapsed time = 0:00:21
Fold 0
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 3.313648
Validation R2 Energy = 0.439028
Epoch 1
Train function
Loss = 1.0485e-02, PNorm = 52.9608, GNorm = 2.4521, lr_0 = 8.7143e-04
Validation rmse Energy = 3.294740
Validation R2 Energy = 0.445412
Epoch 2
Train function
Loss = 8.4547e-03, PNorm = 53.0846, GNorm = 1.9141, lr_0 = 9.7024e-04
Validation rmse Energy = 2.496247
Validation R2 Energy = 0.681651
Epoch 3
Train function
Validation rmse Energy = 2.044385
Validation R2 Energy = 0.786473
Epoch 4
Train function
Loss = 2.7032e-03, PNorm = 53.2070, GNorm = 3.0637, lr_0 = 9.3194e-04
Validation rmse Energy = 1.705182
Validation R2 Energy = 0.851451
Epoch 5
Train function
Loss = 2.5567e-03, PNorm = 53.2762, GNorm = 2.3765, lr_0 = 9.0118e-04
Validation rmse Energy = 1.650381
Validation R2 Energy = 0.860846
Epoch 6
Train function
Loss = 1.6311e-03, PNorm = 53.3382, GNorm = 0.3369, lr_0 = 8.6851e-04
Loss = 5.8410e-03, PNorm = 53.3418, GNorm = 2.0214, lr_0 = 8.6560e-04
Validation rmse Energy = 1.492334
Validation R2 Energy = 0.886221
Epoch 7
Train function
Validation rmse Energy = 1.405947
Validation R2 Energy = 0.899013
Epoch 8
Train function
Loss = 1.0288e-03, PNorm = 53.3851, GNorm = 1.1374, lr_0 = 8.3422e-04
Validation rmse Energy = 1.322259
Validation R2 Energy = 0.910677
Epoch 9
Train function
Loss = 8.7018e-04, PNorm = 53.4218, GNorm = 0.5723, lr_0 = 8.0398e-04
Validation rmse Energy = 1.325133
Validation R2 Energy = 0.910289
Epoch 10
Train function
Validation rmse Energy = 1.322428
Validation R2 Energy = 0.910654
Epoch 11
Train function
Loss = 7.0054e-04, PNorm = 53.4517, GNorm = 0.7831, lr_0 = 7.7484e-04
Validation rmse Energy = 1.514850
Validation R2 Energy = 0.882762
Epoch 12
Train function
Loss = 7.9527e-04, PNorm = 53.4846, GNorm = 0.7329, lr_0 = 7.4675e-04
Validation rmse Energy = 1.395051
Validation R2 Energy = 0.900572
Epoch 13
Train function
Loss = 7.4102e-04, PNorm = 53.5134, GNorm = 1.0132, lr_0 = 7.1969e-04
Loss = 3.0611e-03, PNorm = 53.5159, GNorm = 1.2103, lr_0 = 7.1727e-04
Validation rmse Energy = 1.350317
Validation R2 Energy = 0.906846
Epoch 14
Train function
Validation rmse Energy = 1.270140
Validation R2 Energy = 0.917580
Epoch 15
Train function
Loss = 4.8416e-04, PNorm = 53.5445, GNorm = 0.7721, lr_0 = 6.9360e-04
Validation rmse Energy = 1.297142
Validation R2 Energy = 0.914039
Epoch 16
Train function
Loss = 3.8536e-04, PNorm = 53.5647, GNorm = 0.2832, lr_0 = 6.6846e-04
Validation rmse Energy = 1.238393
Validation R2 Energy = 0.921649
Epoch 17
Train function
Validation rmse Energy = 1.211859
Validation R2 Energy = 0.924970
Epoch 18
Train function
Loss = 2.7033e-04, PNorm = 53.5955, GNorm = 0.5899, lr_0 = 6.4207e-04
Validation rmse Energy = 1.223842
Validation R2 Energy = 0.923479
Epoch 19
Train function
Loss = 2.8479e-04, PNorm = 53.6185, GNorm = 0.4464, lr_0 = 6.1879e-04
Validation rmse Energy = 1.231803
Validation R2 Energy = 0.922481
Epoch 20
Train function
Loss = 2.4224e-04, PNorm = 53.6390, GNorm = 0.1722, lr_0 = 5.9837e-04
Validation rmse Energy = 1.194123
Validation R2 Energy = 0.927151
Epoch 21
Train function
Validation rmse Energy = 1.191383
Validation R2 Energy = 0.927484
Epoch 22
Train function
Loss = 2.1566e-04, PNorm = 53.6639, GNorm = 0.3489, lr_0 = 5.7475e-04
Validation rmse Energy = 1.163120
Validation R2 Energy = 0.930884
Epoch 23
Train function
Loss = 1.4608e-04, PNorm = 53.6839, GNorm = 0.1657, lr_0 = 5.5391e-04
Validation rmse Energy = 1.168433
Validation R2 Energy = 0.930251
Epoch 24
Train function
Loss = 1.5589e-04, PNorm = 53.6991, GNorm = 0.5874, lr_0 = 5.3383e-04
Validation rmse Energy = 1.169737
Validation R2 Energy = 0.930096
Epoch 25
Train function
Validation rmse Energy = 1.159039
Validation R2 Energy = 0.931368
Epoch 26
Train function
Loss = 1.0040e-04, PNorm = 53.7165, GNorm = 0.2360, lr_0 = 5.1448e-04
Validation rmse Energy = 1.175594
Validation R2 Energy = 0.929394
Epoch 27
Train function
Loss = 1.1704e-04, PNorm = 53.7301, GNorm = 0.6324, lr_0 = 4.9583e-04
Validation rmse Energy = 1.151259
Validation R2 Energy = 0.932287
Epoch 28
Train function
Validation rmse Energy = 1.154523
Validation R2 Energy = 0.931902
Epoch 29
Train function
Loss = 9.9175e-05, PNorm = 53.7457, GNorm = 0.4523, lr_0 = 4.7626e-04
Validation rmse Energy = 1.149662
Validation R2 Energy = 0.932474
Epoch 30
Train function
Loss = 7.3406e-05, PNorm = 53.7572, GNorm = 0.1031, lr_0 = 4.6054e-04
Validation rmse Energy = 1.129816
Validation R2 Energy = 0.934786
Epoch 31
Train function
Loss = 8.1162e-05, PNorm = 53.7663, GNorm = 0.2067, lr_0 = 4.4384e-04
Loss = 2.3998e-04, PNorm = 53.7670, GNorm = 0.2436, lr_0 = 4.4236e-04
Validation rmse Energy = 1.140012
Validation R2 Energy = 0.933603
Epoch 32
Train function
Validation rmse Energy = 1.142289
Validation R2 Energy = 0.933338
Epoch 33
Train function
Loss = 5.0071e-05, PNorm = 53.7747, GNorm = 0.1687, lr_0 = 4.2632e-04
Validation rmse Energy = 1.126596
Validation R2 Energy = 0.935157
Epoch 34
Train function
Loss = 7.6274e-05, PNorm = 53.7841, GNorm = 0.2864, lr_0 = 4.1087e-04
Validation rmse Energy = 1.140534
Validation R2 Energy = 0.933542
Epoch 35
Train function
Validation rmse Energy = 1.117238
Validation R2 Energy = 0.936230
Epoch 36
Train function
Loss = 5.4743e-05, PNorm = 53.7947, GNorm = 0.2473, lr_0 = 3.9597e-04
Validation rmse Energy = 1.134384
Validation R2 Energy = 0.934257
Epoch 37
Train function
Loss = 3.8920e-05, PNorm = 53.8026, GNorm = 0.0446, lr_0 = 3.8162e-04
Validation rmse Energy = 1.131622
Validation R2 Energy = 0.934577
Epoch 38
Train function
Loss = 3.8091e-05, PNorm = 53.8096, GNorm = 0.0840, lr_0 = 3.6779e-04
Loss = 1.5158e-04, PNorm = 53.8100, GNorm = 0.2493, lr_0 = 3.6656e-04
Validation rmse Energy = 1.144159
Validation R2 Energy = 0.933119
Epoch 39
Train function
Validation rmse Energy = 1.135410
Validation R2 Energy = 0.934138
Epoch 40
Train function
Loss = 3.7869e-05, PNorm = 53.8154, GNorm = 0.1179, lr_0 = 3.5446e-04
Validation rmse Energy = 1.128639
Validation R2 Energy = 0.934921
Epoch 41
Train function
Loss = 3.3600e-05, PNorm = 53.8219, GNorm = 0.0596, lr_0 = 3.4161e-04
Validation rmse Energy = 1.129412
Validation R2 Energy = 0.934832
Epoch 42
Train function
Validation rmse Energy = 1.136551
Validation R2 Energy = 0.934006
Epoch 43
Train function
Loss = 1.5405e-05, PNorm = 53.8272, GNorm = 0.0632, lr_0 = 3.2812e-04
Validation rmse Energy = 1.138387
Validation R2 Energy = 0.933792
Epoch 44
Train function
Loss = 3.3648e-05, PNorm = 53.8327, GNorm = 0.0976, lr_0 = 3.1623e-04
Validation rmse Energy = 1.136965
Validation R2 Energy = 0.933958
Epoch 45
Train function
Loss = 2.9960e-05, PNorm = 53.8374, GNorm = 0.0773, lr_0 = 3.0579e-04
Validation rmse Energy = 1.142422
Validation R2 Energy = 0.933322
Epoch 46
Train function
Validation rmse Energy = 1.135762
Validation R2 Energy = 0.934097
Epoch 47
Train function
Loss = 3.2142e-05, PNorm = 53.8424, GNorm = 0.1119, lr_0 = 2.9372e-04
Validation rmse Energy = 1.138554
Validation R2 Energy = 0.933773
Epoch 48
Train function
Loss = 2.4516e-05, PNorm = 53.8467, GNorm = 0.0891, lr_0 = 2.8307e-04
Validation rmse Energy = 1.129457
Validation R2 Energy = 0.934827
Epoch 49
Train function
Loss = 2.4312e-05, PNorm = 53.8507, GNorm = 0.0770, lr_0 = 2.7281e-04
Validation rmse Energy = 1.125233
Validation R2 Energy = 0.935314
Epoch 50
Train function
Validation rmse Energy = 1.132843
Validation R2 Energy = 0.934436
Epoch 51
Train function
Loss = 1.7122e-05, PNorm = 53.8541, GNorm = 0.2344, lr_0 = 2.6292e-04
Validation rmse Energy = 1.148426
Validation R2 Energy = 0.932620
Epoch 52
Train function
Loss = 2.4998e-05, PNorm = 53.8572, GNorm = 0.0539, lr_0 = 2.5339e-04
Validation rmse Energy = 1.137503
Validation R2 Energy = 0.933895
Epoch 53
Train function
Validation rmse Energy = 1.132806
Validation R2 Energy = 0.934440
Epoch 54
Train function
Loss = 2.0881e-05, PNorm = 53.8610, GNorm = 0.0352, lr_0 = 2.4339e-04
Validation rmse Energy = 1.126599
Validation R2 Energy = 0.935156
Epoch 55
Train function
Loss = 1.4810e-05, PNorm = 53.8639, GNorm = 0.0573, lr_0 = 2.3535e-04
Validation rmse Energy = 1.128037
Validation R2 Energy = 0.934991
Epoch 56
Train function
Loss = 1.8999e-05, PNorm = 53.8668, GNorm = 0.0720, lr_0 = 2.2682e-04
Loss = 6.9916e-05, PNorm = 53.8671, GNorm = 0.1767, lr_0 = 2.2606e-04
Validation rmse Energy = 1.126690
Validation R2 Energy = 0.935146
Epoch 57
Train function
Validation rmse Energy = 1.131792
Validation R2 Energy = 0.934557
Epoch 58
Train function
Loss = 2.4477e-05, PNorm = 53.8696, GNorm = 0.1620, lr_0 = 2.1787e-04
Validation rmse Energy = 1.130072
Validation R2 Energy = 0.934756
Epoch 59
Train function
Loss = 1.6980e-05, PNorm = 53.8718, GNorm = 0.0542, lr_0 = 2.0997e-04
Validation rmse Energy = 1.125854
Validation R2 Energy = 0.935242
Epoch 60
Train function
Validation rmse Energy = 1.131846
Validation R2 Energy = 0.934551
Epoch 61
Train function
Loss = 1.5729e-05, PNorm = 53.8746, GNorm = 0.0535, lr_0 = 2.0236e-04
Validation rmse Energy = 1.127252
Validation R2 Energy = 0.935081
Epoch 62
Train function
Loss = 1.7946e-05, PNorm = 53.8771, GNorm = 0.1303, lr_0 = 1.9502e-04
Validation rmse Energy = 1.135024
Validation R2 Energy = 0.934183
Epoch 63
Train function
Loss = 1.6450e-05, PNorm = 53.8795, GNorm = 0.0453, lr_0 = 1.8795e-04
Loss = 2.0211e-05, PNorm = 53.8797, GNorm = 0.0500, lr_0 = 1.8732e-04
Validation rmse Energy = 1.132512
Validation R2 Energy = 0.934474
Epoch 64
Train function
Validation rmse Energy = 1.130185
Validation R2 Energy = 0.934743
Epoch 65
Train function
Loss = 1.8712e-05, PNorm = 53.8813, GNorm = 0.0297, lr_0 = 1.8114e-04
Validation rmse Energy = 1.128020
Validation R2 Energy = 0.934993
Epoch 66
Train function
Loss = 9.8954e-06, PNorm = 53.8832, GNorm = 0.0896, lr_0 = 1.7458e-04
Validation rmse Energy = 1.126890
Validation R2 Energy = 0.935123
Epoch 67
Train function
Validation rmse Energy = 1.138128
Validation R2 Energy = 0.933823
Epoch 68
Train function
Loss = 1.5954e-05, PNorm = 53.8853, GNorm = 0.0957, lr_0 = 1.6768e-04
Validation rmse Energy = 1.130781
Validation R2 Energy = 0.934674
Epoch 69
Train function
Loss = 1.6091e-05, PNorm = 53.8869, GNorm = 0.0493, lr_0 = 1.6161e-04
Validation rmse Energy = 1.128696
Validation R2 Energy = 0.934915
Epoch 70
Train function
Loss = 1.3939e-05, PNorm = 53.8884, GNorm = 0.0404, lr_0 = 1.5627e-04
Validation rmse Energy = 1.135752
Validation R2 Energy = 0.934098
Epoch 71
Train function
Validation rmse Energy = 1.132728
Validation R2 Energy = 0.934449
Epoch 72
Train function
Loss = 1.3534e-05, PNorm = 53.8896, GNorm = 0.1013, lr_0 = 1.5010e-04
Validation rmse Energy = 1.132335
Validation R2 Energy = 0.934494
Epoch 73
Train function
Loss = 1.3199e-05, PNorm = 53.8919, GNorm = 0.0700, lr_0 = 1.4466e-04
Validation rmse Energy = 1.127491
Validation R2 Energy = 0.935054
Epoch 74
Train function
Loss = 1.3905e-05, PNorm = 53.8935, GNorm = 0.0746, lr_0 = 1.3942e-04
Validation rmse Energy = 1.132024
Validation R2 Energy = 0.934530
Epoch 75
Train function
Validation rmse Energy = 1.129780
Validation R2 Energy = 0.934790
Epoch 76
Train function
Loss = 1.2488e-05, PNorm = 53.8946, GNorm = 0.0472, lr_0 = 1.3436e-04
Validation rmse Energy = 1.131293
Validation R2 Energy = 0.934615
Epoch 77
Train function
Loss = 1.3746e-05, PNorm = 53.8960, GNorm = 0.0553, lr_0 = 1.2949e-04
Validation rmse Energy = 1.128461
Validation R2 Energy = 0.934942
Epoch 78
Train function
Validation rmse Energy = 1.132628
Validation R2 Energy = 0.934461
Epoch 79
Train function
Loss = 1.3095e-05, PNorm = 53.8971, GNorm = 0.0678, lr_0 = 1.2438e-04
Validation rmse Energy = 1.130713
Validation R2 Energy = 0.934682
Epoch 80
Train function
Loss = 1.0982e-05, PNorm = 53.8982, GNorm = 0.0315, lr_0 = 1.2027e-04
Validation rmse Energy = 1.131179
Validation R2 Energy = 0.934628
Epoch 81
Train function
Loss = 1.2461e-05, PNorm = 53.8992, GNorm = 0.1928, lr_0 = 1.1592e-04
Loss = 1.3212e-05, PNorm = 53.8993, GNorm = 0.0319, lr_0 = 1.1553e-04
Validation rmse Energy = 1.131390
Validation R2 Energy = 0.934604
Epoch 82
Train function
Validation rmse Energy = 1.131236
Validation R2 Energy = 0.934622
Epoch 83
Train function
Loss = 1.5572e-05, PNorm = 53.9006, GNorm = 0.0427, lr_0 = 1.1134e-04
Validation rmse Energy = 1.126645
Validation R2 Energy = 0.935151
Epoch 84
Train function
Loss = 1.0960e-05, PNorm = 53.9017, GNorm = 0.0645, lr_0 = 1.0730e-04
Validation rmse Energy = 1.130516
Validation R2 Energy = 0.934705
Epoch 85
Train function
Validation rmse Energy = 1.129628
Validation R2 Energy = 0.934807
Epoch 86
Train function
Loss = 7.0709e-06, PNorm = 53.9027, GNorm = 0.0266, lr_0 = 1.0341e-04
Validation rmse Energy = 1.122797
Validation R2 Energy = 0.935593
Epoch 87
Train function
Loss = 1.4555e-05, PNorm = 53.9037, GNorm = 0.1277, lr_0 = 1.0000e-04
Validation rmse Energy = 1.145447
Validation R2 Energy = 0.932969
Epoch 88
Train function
Loss = 1.5057e-05, PNorm = 53.9047, GNorm = 0.1468, lr_0 = 1.0000e-04
Loss = 2.4612e-05, PNorm = 53.9047, GNorm = 0.1463, lr_0 = 1.0000e-04
Validation rmse Energy = 1.126220
Validation R2 Energy = 0.935200
Epoch 89
Train function
Validation rmse Energy = 1.124909
Validation R2 Energy = 0.935351
Epoch 90
Train function
Loss = 5.5622e-06, PNorm = 53.9056, GNorm = 0.0621, lr_0 = 1.0000e-04
Validation rmse Energy = 1.130786
Validation R2 Energy = 0.934674
Epoch 91
Train function
Loss = 1.0205e-05, PNorm = 53.9066, GNorm = 0.0300, lr_0 = 1.0000e-04
Validation rmse Energy = 1.130707
Validation R2 Energy = 0.934683
Epoch 92
Train function
Validation rmse Energy = 1.130490
Validation R2 Energy = 0.934708
Epoch 93
Train function
Loss = 1.2754e-05, PNorm = 53.9075, GNorm = 0.0437, lr_0 = 1.0000e-04
Validation rmse Energy = 1.125998
Validation R2 Energy = 0.935226
Epoch 94
Train function
Loss = 6.9822e-06, PNorm = 53.9084, GNorm = 0.0694, lr_0 = 1.0000e-04
Validation rmse Energy = 1.127493
Validation R2 Energy = 0.935053
Epoch 95
Train function
Loss = 9.8885e-06, PNorm = 53.9093, GNorm = 0.0302, lr_0 = 1.0000e-04
Validation rmse Energy = 1.127641
Validation R2 Energy = 0.935036
Epoch 96
Train function
Validation rmse Energy = 1.131510
Validation R2 Energy = 0.934590
Epoch 97
Train function
Loss = 1.0697e-05, PNorm = 53.9102, GNorm = 0.0727, lr_0 = 1.0000e-04
Validation rmse Energy = 1.130172
Validation R2 Energy = 0.934744
Epoch 98
Train function
Loss = 1.2195e-05, PNorm = 53.9111, GNorm = 0.0199, lr_0 = 1.0000e-04
Validation rmse Energy = 1.127857
Validation R2 Energy = 0.935012
Epoch 99
Train function
Loss = 1.5672e-05, PNorm = 53.9120, GNorm = 0.2946, lr_0 = 1.0000e-04
Validation rmse Energy = 1.132974
Validation R2 Energy = 0.934420
Model 0 best validation rmse = 1.117238 on epoch 35
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.118383
Model 0 test R2 Energy = 0.925172
Ensemble test rmse  Energy= 1.118383
Ensemble test R2  Energy= 0.925172
Fold 1
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 199,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 360,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 2.325074
Validation R2 Energy = 0.563760
Epoch 1
Train function
Loss = 9.9156e-03, PNorm = 52.9584, GNorm = 4.2657, lr_0 = 8.7143e-04
Validation rmse Energy = 2.364207
Validation R2 Energy = 0.548953
Epoch 2
Train function
Loss = 6.1313e-03, PNorm = 53.0950, GNorm = 3.2646, lr_0 = 9.7024e-04
Validation rmse Energy = 2.096736
Validation R2 Energy = 0.645236
Epoch 3
Train function
Validation rmse Energy = 1.418095
Validation R2 Energy = 0.837721
Epoch 4
Train function
Loss = 3.0222e-03, PNorm = 53.2168, GNorm = 2.2792, lr_0 = 9.3194e-04
Validation rmse Energy = 1.394097
Validation R2 Energy = 0.843167
Epoch 5
Train function
Loss = 1.7347e-03, PNorm = 53.2802, GNorm = 2.3755, lr_0 = 9.0118e-04
Validation rmse Energy = 1.434444
Validation R2 Energy = 0.833958
Epoch 6
Train function
Loss = 1.6792e-03, PNorm = 53.3220, GNorm = 1.5114, lr_0 = 8.6851e-04
Loss = 1.1807e-02, PNorm = 53.3262, GNorm = 2.1385, lr_0 = 8.6560e-04
Validation rmse Energy = 1.052526
Validation R2 Energy = 0.910604
Epoch 7
Train function
Validation rmse Energy = 1.089465
Validation R2 Energy = 0.904219
Epoch 8
Train function
Loss = 7.2023e-04, PNorm = 53.3649, GNorm = 0.4866, lr_0 = 8.3422e-04
Validation rmse Energy = 1.096253
Validation R2 Energy = 0.903022
Epoch 9
Train function
Loss = 7.4664e-04, PNorm = 53.3911, GNorm = 0.5600, lr_0 = 8.0398e-04
Validation rmse Energy = 1.003795
Validation R2 Energy = 0.918690
Epoch 10
Train function
Validation rmse Energy = 0.992956
Validation R2 Energy = 0.920437
Epoch 11
Train function
Loss = 6.5308e-04, PNorm = 53.4209, GNorm = 0.4012, lr_0 = 7.7484e-04
Validation rmse Energy = 0.935015
Validation R2 Energy = 0.929451
Epoch 12
Train function
Loss = 5.3777e-04, PNorm = 53.4444, GNorm = 0.8960, lr_0 = 7.4675e-04
Validation rmse Energy = 0.928715
Validation R2 Energy = 0.930399
Epoch 13
Train function
Loss = 4.4840e-04, PNorm = 53.4685, GNorm = 0.4497, lr_0 = 7.1969e-04
Loss = 4.0929e-03, PNorm = 53.4704, GNorm = 1.6728, lr_0 = 7.1727e-04
Validation rmse Energy = 0.915706
Validation R2 Energy = 0.932335
Epoch 14
Train function
Validation rmse Energy = 0.878854
Validation R2 Energy = 0.937672
Epoch 15
Train function
Loss = 3.8445e-04, PNorm = 53.4903, GNorm = 0.3014, lr_0 = 6.9360e-04
Validation rmse Energy = 0.921199
Validation R2 Energy = 0.931521
Epoch 16
Train function
Loss = 3.6619e-04, PNorm = 53.5154, GNorm = 0.7357, lr_0 = 6.6846e-04
Validation rmse Energy = 0.858958
Validation R2 Energy = 0.940462
Epoch 17
Train function
Validation rmse Energy = 0.808492
Validation R2 Energy = 0.947252
Epoch 18
Train function
Loss = 2.2292e-04, PNorm = 53.5407, GNorm = 0.2112, lr_0 = 6.4207e-04
Validation rmse Energy = 0.826952
Validation R2 Energy = 0.944816
Epoch 19
Train function
Loss = 2.2526e-04, PNorm = 53.5619, GNorm = 0.1208, lr_0 = 6.1879e-04
Validation rmse Energy = 0.823056
Validation R2 Energy = 0.945335
Epoch 20
Train function
Loss = 1.9801e-04, PNorm = 53.5792, GNorm = 0.2746, lr_0 = 5.9837e-04
Validation rmse Energy = 0.804166
Validation R2 Energy = 0.947815
Epoch 21
Train function
Validation rmse Energy = 0.842411
Validation R2 Energy = 0.942734
Epoch 22
Train function
Loss = 1.7505e-04, PNorm = 53.6000, GNorm = 0.5888, lr_0 = 5.7475e-04
Validation rmse Energy = 0.818288
Validation R2 Energy = 0.945966
Epoch 23
Train function
Loss = 1.6682e-04, PNorm = 53.6145, GNorm = 0.2524, lr_0 = 5.5391e-04
Validation rmse Energy = 0.788478
Validation R2 Energy = 0.949832
Epoch 24
Train function
Loss = 2.0208e-04, PNorm = 53.6281, GNorm = 0.2703, lr_0 = 5.3383e-04
Validation rmse Energy = 0.779408
Validation R2 Energy = 0.950979
Epoch 25
Train function
Validation rmse Energy = 0.755591
Validation R2 Energy = 0.953929
Epoch 26
Train function
Loss = 1.7796e-04, PNorm = 53.6488, GNorm = 0.1773, lr_0 = 5.1448e-04
Validation rmse Energy = 0.797413
Validation R2 Energy = 0.948688
Epoch 27
Train function
Loss = 1.2211e-04, PNorm = 53.6603, GNorm = 0.2129, lr_0 = 4.9583e-04
Validation rmse Energy = 0.754664
Validation R2 Energy = 0.954042
Epoch 28
Train function
Validation rmse Energy = 0.770993
Validation R2 Energy = 0.952032
Epoch 29
Train function
Loss = 8.2880e-05, PNorm = 53.6754, GNorm = 0.2360, lr_0 = 4.7626e-04
Validation rmse Energy = 0.744608
Validation R2 Energy = 0.955259
Epoch 30
Train function
Loss = 8.5609e-05, PNorm = 53.6847, GNorm = 0.1450, lr_0 = 4.6054e-04
Validation rmse Energy = 0.765832
Validation R2 Energy = 0.952672
Epoch 31
Train function
Loss = 7.7233e-05, PNorm = 53.6942, GNorm = 0.2342, lr_0 = 4.4384e-04
Loss = 1.5801e-04, PNorm = 53.6952, GNorm = 0.1514, lr_0 = 4.4236e-04
Validation rmse Energy = 0.734162
Validation R2 Energy = 0.956505
Epoch 32
Train function
Validation rmse Energy = 0.730472
Validation R2 Energy = 0.956942
Epoch 33
Train function
Loss = 5.4643e-05, PNorm = 53.7044, GNorm = 0.1232, lr_0 = 4.2632e-04
Validation rmse Energy = 0.728616
Validation R2 Energy = 0.957160
Epoch 34
Train function
Loss = 7.6359e-05, PNorm = 53.7143, GNorm = 0.1216, lr_0 = 4.1087e-04
Validation rmse Energy = 0.751059
Validation R2 Energy = 0.954480
Epoch 35
Train function
Validation rmse Energy = 0.790320
Validation R2 Energy = 0.949597
Epoch 36
Train function
Loss = 1.8158e-04, PNorm = 53.7221, GNorm = 0.9982, lr_0 = 3.9597e-04
Validation rmse Energy = 0.758167
Validation R2 Energy = 0.953615
Epoch 37
Train function
Loss = 7.1178e-05, PNorm = 53.7318, GNorm = 0.2830, lr_0 = 3.8162e-04
Validation rmse Energy = 0.743603
Validation R2 Energy = 0.955380
Epoch 38
Train function
Loss = 7.5010e-05, PNorm = 53.7418, GNorm = 0.1149, lr_0 = 3.6779e-04
Loss = 6.6440e-04, PNorm = 53.7424, GNorm = 0.3858, lr_0 = 3.6656e-04
Validation rmse Energy = 0.726285
Validation R2 Energy = 0.957434
Epoch 39
Train function
Validation rmse Energy = 0.731752
Validation R2 Energy = 0.956790
Epoch 40
Train function
Loss = 6.4012e-05, PNorm = 53.7492, GNorm = 0.2507, lr_0 = 3.5446e-04
Validation rmse Energy = 0.714504
Validation R2 Energy = 0.958803
Epoch 41
Train function
Loss = 5.5828e-05, PNorm = 53.7566, GNorm = 0.3073, lr_0 = 3.4161e-04
Validation rmse Energy = 0.740231
Validation R2 Energy = 0.955783
Epoch 42
Train function
Validation rmse Energy = 0.714444
Validation R2 Energy = 0.958810
Epoch 43
Train function
Loss = 3.4891e-05, PNorm = 53.7639, GNorm = 0.1440, lr_0 = 3.2812e-04
Validation rmse Energy = 0.708084
Validation R2 Energy = 0.959541
Epoch 44
Train function
Loss = 4.3179e-05, PNorm = 53.7693, GNorm = 0.2721, lr_0 = 3.1623e-04
Validation rmse Energy = 0.712882
Validation R2 Energy = 0.958990
Epoch 45
Train function
Loss = 5.0551e-05, PNorm = 53.7741, GNorm = 0.4011, lr_0 = 3.0579e-04
Validation rmse Energy = 0.707861
Validation R2 Energy = 0.959566
Epoch 46
Train function
Validation rmse Energy = 0.713948
Validation R2 Energy = 0.958868
Epoch 47
Train function
Loss = 4.2925e-05, PNorm = 53.7793, GNorm = 0.0863, lr_0 = 2.9372e-04
Validation rmse Energy = 0.705041
Validation R2 Energy = 0.959887
Epoch 48
Train function
Loss = 3.4454e-05, PNorm = 53.7832, GNorm = 0.3139, lr_0 = 2.8307e-04
Validation rmse Energy = 0.704747
Validation R2 Energy = 0.959921
Epoch 49
Train function
Loss = 4.6123e-05, PNorm = 53.7878, GNorm = 0.6594, lr_0 = 2.7281e-04
Validation rmse Energy = 0.704119
Validation R2 Energy = 0.959992
Epoch 50
Train function
Validation rmse Energy = 0.693379
Validation R2 Energy = 0.961203
Epoch 51
Train function
Loss = 3.4041e-05, PNorm = 53.7915, GNorm = 0.3640, lr_0 = 2.6292e-04
Validation rmse Energy = 0.711715
Validation R2 Energy = 0.959124
Epoch 52
Train function
Loss = 3.2081e-05, PNorm = 53.7965, GNorm = 0.2500, lr_0 = 2.5339e-04
Validation rmse Energy = 0.706886
Validation R2 Energy = 0.959677
Epoch 53
Train function
Validation rmse Energy = 0.702487
Validation R2 Energy = 0.960178
Epoch 54
Train function
Loss = 5.0397e-05, PNorm = 53.7999, GNorm = 0.3481, lr_0 = 2.4339e-04
Validation rmse Energy = 0.694965
Validation R2 Energy = 0.961026
Epoch 55
Train function
Loss = 2.6372e-05, PNorm = 53.8030, GNorm = 0.0927, lr_0 = 2.3535e-04
Validation rmse Energy = 0.697232
Validation R2 Energy = 0.960771
Epoch 56
Train function
Loss = 2.5393e-05, PNorm = 53.8064, GNorm = 0.2636, lr_0 = 2.2682e-04
Loss = 5.4223e-05, PNorm = 53.8067, GNorm = 0.1069, lr_0 = 2.2606e-04
Validation rmse Energy = 0.696141
Validation R2 Energy = 0.960894
Epoch 57
Train function
Validation rmse Energy = 0.694077
Validation R2 Energy = 0.961125
Epoch 58
Train function
Loss = 2.3771e-05, PNorm = 53.8094, GNorm = 0.0495, lr_0 = 2.1787e-04
Validation rmse Energy = 0.694412
Validation R2 Energy = 0.961088
Epoch 59
Train function
Loss = 2.0907e-05, PNorm = 53.8124, GNorm = 0.0684, lr_0 = 2.0997e-04
Validation rmse Energy = 0.699875
Validation R2 Energy = 0.960473
Epoch 60
Train function
Validation rmse Energy = 0.696754
Validation R2 Energy = 0.960825
Epoch 61
Train function
Loss = 1.6703e-05, PNorm = 53.8151, GNorm = 0.1555, lr_0 = 2.0236e-04
Validation rmse Energy = 0.696585
Validation R2 Energy = 0.960844
Epoch 62
Train function
Loss = 1.5653e-05, PNorm = 53.8177, GNorm = 0.0469, lr_0 = 1.9502e-04
Validation rmse Energy = 0.697907
Validation R2 Energy = 0.960695
Epoch 63
Train function
Loss = 2.2798e-05, PNorm = 53.8205, GNorm = 0.2806, lr_0 = 1.8795e-04
Loss = 6.4332e-05, PNorm = 53.8207, GNorm = 0.1189, lr_0 = 1.8732e-04
Validation rmse Energy = 0.694609
Validation R2 Energy = 0.961066
Epoch 64
Train function
Validation rmse Energy = 0.704996
Validation R2 Energy = 0.959893
Epoch 65
Train function
Loss = 3.0084e-05, PNorm = 53.8226, GNorm = 0.0632, lr_0 = 1.8114e-04
Validation rmse Energy = 0.694398
Validation R2 Energy = 0.961089
Epoch 66
Train function
Loss = 2.0339e-05, PNorm = 53.8243, GNorm = 0.2049, lr_0 = 1.7458e-04
Validation rmse Energy = 0.704754
Validation R2 Energy = 0.959920
Epoch 67
Train function
Validation rmse Energy = 0.696336
Validation R2 Energy = 0.960872
Epoch 68
Train function
Loss = 1.8077e-05, PNorm = 53.8269, GNorm = 0.0598, lr_0 = 1.6768e-04
Validation rmse Energy = 0.693396
Validation R2 Energy = 0.961202
Epoch 69
Train function
Loss = 2.0485e-05, PNorm = 53.8291, GNorm = 0.0923, lr_0 = 1.6161e-04
Validation rmse Energy = 0.693164
Validation R2 Energy = 0.961228
Epoch 70
Train function
Loss = 2.1040e-05, PNorm = 53.8310, GNorm = 0.2046, lr_0 = 1.5627e-04
Validation rmse Energy = 0.692344
Validation R2 Energy = 0.961319
Epoch 71
Train function
Validation rmse Energy = 0.692216
Validation R2 Energy = 0.961333
Epoch 72
Train function
Loss = 1.5408e-05, PNorm = 53.8326, GNorm = 0.0518, lr_0 = 1.5010e-04
Validation rmse Energy = 0.691465
Validation R2 Energy = 0.961417
Epoch 73
Train function
Loss = 1.8641e-05, PNorm = 53.8348, GNorm = 0.1507, lr_0 = 1.4466e-04
Validation rmse Energy = 0.697056
Validation R2 Energy = 0.960791
Epoch 74
Train function
Loss = 1.5722e-05, PNorm = 53.8364, GNorm = 0.0515, lr_0 = 1.3942e-04
Validation rmse Energy = 0.691246
Validation R2 Energy = 0.961442
Epoch 75
Train function
Validation rmse Energy = 0.688495
Validation R2 Energy = 0.961748
Epoch 76
Train function
Loss = 1.1179e-05, PNorm = 53.8376, GNorm = 0.0392, lr_0 = 1.3436e-04
Validation rmse Energy = 0.693153
Validation R2 Energy = 0.961229
Epoch 77
Train function
Loss = 1.4675e-05, PNorm = 53.8391, GNorm = 0.0642, lr_0 = 1.2949e-04
Validation rmse Energy = 0.691837
Validation R2 Energy = 0.961376
Epoch 78
Train function
Validation rmse Energy = 0.686514
Validation R2 Energy = 0.961968
Epoch 79
Train function
Loss = 1.1500e-05, PNorm = 53.8406, GNorm = 0.1002, lr_0 = 1.2438e-04
Validation rmse Energy = 0.691624
Validation R2 Energy = 0.961400
Epoch 80
Train function
Loss = 1.2076e-05, PNorm = 53.8420, GNorm = 0.0422, lr_0 = 1.2027e-04
Validation rmse Energy = 0.694861
Validation R2 Energy = 0.961038
Epoch 81
Train function
Loss = 1.2878e-05, PNorm = 53.8432, GNorm = 0.0673, lr_0 = 1.1592e-04
Loss = 2.0191e-04, PNorm = 53.8433, GNorm = 0.3182, lr_0 = 1.1553e-04
Validation rmse Energy = 0.699389
Validation R2 Energy = 0.960528
Epoch 82
Train function
Validation rmse Energy = 0.685833
Validation R2 Energy = 0.962043
Epoch 83
Train function
Loss = 1.2226e-05, PNorm = 53.8448, GNorm = 0.0444, lr_0 = 1.1134e-04
Validation rmse Energy = 0.684480
Validation R2 Energy = 0.962193
Epoch 84
Train function
Loss = 1.1524e-05, PNorm = 53.8459, GNorm = 0.1172, lr_0 = 1.0730e-04
Validation rmse Energy = 0.694993
Validation R2 Energy = 0.961023
Epoch 85
Train function
Validation rmse Energy = 0.688191
Validation R2 Energy = 0.961782
Epoch 86
Train function
Loss = 8.5960e-06, PNorm = 53.8471, GNorm = 0.0943, lr_0 = 1.0341e-04
Validation rmse Energy = 0.690054
Validation R2 Energy = 0.961575
Epoch 87
Train function
Loss = 1.4768e-05, PNorm = 53.8482, GNorm = 0.0462, lr_0 = 1.0000e-04
Validation rmse Energy = 0.693897
Validation R2 Energy = 0.961145
Epoch 88
Train function
Loss = 1.3409e-05, PNorm = 53.8494, GNorm = 0.0977, lr_0 = 1.0000e-04
Loss = 1.9416e-04, PNorm = 53.8495, GNorm = 0.2948, lr_0 = 1.0000e-04
Validation rmse Energy = 0.690959
Validation R2 Energy = 0.961474
Epoch 89
Train function
Validation rmse Energy = 0.688088
Validation R2 Energy = 0.961793
Epoch 90
Train function
Loss = 1.3232e-05, PNorm = 53.8506, GNorm = 0.0439, lr_0 = 1.0000e-04
Validation rmse Energy = 0.686083
Validation R2 Energy = 0.962016
Epoch 91
Train function
Loss = 1.0204e-05, PNorm = 53.8519, GNorm = 0.0553, lr_0 = 1.0000e-04
Validation rmse Energy = 0.693143
Validation R2 Energy = 0.961230
Epoch 92
Train function
Validation rmse Energy = 0.695970
Validation R2 Energy = 0.960913
Epoch 93
Train function
Loss = 1.6116e-05, PNorm = 53.8534, GNorm = 0.1297, lr_0 = 1.0000e-04
Validation rmse Energy = 0.686838
Validation R2 Energy = 0.961932
Epoch 94
Train function
Loss = 1.2175e-05, PNorm = 53.8542, GNorm = 0.0446, lr_0 = 1.0000e-04
Validation rmse Energy = 0.690315
Validation R2 Energy = 0.961546
Epoch 95
Train function
Loss = 1.0373e-05, PNorm = 53.8552, GNorm = 0.0608, lr_0 = 1.0000e-04
Validation rmse Energy = 0.686766
Validation R2 Energy = 0.961940
Epoch 96
Train function
Validation rmse Energy = 0.687780
Validation R2 Energy = 0.961828
Epoch 97
Train function
Loss = 1.3725e-05, PNorm = 53.8562, GNorm = 0.0316, lr_0 = 1.0000e-04
Validation rmse Energy = 0.690083
Validation R2 Energy = 0.961571
Epoch 98
Train function
Loss = 1.2183e-05, PNorm = 53.8573, GNorm = 0.0294, lr_0 = 1.0000e-04
Validation rmse Energy = 0.689668
Validation R2 Energy = 0.961618
Epoch 99
Train function
Loss = 1.2846e-05, PNorm = 53.8587, GNorm = 0.0963, lr_0 = 1.0000e-04
Validation rmse Energy = 0.685849
Validation R2 Energy = 0.962042
Model 0 best validation rmse = 0.684480 on epoch 83
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 0.989051
Model 0 test R2 Energy = 0.941478
Ensemble test rmse  Energy= 0.989051
Ensemble test R2  Energy= 0.941478
Fold 2
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 199,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 360,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 2.274410
Validation R2 Energy = 0.519533
Epoch 1
Train function
Loss = 8.1720e-03, PNorm = 52.9583, GNorm = 2.7356, lr_0 = 8.7143e-04
Validation rmse Energy = 1.860029
Validation R2 Energy = 0.678660
Epoch 2
Train function
Loss = 5.0282e-03, PNorm = 53.0851, GNorm = 4.7902, lr_0 = 9.7024e-04
Validation rmse Energy = 1.690181
Validation R2 Energy = 0.734666
Epoch 3
Train function
Validation rmse Energy = 1.445455
Validation R2 Energy = 0.805940
Epoch 4
Train function
Loss = 1.6765e-03, PNorm = 53.1885, GNorm = 1.2970, lr_0 = 9.3194e-04
Validation rmse Energy = 1.342619
Validation R2 Energy = 0.832571
Epoch 5
Train function
Loss = 1.4294e-03, PNorm = 53.2405, GNorm = 1.0718, lr_0 = 9.0118e-04
Validation rmse Energy = 1.340659
Validation R2 Energy = 0.833059
Epoch 6
Train function
Loss = 1.1567e-03, PNorm = 53.2873, GNorm = 0.8496, lr_0 = 8.6851e-04
Loss = 5.6172e-03, PNorm = 53.2910, GNorm = 1.0512, lr_0 = 8.6560e-04
Validation rmse Energy = 1.419619
Validation R2 Energy = 0.812816
Epoch 7
Train function
Validation rmse Energy = 1.194938
Validation R2 Energy = 0.867378
Epoch 8
Train function
Loss = 9.2068e-04, PNorm = 53.3251, GNorm = 0.8063, lr_0 = 8.3422e-04
Validation rmse Energy = 1.253808
Validation R2 Energy = 0.853988
Epoch 9
Train function
Loss = 9.8043e-04, PNorm = 53.3522, GNorm = 1.5005, lr_0 = 8.0398e-04
Validation rmse Energy = 0.992494
Validation R2 Energy = 0.908508
Epoch 10
Train function
Validation rmse Energy = 0.931499
Validation R2 Energy = 0.919408
Epoch 11
Train function
Loss = 4.8747e-04, PNorm = 53.3891, GNorm = 0.9910, lr_0 = 7.7484e-04
Validation rmse Energy = 0.996468
Validation R2 Energy = 0.907774
Epoch 12
Train function
Loss = 7.6419e-04, PNorm = 53.4163, GNorm = 1.0997, lr_0 = 7.4675e-04
Validation rmse Energy = 0.934782
Validation R2 Energy = 0.918839
Epoch 13
Train function
Loss = 4.9703e-04, PNorm = 53.4378, GNorm = 1.0295, lr_0 = 7.1969e-04
Loss = 3.4862e-03, PNorm = 53.4400, GNorm = 0.6120, lr_0 = 7.1727e-04
Validation rmse Energy = 0.971233
Validation R2 Energy = 0.912386
Epoch 14
Train function
Validation rmse Energy = 0.919655
Validation R2 Energy = 0.921445
Epoch 15
Train function
Loss = 3.8522e-04, PNorm = 53.4619, GNorm = 0.6482, lr_0 = 6.9360e-04
Validation rmse Energy = 1.052678
Validation R2 Energy = 0.897076
Epoch 16
Train function
Loss = 4.5484e-04, PNorm = 53.4794, GNorm = 1.5543, lr_0 = 6.6846e-04
Validation rmse Energy = 1.045558
Validation R2 Energy = 0.898464
Epoch 17
Train function
Validation rmse Energy = 1.010311
Validation R2 Energy = 0.905194
Epoch 18
Train function
Loss = 2.5019e-04, PNorm = 53.5015, GNorm = 0.7652, lr_0 = 6.4207e-04
Validation rmse Energy = 0.920162
Validation R2 Energy = 0.921358
Epoch 19
Train function
Loss = 2.8189e-04, PNorm = 53.5184, GNorm = 0.4813, lr_0 = 6.1879e-04
Validation rmse Energy = 0.928109
Validation R2 Energy = 0.919994
Epoch 20
Train function
Loss = 2.1873e-04, PNorm = 53.5324, GNorm = 0.1572, lr_0 = 5.9837e-04
Validation rmse Energy = 0.946816
Validation R2 Energy = 0.916736
Epoch 21
Train function
Validation rmse Energy = 0.950011
Validation R2 Energy = 0.916173
Epoch 22
Train function
Loss = 2.3215e-04, PNorm = 53.5494, GNorm = 0.5525, lr_0 = 5.7475e-04
Validation rmse Energy = 0.866028
Validation R2 Energy = 0.930339
Epoch 23
Train function
Loss = 1.3253e-04, PNorm = 53.5648, GNorm = 0.3820, lr_0 = 5.5391e-04
Validation rmse Energy = 0.837460
Validation R2 Energy = 0.934859
Epoch 24
Train function
Loss = 1.6264e-04, PNorm = 53.5741, GNorm = 0.4475, lr_0 = 5.3383e-04
Validation rmse Energy = 0.876488
Validation R2 Energy = 0.928646
Epoch 25
Train function
Validation rmse Energy = 0.853622
Validation R2 Energy = 0.932320
Epoch 26
Train function
Loss = 1.5373e-04, PNorm = 53.5894, GNorm = 0.4196, lr_0 = 5.1448e-04
Validation rmse Energy = 0.831167
Validation R2 Energy = 0.935834
Epoch 27
Train function
Loss = 1.7675e-04, PNorm = 53.5951, GNorm = 0.2651, lr_0 = 4.9583e-04
Validation rmse Energy = 0.853471
Validation R2 Energy = 0.932344
Epoch 28
Train function
Validation rmse Energy = 0.816651
Validation R2 Energy = 0.938056
Epoch 29
Train function
Loss = 7.8441e-05, PNorm = 53.6120, GNorm = 0.2680, lr_0 = 4.7626e-04
Validation rmse Energy = 0.833088
Validation R2 Energy = 0.935537
Epoch 30
Train function
Loss = 7.9367e-05, PNorm = 53.6183, GNorm = 0.1475, lr_0 = 4.6054e-04
Validation rmse Energy = 0.844685
Validation R2 Energy = 0.933730
Epoch 31
Train function
Loss = 9.2494e-05, PNorm = 53.6297, GNorm = 0.1485, lr_0 = 4.4384e-04
Loss = 2.7191e-04, PNorm = 53.6306, GNorm = 0.3935, lr_0 = 4.4236e-04
Validation rmse Energy = 0.820997
Validation R2 Energy = 0.937395
Epoch 32
Train function
Validation rmse Energy = 0.818685
Validation R2 Energy = 0.937747
Epoch 33
Train function
Loss = 9.7240e-05, PNorm = 53.6357, GNorm = 0.3256, lr_0 = 4.2632e-04
Validation rmse Energy = 0.830717
Validation R2 Energy = 0.935904
Epoch 34
Train function
Loss = 5.8885e-05, PNorm = 53.6452, GNorm = 0.1432, lr_0 = 4.1087e-04
Validation rmse Energy = 0.815772
Validation R2 Energy = 0.938189
Epoch 35
Train function
Validation rmse Energy = 0.836740
Validation R2 Energy = 0.934971
Epoch 36
Train function
Loss = 4.3495e-05, PNorm = 53.6527, GNorm = 0.0781, lr_0 = 3.9597e-04
Validation rmse Energy = 0.820581
Validation R2 Energy = 0.937458
Epoch 37
Train function
Loss = 7.2514e-05, PNorm = 53.6582, GNorm = 0.1174, lr_0 = 3.8162e-04
Validation rmse Energy = 0.824483
Validation R2 Energy = 0.936862
Epoch 38
Train function
Loss = 6.4613e-05, PNorm = 53.6664, GNorm = 0.1812, lr_0 = 3.6779e-04
Loss = 7.2804e-05, PNorm = 53.6673, GNorm = 0.1254, lr_0 = 3.6656e-04
Validation rmse Energy = 0.820704
Validation R2 Energy = 0.937440
Epoch 39
Train function
Validation rmse Energy = 0.819310
Validation R2 Energy = 0.937652
Epoch 40
Train function
Loss = 4.3467e-05, PNorm = 53.6718, GNorm = 0.1485, lr_0 = 3.5446e-04
Validation rmse Energy = 0.823019
Validation R2 Energy = 0.937086
Epoch 41
Train function
Loss = 3.5924e-05, PNorm = 53.6776, GNorm = 0.1751, lr_0 = 3.4161e-04
Validation rmse Energy = 0.818811
Validation R2 Energy = 0.937728
Epoch 42
Train function
Validation rmse Energy = 0.823405
Validation R2 Energy = 0.937027
Epoch 43
Train function
Loss = 4.9413e-05, PNorm = 53.6826, GNorm = 0.2197, lr_0 = 3.2812e-04
Validation rmse Energy = 0.854515
Validation R2 Energy = 0.932179
Epoch 44
Train function
Loss = 3.2088e-05, PNorm = 53.6877, GNorm = 0.1943, lr_0 = 3.1623e-04
Validation rmse Energy = 0.833326
Validation R2 Energy = 0.935501
Epoch 45
Train function
Loss = 5.8394e-05, PNorm = 53.6917, GNorm = 0.2222, lr_0 = 3.0579e-04
Validation rmse Energy = 0.862016
Validation R2 Energy = 0.930983
Epoch 46
Train function
Validation rmse Energy = 0.814772
Validation R2 Energy = 0.938341
Epoch 47
Train function
Loss = 3.5078e-05, PNorm = 53.6986, GNorm = 0.1446, lr_0 = 2.9372e-04
Validation rmse Energy = 0.837231
Validation R2 Energy = 0.934895
Epoch 48
Train function
Loss = 3.8518e-05, PNorm = 53.7038, GNorm = 0.3522, lr_0 = 2.8307e-04
Validation rmse Energy = 0.808120
Validation R2 Energy = 0.939344
Epoch 49
Train function
Loss = 4.0667e-05, PNorm = 53.7077, GNorm = 0.3748, lr_0 = 2.7281e-04
Validation rmse Energy = 0.810659
Validation R2 Energy = 0.938962
Epoch 50
Train function
Validation rmse Energy = 0.823182
Validation R2 Energy = 0.937061
Epoch 51
Train function
Loss = 2.3705e-05, PNorm = 53.7106, GNorm = 0.2566, lr_0 = 2.6292e-04
Validation rmse Energy = 0.807596
Validation R2 Energy = 0.939422
Epoch 52
Train function
Loss = 3.0723e-05, PNorm = 53.7130, GNorm = 0.2227, lr_0 = 2.5339e-04
Validation rmse Energy = 0.816188
Validation R2 Energy = 0.938126
Epoch 53
Train function
Validation rmse Energy = 0.811979
Validation R2 Energy = 0.938763
Epoch 54
Train function
Loss = 2.0176e-05, PNorm = 53.7176, GNorm = 0.0970, lr_0 = 2.4339e-04
Validation rmse Energy = 0.809423
Validation R2 Energy = 0.939148
Epoch 55
Train function
Loss = 2.1907e-05, PNorm = 53.7199, GNorm = 0.0981, lr_0 = 2.3535e-04
Validation rmse Energy = 0.821579
Validation R2 Energy = 0.937306
Epoch 56
Train function
Loss = 1.9115e-05, PNorm = 53.7227, GNorm = 0.0641, lr_0 = 2.2682e-04
Loss = 8.3657e-05, PNorm = 53.7230, GNorm = 0.1778, lr_0 = 2.2606e-04
Validation rmse Energy = 0.812978
Validation R2 Energy = 0.938612
Epoch 57
Train function
Validation rmse Energy = 0.813360
Validation R2 Energy = 0.938554
Epoch 58
Train function
Loss = 1.3592e-05, PNorm = 53.7258, GNorm = 0.0612, lr_0 = 2.1787e-04
Validation rmse Energy = 0.815235
Validation R2 Energy = 0.938271
Epoch 59
Train function
Loss = 1.6436e-05, PNorm = 53.7280, GNorm = 0.0828, lr_0 = 2.0997e-04
Validation rmse Energy = 0.810763
Validation R2 Energy = 0.938946
Epoch 60
Train function
Validation rmse Energy = 0.803578
Validation R2 Energy = 0.940023
Epoch 61
Train function
Loss = 2.8987e-05, PNorm = 53.7313, GNorm = 0.1618, lr_0 = 2.0236e-04
Validation rmse Energy = 0.809457
Validation R2 Energy = 0.939143
Epoch 62
Train function
Loss = 1.2580e-05, PNorm = 53.7327, GNorm = 0.0572, lr_0 = 1.9502e-04
Validation rmse Energy = 0.817733
Validation R2 Energy = 0.937892
Epoch 63
Train function
Loss = 1.7934e-05, PNorm = 53.7351, GNorm = 0.0735, lr_0 = 1.8795e-04
Loss = 1.6677e-04, PNorm = 53.7354, GNorm = 0.2916, lr_0 = 1.8732e-04
Validation rmse Energy = 0.810169
Validation R2 Energy = 0.939036
Epoch 64
Train function
Validation rmse Energy = 0.812036
Validation R2 Energy = 0.938754
Epoch 65
Train function
Loss = 9.3216e-06, PNorm = 53.7373, GNorm = 0.0485, lr_0 = 1.8114e-04
Validation rmse Energy = 0.815702
Validation R2 Energy = 0.938200
Epoch 66
Train function
Loss = 1.2476e-05, PNorm = 53.7393, GNorm = 0.0497, lr_0 = 1.7458e-04
Validation rmse Energy = 0.821448
Validation R2 Energy = 0.937326
Epoch 67
Train function
Validation rmse Energy = 0.811022
Validation R2 Energy = 0.938907
Epoch 68
Train function
Loss = 1.0613e-05, PNorm = 53.7413, GNorm = 0.0618, lr_0 = 1.6768e-04
Validation rmse Energy = 0.817511
Validation R2 Energy = 0.937926
Epoch 69
Train function
Loss = 1.0210e-05, PNorm = 53.7427, GNorm = 0.0502, lr_0 = 1.6161e-04
Validation rmse Energy = 0.812691
Validation R2 Energy = 0.938655
Epoch 70
Train function
Loss = 1.2462e-05, PNorm = 53.7444, GNorm = 0.0546, lr_0 = 1.5627e-04
Validation rmse Energy = 0.815399
Validation R2 Energy = 0.938246
Epoch 71
Train function
Validation rmse Energy = 0.811465
Validation R2 Energy = 0.938840
Epoch 72
Train function
Loss = 7.2713e-06, PNorm = 53.7460, GNorm = 0.0497, lr_0 = 1.5010e-04
Validation rmse Energy = 0.814865
Validation R2 Energy = 0.938327
Epoch 73
Train function
Loss = 1.1203e-05, PNorm = 53.7473, GNorm = 0.0547, lr_0 = 1.4466e-04
Validation rmse Energy = 0.810030
Validation R2 Energy = 0.939056
Epoch 74
Train function
Loss = 1.2088e-05, PNorm = 53.7489, GNorm = 0.1178, lr_0 = 1.3942e-04
Validation rmse Energy = 0.817454
Validation R2 Energy = 0.937934
Epoch 75
Train function
Validation rmse Energy = 0.809083
Validation R2 Energy = 0.939199
Epoch 76
Train function
Loss = 1.5170e-05, PNorm = 53.7505, GNorm = 0.0691, lr_0 = 1.3436e-04
Validation rmse Energy = 0.808267
Validation R2 Energy = 0.939321
Epoch 77
Train function
Loss = 1.2268e-05, PNorm = 53.7521, GNorm = 0.0650, lr_0 = 1.2949e-04
Validation rmse Energy = 0.811683
Validation R2 Energy = 0.938807
Epoch 78
Train function
Validation rmse Energy = 0.814571
Validation R2 Energy = 0.938371
Epoch 79
Train function
Loss = 6.5061e-06, PNorm = 53.7537, GNorm = 0.0331, lr_0 = 1.2438e-04
Validation rmse Energy = 0.820986
Validation R2 Energy = 0.937397
Epoch 80
Train function
Loss = 1.3019e-05, PNorm = 53.7551, GNorm = 0.1014, lr_0 = 1.2027e-04
Validation rmse Energy = 0.813270
Validation R2 Energy = 0.938568
Epoch 81
Train function
Loss = 9.1042e-06, PNorm = 53.7564, GNorm = 0.0456, lr_0 = 1.1592e-04
Loss = 3.5352e-05, PNorm = 53.7564, GNorm = 0.0664, lr_0 = 1.1553e-04
Validation rmse Energy = 0.813040
Validation R2 Energy = 0.938603
Epoch 82
Train function
Validation rmse Energy = 0.808841
Validation R2 Energy = 0.939235
Epoch 83
Train function
Loss = 1.0867e-05, PNorm = 53.7575, GNorm = 0.1046, lr_0 = 1.1134e-04
Validation rmse Energy = 0.812194
Validation R2 Energy = 0.938730
Epoch 84
Train function
Loss = 9.2652e-06, PNorm = 53.7586, GNorm = 0.0436, lr_0 = 1.0730e-04
Validation rmse Energy = 0.815013
Validation R2 Energy = 0.938304
Epoch 85
Train function
Validation rmse Energy = 0.818412
Validation R2 Energy = 0.937789
Epoch 86
Train function
Loss = 8.8163e-06, PNorm = 53.7597, GNorm = 0.0509, lr_0 = 1.0341e-04
Validation rmse Energy = 0.813720
Validation R2 Energy = 0.938500
Epoch 87
Train function
Loss = 6.6682e-06, PNorm = 53.7606, GNorm = 0.0595, lr_0 = 1.0000e-04
Validation rmse Energy = 0.812546
Validation R2 Energy = 0.938677
Epoch 88
Train function
Loss = 8.6217e-06, PNorm = 53.7615, GNorm = 0.0559, lr_0 = 1.0000e-04
Loss = 1.8756e-05, PNorm = 53.7616, GNorm = 0.0638, lr_0 = 1.0000e-04
Validation rmse Energy = 0.809103
Validation R2 Energy = 0.939196
Epoch 89
Train function
Validation rmse Energy = 0.812845
Validation R2 Energy = 0.938632
Epoch 90
Train function
Loss = 7.2392e-06, PNorm = 53.7624, GNorm = 0.0565, lr_0 = 1.0000e-04
Validation rmse Energy = 0.812181
Validation R2 Energy = 0.938732
Epoch 91
Train function
Loss = 7.1826e-06, PNorm = 53.7632, GNorm = 0.0274, lr_0 = 1.0000e-04
Validation rmse Energy = 0.811485
Validation R2 Energy = 0.938837
Epoch 92
Train function
Validation rmse Energy = 0.808985
Validation R2 Energy = 0.939213
Epoch 93
Train function
Loss = 4.9479e-06, PNorm = 53.7641, GNorm = 0.1067, lr_0 = 1.0000e-04
Validation rmse Energy = 0.811014
Validation R2 Energy = 0.938908
Epoch 94
Train function
Loss = 9.3627e-06, PNorm = 53.7650, GNorm = 0.0180, lr_0 = 1.0000e-04
Validation rmse Energy = 0.811510
Validation R2 Energy = 0.938834
Epoch 95
Train function
Loss = 7.5884e-06, PNorm = 53.7658, GNorm = 0.0566, lr_0 = 1.0000e-04
Validation rmse Energy = 0.817324
Validation R2 Energy = 0.937954
Epoch 96
Train function
Validation rmse Energy = 0.814076
Validation R2 Energy = 0.938446
Epoch 97
Train function
Loss = 3.8004e-06, PNorm = 53.7669, GNorm = 0.0500, lr_0 = 1.0000e-04
Validation rmse Energy = 0.807406
Validation R2 Energy = 0.939451
Epoch 98
Train function
Loss = 4.9911e-06, PNorm = 53.7678, GNorm = 0.0765, lr_0 = 1.0000e-04
Validation rmse Energy = 0.811858
Validation R2 Energy = 0.938781
Epoch 99
Train function
Loss = 7.1708e-06, PNorm = 53.7686, GNorm = 0.0618, lr_0 = 1.0000e-04
Validation rmse Energy = 0.809048
Validation R2 Energy = 0.939204
Model 0 best validation rmse = 0.803578 on epoch 60
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.086317
Model 0 test R2 Energy = 0.929401
Ensemble test rmse  Energy= 1.086317
Ensemble test R2  Energy= 0.929401
Fold 3
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': False,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_2d_normalized_best'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 199,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_311/folds/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': 'smiles',
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 360,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=999, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,305,601
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 2.853420
Validation R2 Energy = 0.507867
Epoch 1
Train function
Loss = 7.7477e-03, PNorm = 52.9598, GNorm = 1.4927, lr_0 = 8.7143e-04
Validation rmse Energy = 2.797154
Validation R2 Energy = 0.527084
Epoch 2
Train function
Loss = 6.2909e-03, PNorm = 53.0906, GNorm = 0.8936, lr_0 = 9.7024e-04
Validation rmse Energy = 1.929710
Validation R2 Energy = 0.774921
Epoch 3
Train function
Validation rmse Energy = 1.497231
Validation R2 Energy = 0.864503
Epoch 4
Train function
Loss = 2.2766e-03, PNorm = 53.2070, GNorm = 0.4246, lr_0 = 9.3194e-04
Validation rmse Energy = 1.331033
Validation R2 Energy = 0.892915
Epoch 5
Train function
Loss = 1.3975e-03, PNorm = 53.2782, GNorm = 0.3537, lr_0 = 9.0118e-04
Validation rmse Energy = 1.182576
Validation R2 Energy = 0.915470
Epoch 6
Train function
Loss = 1.0987e-03, PNorm = 53.3309, GNorm = 0.7279, lr_0 = 8.6851e-04
Loss = 2.5784e-03, PNorm = 53.3350, GNorm = 0.8310, lr_0 = 8.6560e-04
Validation rmse Energy = 1.314762
Validation R2 Energy = 0.895517
Epoch 7
Train function
Validation rmse Energy = 1.234538
Validation R2 Energy = 0.907879
Epoch 8
Train function
Loss = 6.4809e-04, PNorm = 53.3770, GNorm = 0.5866, lr_0 = 8.3422e-04
Validation rmse Energy = 1.195744
Validation R2 Energy = 0.913577
Epoch 9
Train function
Loss = 6.0290e-04, PNorm = 53.4108, GNorm = 1.0528, lr_0 = 8.0398e-04
Validation rmse Energy = 1.173126
Validation R2 Energy = 0.916816
Epoch 10
Train function
Validation rmse Energy = 1.146971
Validation R2 Energy = 0.920484
Epoch 11
Train function
Loss = 5.8336e-04, PNorm = 53.4373, GNorm = 0.5038, lr_0 = 7.7484e-04
Validation rmse Energy = 1.156205
Validation R2 Energy = 0.919198
Epoch 12
Train function
Loss = 3.4803e-04, PNorm = 53.4643, GNorm = 0.3988, lr_0 = 7.4675e-04
Validation rmse Energy = 1.074475
Validation R2 Energy = 0.930218
Epoch 13
Train function
Loss = 2.7816e-04, PNorm = 53.4843, GNorm = 0.1684, lr_0 = 7.1969e-04
Loss = 1.1436e-03, PNorm = 53.4865, GNorm = 0.4115, lr_0 = 7.1727e-04
Validation rmse Energy = 1.088062
Validation R2 Energy = 0.928442
Epoch 14
Train function
Validation rmse Energy = 1.096663
Validation R2 Energy = 0.927306
Epoch 15
Train function
Loss = 2.3355e-04, PNorm = 53.5076, GNorm = 0.3309, lr_0 = 6.9360e-04
Validation rmse Energy = 1.057221
Validation R2 Energy = 0.932441
Epoch 16
Train function
Loss = 2.1285e-04, PNorm = 53.5253, GNorm = 0.3444, lr_0 = 6.6846e-04
Validation rmse Energy = 1.118187
Validation R2 Energy = 0.924425
Epoch 17
Train function
Validation rmse Energy = 1.073789
Validation R2 Energy = 0.930307
Epoch 18
Train function
Loss = 1.5525e-04, PNorm = 53.5450, GNorm = 0.5406, lr_0 = 6.4207e-04
Validation rmse Energy = 1.088232
Validation R2 Energy = 0.928420
Epoch 19
Train function
Loss = 1.7860e-04, PNorm = 53.5586, GNorm = 0.2845, lr_0 = 6.1879e-04
Validation rmse Energy = 1.045127
Validation R2 Energy = 0.933978
Epoch 20
Train function
Loss = 1.4526e-04, PNorm = 53.5719, GNorm = 0.3690, lr_0 = 5.9837e-04
Validation rmse Energy = 1.124222
Validation R2 Energy = 0.923607
Epoch 21
Train function
Validation rmse Energy = 1.028851
Validation R2 Energy = 0.936018
Epoch 22
Train function
Loss = 1.0377e-04, PNorm = 53.5866, GNorm = 0.2044, lr_0 = 5.7475e-04
Validation rmse Energy = 1.054192
Validation R2 Energy = 0.932828
Epoch 23
Train function
Loss = 1.0453e-04, PNorm = 53.5990, GNorm = 0.2894, lr_0 = 5.5391e-04
Validation rmse Energy = 1.049180
Validation R2 Energy = 0.933465
Epoch 24
Train function
Loss = 1.0407e-04, PNorm = 53.6128, GNorm = 0.3020, lr_0 = 5.3383e-04
Validation rmse Energy = 1.063854
Validation R2 Energy = 0.931591
Epoch 25
Train function
Validation rmse Energy = 1.073220
Validation R2 Energy = 0.930381
Epoch 26
Train function
Loss = 1.0230e-04, PNorm = 53.6228, GNorm = 0.1668, lr_0 = 5.1448e-04
Validation rmse Energy = 1.038723
Validation R2 Energy = 0.934785
Epoch 27
Train function
Loss = 6.9951e-05, PNorm = 53.6328, GNorm = 0.2174, lr_0 = 4.9583e-04
Validation rmse Energy = 1.069223
Validation R2 Energy = 0.930898
Epoch 28
Train function
Validation rmse Energy = 1.119752
Validation R2 Energy = 0.924213
Epoch 29
Train function
Loss = 5.7771e-05, PNorm = 53.6408, GNorm = 0.2330, lr_0 = 4.7626e-04
Validation rmse Energy = 1.043080
Validation R2 Energy = 0.934236
Epoch 30
Train function
Loss = 7.6370e-05, PNorm = 53.6494, GNorm = 0.2345, lr_0 = 4.6054e-04
Validation rmse Energy = 1.039081
Validation R2 Energy = 0.934740
Epoch 31
Train function
Loss = 6.1906e-05, PNorm = 53.6560, GNorm = 0.3826, lr_0 = 4.4384e-04
Loss = 1.9776e-04, PNorm = 53.6570, GNorm = 0.4485, lr_0 = 4.4236e-04
Validation rmse Energy = 1.060503
Validation R2 Energy = 0.932021
Epoch 32
Train function
Validation rmse Energy = 1.044032
Validation R2 Energy = 0.934116
Epoch 33
Train function
Loss = 4.0576e-05, PNorm = 53.6666, GNorm = 0.0718, lr_0 = 4.2632e-04
Validation rmse Energy = 1.053899
Validation R2 Energy = 0.932865
Epoch 34
Train function
Loss = 6.9185e-05, PNorm = 53.6740, GNorm = 0.2022, lr_0 = 4.1087e-04
Validation rmse Energy = 1.055777
Validation R2 Energy = 0.932626
Epoch 35
Train function
Validation rmse Energy = 1.021467
Validation R2 Energy = 0.936933
Epoch 36
Train function
Loss = 3.0749e-05, PNorm = 53.6806, GNorm = 0.2007, lr_0 = 3.9597e-04
Validation rmse Energy = 1.042012
Validation R2 Energy = 0.934371
Epoch 37
Train function
Loss = 3.7305e-05, PNorm = 53.6862, GNorm = 0.1860, lr_0 = 3.8162e-04
Validation rmse Energy = 1.033025
Validation R2 Energy = 0.935498
Epoch 38
Train function
Loss = 3.9069e-05, PNorm = 53.6919, GNorm = 0.1478, lr_0 = 3.6779e-04
Loss = 6.4038e-05, PNorm = 53.6922, GNorm = 0.0968, lr_0 = 3.6656e-04
Validation rmse Energy = 1.033974
Validation R2 Energy = 0.935380
Epoch 39
Train function
Validation rmse Energy = 1.026452
Validation R2 Energy = 0.936316
Epoch 40
Train function
Loss = 4.4424e-05, PNorm = 53.6963, GNorm = 0.2192, lr_0 = 3.5446e-04
Validation rmse Energy = 1.053739
Validation R2 Energy = 0.932885
Epoch 41
Train function
Loss = 3.0853e-05, PNorm = 53.7007, GNorm = 0.1026, lr_0 = 3.4161e-04
Validation rmse Energy = 1.035699
Validation R2 Energy = 0.935164
Epoch 42
Train function
Validation rmse Energy = 1.053019
Validation R2 Energy = 0.932977
Epoch 43
Train function
Loss = 3.1085e-05, PNorm = 53.7062, GNorm = 0.2456, lr_0 = 3.2812e-04
Validation rmse Energy = 1.047635
Validation R2 Energy = 0.933661
Epoch 44
Train function
Loss = 3.2088e-05, PNorm = 53.7112, GNorm = 0.2234, lr_0 = 3.1623e-04
Validation rmse Energy = 1.024127
Validation R2 Energy = 0.936604
Epoch 45
Train function
Loss = 2.9261e-05, PNorm = 53.7145, GNorm = 0.2130, lr_0 = 3.0579e-04
Validation rmse Energy = 1.036019
Validation R2 Energy = 0.935124
Epoch 46
Train function
Validation rmse Energy = 1.046697
Validation R2 Energy = 0.933779
Epoch 47
Train function
Loss = 3.8378e-05, PNorm = 53.7190, GNorm = 0.4497, lr_0 = 2.9372e-04
Validation rmse Energy = 1.025729
Validation R2 Energy = 0.936406
Epoch 48
Train function
Loss = 3.4876e-05, PNorm = 53.7231, GNorm = 0.3015, lr_0 = 2.8307e-04
Validation rmse Energy = 1.039082
Validation R2 Energy = 0.934739
Epoch 49
Train function
Loss = 3.0079e-05, PNorm = 53.7269, GNorm = 0.1229, lr_0 = 2.7281e-04
Validation rmse Energy = 1.035290
Validation R2 Energy = 0.935215
Epoch 50
Train function
Validation rmse Energy = 1.036865
Validation R2 Energy = 0.935018
Epoch 51
Train function
Loss = 3.6113e-05, PNorm = 53.7301, GNorm = 0.2288, lr_0 = 2.6292e-04
Validation rmse Energy = 1.049738
Validation R2 Energy = 0.933394
Epoch 52
Train function
Loss = 2.2079e-05, PNorm = 53.7328, GNorm = 0.0648, lr_0 = 2.5339e-04
Validation rmse Energy = 1.034305
Validation R2 Energy = 0.935338
Epoch 53
Train function
Validation rmse Energy = 1.042411
Validation R2 Energy = 0.934321
Epoch 54
Train function
Loss = 2.2975e-05, PNorm = 53.7366, GNorm = 0.1452, lr_0 = 2.4339e-04
Validation rmse Energy = 1.043009
Validation R2 Energy = 0.934245
Epoch 55
Train function
Loss = 2.1937e-05, PNorm = 53.7397, GNorm = 0.1101, lr_0 = 2.3535e-04
Validation rmse Energy = 1.037031
Validation R2 Energy = 0.934997
Epoch 56
Train function
Loss = 1.9607e-05, PNorm = 53.7423, GNorm = 0.0899, lr_0 = 2.2682e-04
Loss = 2.3412e-05, PNorm = 53.7425, GNorm = 0.0569, lr_0 = 2.2606e-04
Validation rmse Energy = 1.039241
Validation R2 Energy = 0.934719
Epoch 57
Train function
Validation rmse Energy = 1.043800
Validation R2 Energy = 0.934145
Epoch 58
Train function
Loss = 1.5070e-05, PNorm = 53.7444, GNorm = 0.0929, lr_0 = 2.1787e-04
Validation rmse Energy = 1.037525
Validation R2 Energy = 0.934935
Epoch 59
Train function
Loss = 1.6294e-05, PNorm = 53.7463, GNorm = 0.0696, lr_0 = 2.0997e-04
Validation rmse Energy = 1.041608
Validation R2 Energy = 0.934422
Epoch 60
Train function
Validation rmse Energy = 1.041663
Validation R2 Energy = 0.934415
Epoch 61
Train function
Loss = 1.5382e-05, PNorm = 53.7481, GNorm = 0.0855, lr_0 = 2.0236e-04
Validation rmse Energy = 1.042454
Validation R2 Energy = 0.934315
Epoch 62
Train function
Loss = 1.5422e-05, PNorm = 53.7501, GNorm = 0.0589, lr_0 = 1.9502e-04
Validation rmse Energy = 1.037722
Validation R2 Energy = 0.934910
Epoch 63
Train function
Loss = 1.4594e-05, PNorm = 53.7521, GNorm = 0.0699, lr_0 = 1.8795e-04
Loss = 5.0083e-05, PNorm = 53.7522, GNorm = 0.0843, lr_0 = 1.8732e-04
Validation rmse Energy = 1.044204
Validation R2 Energy = 0.934094
Epoch 64
Train function
Validation rmse Energy = 1.038708
Validation R2 Energy = 0.934786
Epoch 65
Train function
Loss = 1.0369e-05, PNorm = 53.7538, GNorm = 0.0848, lr_0 = 1.8114e-04
Validation rmse Energy = 1.034513
Validation R2 Energy = 0.935312
Epoch 66
Train function
Loss = 1.0578e-05, PNorm = 53.7556, GNorm = 0.0926, lr_0 = 1.7458e-04
Validation rmse Energy = 1.040446
Validation R2 Energy = 0.934568
Epoch 67
Train function
Validation rmse Energy = 1.040460
Validation R2 Energy = 0.934566
Epoch 68
Train function
Loss = 6.3472e-06, PNorm = 53.7570, GNorm = 0.0524, lr_0 = 1.6768e-04
Validation rmse Energy = 1.040858
Validation R2 Energy = 0.934516
Epoch 69
Train function
Loss = 1.2288e-05, PNorm = 53.7586, GNorm = 0.1699, lr_0 = 1.6161e-04
Validation rmse Energy = 1.036545
Validation R2 Energy = 0.935058
Epoch 70
Train function
Loss = 1.5550e-05, PNorm = 53.7596, GNorm = 0.1232, lr_0 = 1.5627e-04
Validation rmse Energy = 1.045153
Validation R2 Energy = 0.933975
Epoch 71
Train function
Validation rmse Energy = 1.037051
Validation R2 Energy = 0.934994
Epoch 72
Train function
Loss = 7.7317e-06, PNorm = 53.7613, GNorm = 0.0919, lr_0 = 1.5010e-04
Validation rmse Energy = 1.041450
Validation R2 Energy = 0.934442
Epoch 73
Train function
Loss = 1.4536e-05, PNorm = 53.7631, GNorm = 0.0486, lr_0 = 1.4466e-04
Validation rmse Energy = 1.047814
Validation R2 Energy = 0.933638
Epoch 74
Train function
Loss = 1.0669e-05, PNorm = 53.7648, GNorm = 0.0577, lr_0 = 1.3942e-04
Validation rmse Energy = 1.043299
Validation R2 Energy = 0.934209
Epoch 75
Train function
Validation rmse Energy = 1.040345
Validation R2 Energy = 0.934581
Epoch 76
Train function
Loss = 7.9777e-06, PNorm = 53.7660, GNorm = 0.0682, lr_0 = 1.3436e-04
Validation rmse Energy = 1.042734
Validation R2 Energy = 0.934280
Epoch 77
Train function
Loss = 9.1984e-06, PNorm = 53.7673, GNorm = 0.0299, lr_0 = 1.2949e-04
Validation rmse Energy = 1.040535
Validation R2 Energy = 0.934557
Epoch 78
Train function
Validation rmse Energy = 1.042093
Validation R2 Energy = 0.934361
Epoch 79
Train function
Loss = 1.2388e-05, PNorm = 53.7685, GNorm = 0.0353, lr_0 = 1.2438e-04
Validation rmse Energy = 1.040868
Validation R2 Energy = 0.934515
Epoch 80
Train function
Loss = 9.3357e-06, PNorm = 53.7696, GNorm = 0.0330, lr_0 = 1.2027e-04
Validation rmse Energy = 1.046020
Validation R2 Energy = 0.933865
Epoch 81
Train function
Loss = 8.8131e-06, PNorm = 53.7706, GNorm = 0.0584, lr_0 = 1.1592e-04
Loss = 1.7382e-05, PNorm = 53.7707, GNorm = 0.1108, lr_0 = 1.1553e-04
Validation rmse Energy = 1.040580
Validation R2 Energy = 0.934551
Epoch 82
Train function
Validation rmse Energy = 1.042398
Validation R2 Energy = 0.934322
Epoch 83
Train function
Loss = 8.1542e-06, PNorm = 53.7717, GNorm = 0.0400, lr_0 = 1.1134e-04
Validation rmse Energy = 1.042476
Validation R2 Energy = 0.934312
Epoch 84
Train function
Loss = 8.5468e-06, PNorm = 53.7725, GNorm = 0.0448, lr_0 = 1.0730e-04
Validation rmse Energy = 1.043691
Validation R2 Energy = 0.934159
Epoch 85
Train function
Validation rmse Energy = 1.042557
Validation R2 Energy = 0.934302
Epoch 86
Train function
Loss = 1.2367e-05, PNorm = 53.7734, GNorm = 0.0529, lr_0 = 1.0341e-04
Validation rmse Energy = 1.043540
Validation R2 Energy = 0.934178
Epoch 87
Train function
Loss = 6.2864e-06, PNorm = 53.7744, GNorm = 0.0137, lr_0 = 1.0000e-04
Validation rmse Energy = 1.042346
Validation R2 Energy = 0.934329
Epoch 88
Train function
Loss = 7.6377e-06, PNorm = 53.7753, GNorm = 0.0399, lr_0 = 1.0000e-04
Loss = 1.7417e-05, PNorm = 53.7755, GNorm = 0.0471, lr_0 = 1.0000e-04
Validation rmse Energy = 1.041994
Validation R2 Energy = 0.934373
Epoch 89
Train function
Validation rmse Energy = 1.044020
Validation R2 Energy = 0.934118
Epoch 90
Train function
Loss = 7.3287e-06, PNorm = 53.7764, GNorm = 0.0622, lr_0 = 1.0000e-04
Validation rmse Energy = 1.041874
Validation R2 Energy = 0.934388
Epoch 91
Train function
Loss = 8.6127e-06, PNorm = 53.7772, GNorm = 0.0536, lr_0 = 1.0000e-04
Validation rmse Energy = 1.045148
Validation R2 Energy = 0.933975
Epoch 92
Train function
Validation rmse Energy = 1.043265
Validation R2 Energy = 0.934213
Epoch 93
Train function
Loss = 1.5170e-05, PNorm = 53.7782, GNorm = 0.1849, lr_0 = 1.0000e-04
Validation rmse Energy = 1.044576
Validation R2 Energy = 0.934047
Epoch 94
Train function
Loss = 5.8678e-06, PNorm = 53.7790, GNorm = 0.0345, lr_0 = 1.0000e-04
Validation rmse Energy = 1.042506
Validation R2 Energy = 0.934309
Epoch 95
Train function
Loss = 5.3420e-06, PNorm = 53.7798, GNorm = 0.0313, lr_0 = 1.0000e-04
Validation rmse Energy = 1.045193
Validation R2 Energy = 0.933970
Epoch 96
Train function
Validation rmse Energy = 1.043448
Validation R2 Energy = 0.934190
Epoch 97
Train function
Loss = 1.0663e-05, PNorm = 53.7809, GNorm = 0.1421, lr_0 = 1.0000e-04
Validation rmse Energy = 1.044724
Validation R2 Energy = 0.934029
Epoch 98
Train function
Loss = 6.6200e-06, PNorm = 53.7821, GNorm = 0.0352, lr_0 = 1.0000e-04
Validation rmse Energy = 1.043036
Validation R2 Energy = 0.934242
Epoch 99
Train function
Loss = 7.3034e-06, PNorm = 53.7832, GNorm = 0.0511, lr_0 = 1.0000e-04
Validation rmse Energy = 1.040329
Validation R2 Energy = 0.934583
Model 0 best validation rmse = 1.021467 on epoch 35
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.003269
Model 0 test R2 Energy = 0.939783
Ensemble test rmse  Energy= 1.003269
Ensemble test R2  Energy= 0.939783
4-fold cross validation
	Seed 0 ==> test rmse = 1.118383
	Seed 0 ==> test R2 = 0.925172
	Seed 1 ==> test rmse = 0.989051
	Seed 1 ==> test R2 = 0.941478
	Seed 2 ==> test rmse = 1.086317
	Seed 2 ==> test R2 = 0.929401
	Seed 3 ==> test rmse = 1.003269
	Seed 3 ==> test R2 = 0.939783
Overall val rmse Energy= 0.906691 +/- 0.171401
Overall val R2 Energy = 0.943845 +/- 0.010689
Overall test rmse Energy = 1.049255 +/- 0.054524
Overall test R2 Energy = 0.933958 +/- 0.006864
Elapsed time = 0:06:55
