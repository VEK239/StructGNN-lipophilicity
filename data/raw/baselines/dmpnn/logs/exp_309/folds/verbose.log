Fold 0
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': True,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_wo_fragments_and_counts'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': None,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_309/folds/fold_0',
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 0
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (substructures_encoder): SubstructureLayer(
    (encoder): SubstructureEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_o): Linear(in_features=165, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=1195, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,512,201
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 3.520009
Validation R2 Energy = 0.366982
Epoch 1
Train function
Loss = 1.3717e-02, PNorm = 55.5987, GNorm = 3.3050, lr_0 = 8.7143e-04
Validation rmse Energy = 2.689976
Validation R2 Energy = 0.630321
Epoch 2
Train function
Loss = 6.2197e-03, PNorm = 55.7515, GNorm = 2.2364, lr_0 = 9.7024e-04
Validation rmse Energy = 2.230503
Validation R2 Energy = 0.745824
Epoch 3
Train function
Validation rmse Energy = 1.900401
Validation R2 Energy = 0.815490
Epoch 4
Train function
Loss = 3.3430e-03, PNorm = 55.8926, GNorm = 3.8418, lr_0 = 9.3194e-04
Validation rmse Energy = 1.570134
Validation R2 Energy = 0.874049
Epoch 5
Train function
Loss = 1.8224e-03, PNorm = 55.9770, GNorm = 0.8270, lr_0 = 9.0118e-04
Validation rmse Energy = 1.701787
Validation R2 Energy = 0.852042
Epoch 6
Train function
Loss = 2.0967e-03, PNorm = 56.0375, GNorm = 2.7688, lr_0 = 8.6851e-04
Loss = 5.0509e-03, PNorm = 56.0432, GNorm = 1.7642, lr_0 = 8.6560e-04
Validation rmse Energy = 1.394398
Validation R2 Energy = 0.900665
Epoch 7
Train function
Validation rmse Energy = 1.372512
Validation R2 Energy = 0.903759
Epoch 8
Train function
Loss = 7.8418e-04, PNorm = 56.0866, GNorm = 0.6591, lr_0 = 8.3422e-04
Validation rmse Energy = 1.432999
Validation R2 Energy = 0.895089
Epoch 9
Train function
Loss = 8.9460e-04, PNorm = 56.1228, GNorm = 0.3979, lr_0 = 8.0398e-04
Validation rmse Energy = 1.293235
Validation R2 Energy = 0.914556
Epoch 10
Train function
Validation rmse Energy = 1.464488
Validation R2 Energy = 0.890428
Epoch 11
Train function
Loss = 1.1950e-03, PNorm = 56.1551, GNorm = 2.7540, lr_0 = 7.7484e-04
Validation rmse Energy = 1.302068
Validation R2 Energy = 0.913384
Epoch 12
Train function
Loss = 1.5899e-03, PNorm = 56.1958, GNorm = 2.9164, lr_0 = 7.4675e-04
Validation rmse Energy = 1.270966
Validation R2 Energy = 0.917473
Epoch 13
Train function
Loss = 1.2634e-03, PNorm = 56.2375, GNorm = 1.9151, lr_0 = 7.1969e-04
Loss = 8.3744e-03, PNorm = 56.2409, GNorm = 2.7451, lr_0 = 7.1727e-04
Validation rmse Energy = 1.367637
Validation R2 Energy = 0.904441
Epoch 14
Train function
Validation rmse Energy = 1.279694
Validation R2 Energy = 0.916336
Epoch 15
Train function
Loss = 1.1137e-03, PNorm = 56.2837, GNorm = 2.6239, lr_0 = 6.9360e-04
Validation rmse Energy = 1.316722
Validation R2 Energy = 0.911424
Epoch 16
Train function
Loss = 5.9876e-04, PNorm = 56.3153, GNorm = 0.5122, lr_0 = 6.6846e-04
Validation rmse Energy = 1.188280
Validation R2 Energy = 0.927862
Epoch 17
Train function
Validation rmse Energy = 1.209947
Validation R2 Energy = 0.925207
Epoch 18
Train function
Loss = 3.2860e-04, PNorm = 56.3535, GNorm = 0.6794, lr_0 = 6.4207e-04
Validation rmse Energy = 1.172005
Validation R2 Energy = 0.929824
Epoch 19
Train function
Loss = 5.1118e-04, PNorm = 56.3686, GNorm = 0.6712, lr_0 = 6.1879e-04
Validation rmse Energy = 1.248472
Validation R2 Energy = 0.920368
Epoch 20
Train function
Loss = 4.3805e-04, PNorm = 56.3972, GNorm = 1.0388, lr_0 = 5.9837e-04
Validation rmse Energy = 1.180613
Validation R2 Energy = 0.928790
Epoch 21
Train function
Validation rmse Energy = 1.114842
Validation R2 Energy = 0.936503
Epoch 22
Train function
Loss = 2.7735e-04, PNorm = 56.4186, GNorm = 0.5636, lr_0 = 5.7475e-04
Validation rmse Energy = 1.137085
Validation R2 Energy = 0.933944
Epoch 23
Train function
Loss = 3.4998e-04, PNorm = 56.4382, GNorm = 0.8121, lr_0 = 5.5391e-04
Validation rmse Energy = 1.238028
Validation R2 Energy = 0.921695
Epoch 24
Train function
Loss = 3.3299e-04, PNorm = 56.4582, GNorm = 0.6867, lr_0 = 5.3383e-04
Validation rmse Energy = 1.249303
Validation R2 Energy = 0.920262
Epoch 25
Train function
Validation rmse Energy = 1.078840
Validation R2 Energy = 0.940538
Epoch 26
Train function
Loss = 2.6787e-04, PNorm = 56.4728, GNorm = 1.1475, lr_0 = 5.1448e-04
Validation rmse Energy = 1.095353
Validation R2 Energy = 0.938703
Epoch 27
Train function
Loss = 1.6777e-04, PNorm = 56.4863, GNorm = 0.2843, lr_0 = 4.9583e-04
Validation rmse Energy = 1.056217
Validation R2 Energy = 0.943005
Epoch 28
Train function
Validation rmse Energy = 1.053346
Validation R2 Energy = 0.943315
Epoch 29
Train function
Loss = 2.0019e-04, PNorm = 56.4977, GNorm = 0.7405, lr_0 = 4.7626e-04
Validation rmse Energy = 1.083366
Validation R2 Energy = 0.940038
Epoch 30
Train function
Loss = 1.3932e-04, PNorm = 56.5120, GNorm = 0.2511, lr_0 = 4.6054e-04
Validation rmse Energy = 1.070088
Validation R2 Energy = 0.941498
Epoch 31
Train function
Loss = 1.7755e-04, PNorm = 56.5220, GNorm = 0.7566, lr_0 = 4.4384e-04
Loss = 3.9250e-04, PNorm = 56.5228, GNorm = 0.6154, lr_0 = 4.4236e-04
Validation rmse Energy = 1.051513
Validation R2 Energy = 0.943512
Epoch 32
Train function
Validation rmse Energy = 1.027640
Validation R2 Energy = 0.946048
Epoch 33
Train function
Loss = 1.4970e-04, PNorm = 56.5334, GNorm = 0.1979, lr_0 = 4.2632e-04
Validation rmse Energy = 1.060188
Validation R2 Energy = 0.942576
Epoch 34
Train function
Loss = 1.4314e-04, PNorm = 56.5431, GNorm = 0.6981, lr_0 = 4.1087e-04
Validation rmse Energy = 1.040448
Validation R2 Energy = 0.944694
Epoch 35
Train function
Validation rmse Energy = 1.030692
Validation R2 Energy = 0.945727
Epoch 36
Train function
Loss = 1.5706e-04, PNorm = 56.5528, GNorm = 0.7388, lr_0 = 3.9597e-04
Validation rmse Energy = 1.059034
Validation R2 Energy = 0.942701
Epoch 37
Train function
Loss = 8.2928e-05, PNorm = 56.5599, GNorm = 0.5004, lr_0 = 3.8162e-04
Validation rmse Energy = 1.058325
Validation R2 Energy = 0.942778
Epoch 38
Train function
Loss = 1.0117e-04, PNorm = 56.5691, GNorm = 0.3587, lr_0 = 3.6779e-04
Loss = 2.1321e-04, PNorm = 56.5700, GNorm = 0.2054, lr_0 = 3.6656e-04
Validation rmse Energy = 1.132392
Validation R2 Energy = 0.934488
Epoch 39
Train function
Validation rmse Energy = 1.067060
Validation R2 Energy = 0.941829
Epoch 40
Train function
Loss = 8.5389e-05, PNorm = 56.5766, GNorm = 0.1438, lr_0 = 3.5446e-04
Validation rmse Energy = 1.075614
Validation R2 Energy = 0.940893
Epoch 41
Train function
Loss = 7.1826e-05, PNorm = 56.5838, GNorm = 0.4872, lr_0 = 3.4161e-04
Validation rmse Energy = 1.053551
Validation R2 Energy = 0.943293
Epoch 42
Train function
Validation rmse Energy = 1.055175
Validation R2 Energy = 0.943118
Epoch 43
Train function
Loss = 5.2780e-05, PNorm = 56.5904, GNorm = 0.1816, lr_0 = 3.2812e-04
Validation rmse Energy = 1.052042
Validation R2 Energy = 0.943455
Epoch 44
Train function
Loss = 6.3140e-05, PNorm = 56.5961, GNorm = 0.1727, lr_0 = 3.1623e-04
Validation rmse Energy = 1.049335
Validation R2 Energy = 0.943746
Epoch 45
Train function
Loss = 5.3077e-05, PNorm = 56.6012, GNorm = 0.1724, lr_0 = 3.0579e-04
Validation rmse Energy = 1.048061
Validation R2 Energy = 0.943882
Epoch 46
Train function
Validation rmse Energy = 1.036574
Validation R2 Energy = 0.945105
Epoch 47
Train function
Loss = 4.9025e-05, PNorm = 56.6070, GNorm = 0.2140, lr_0 = 2.9372e-04
Validation rmse Energy = 1.042730
Validation R2 Energy = 0.944452
Epoch 48
Train function
Loss = 5.4552e-05, PNorm = 56.6126, GNorm = 0.1626, lr_0 = 2.8307e-04
Validation rmse Energy = 1.041866
Validation R2 Energy = 0.944544
Epoch 49
Train function
Loss = 4.5686e-05, PNorm = 56.6160, GNorm = 0.1324, lr_0 = 2.7281e-04
Validation rmse Energy = 1.038582
Validation R2 Energy = 0.944893
Epoch 50
Train function
Validation rmse Energy = 1.033114
Validation R2 Energy = 0.945471
Epoch 51
Train function
Loss = 4.7334e-05, PNorm = 56.6209, GNorm = 0.4711, lr_0 = 2.6292e-04
Validation rmse Energy = 1.039874
Validation R2 Energy = 0.944755
Epoch 52
Train function
Loss = 5.2778e-05, PNorm = 56.6237, GNorm = 0.4868, lr_0 = 2.5339e-04
Validation rmse Energy = 1.028307
Validation R2 Energy = 0.945978
Epoch 53
Train function
Validation rmse Energy = 1.024430
Validation R2 Energy = 0.946384
Epoch 54
Train function
Loss = 4.8999e-05, PNorm = 56.6273, GNorm = 0.3887, lr_0 = 2.4339e-04
Validation rmse Energy = 1.032425
Validation R2 Energy = 0.945544
Epoch 55
Train function
Loss = 3.2472e-05, PNorm = 56.6311, GNorm = 0.2039, lr_0 = 2.3535e-04
Validation rmse Energy = 1.034655
Validation R2 Energy = 0.945309
Epoch 56
Train function
Loss = 3.4789e-05, PNorm = 56.6340, GNorm = 0.1488, lr_0 = 2.2682e-04
Loss = 1.2230e-04, PNorm = 56.6342, GNorm = 0.1397, lr_0 = 2.2606e-04
Validation rmse Energy = 1.029108
Validation R2 Energy = 0.945893
Epoch 57
Train function
Validation rmse Energy = 1.036043
Validation R2 Energy = 0.945162
Epoch 58
Train function
Loss = 3.2344e-05, PNorm = 56.6372, GNorm = 0.1232, lr_0 = 2.1787e-04
Validation rmse Energy = 1.035195
Validation R2 Energy = 0.945251
Epoch 59
Train function
Loss = 2.6118e-05, PNorm = 56.6400, GNorm = 0.0940, lr_0 = 2.0997e-04
Validation rmse Energy = 1.024074
Validation R2 Energy = 0.946421
Epoch 60
Train function
Validation rmse Energy = 1.033689
Validation R2 Energy = 0.945411
Epoch 61
Train function
Loss = 3.0522e-05, PNorm = 56.6431, GNorm = 0.1471, lr_0 = 2.0236e-04
Validation rmse Energy = 1.033640
Validation R2 Energy = 0.945416
Epoch 62
Train function
Loss = 2.9028e-05, PNorm = 56.6463, GNorm = 0.1687, lr_0 = 1.9502e-04
Validation rmse Energy = 1.037755
Validation R2 Energy = 0.944980
Epoch 63
Train function
Loss = 2.6805e-05, PNorm = 56.6493, GNorm = 0.0822, lr_0 = 1.8795e-04
Loss = 4.7849e-05, PNorm = 56.6496, GNorm = 0.1860, lr_0 = 1.8732e-04
Validation rmse Energy = 1.042105
Validation R2 Energy = 0.944518
Epoch 64
Train function
Validation rmse Energy = 1.040115
Validation R2 Energy = 0.944730
Epoch 65
Train function
Loss = 2.6129e-05, PNorm = 56.6515, GNorm = 0.0875, lr_0 = 1.8114e-04
Validation rmse Energy = 1.032792
Validation R2 Energy = 0.945505
Epoch 66
Train function
Loss = 1.7583e-05, PNorm = 56.6536, GNorm = 0.1196, lr_0 = 1.7458e-04
Validation rmse Energy = 1.034833
Validation R2 Energy = 0.945290
Epoch 67
Train function
Validation rmse Energy = 1.050606
Validation R2 Energy = 0.943609
Epoch 68
Train function
Loss = 1.6344e-05, PNorm = 56.6559, GNorm = 0.1453, lr_0 = 1.6768e-04
Validation rmse Energy = 1.046314
Validation R2 Energy = 0.944069
Epoch 69
Train function
Loss = 2.9367e-05, PNorm = 56.6576, GNorm = 0.0967, lr_0 = 1.6161e-04
Validation rmse Energy = 1.055534
Validation R2 Energy = 0.943079
Epoch 70
Train function
Loss = 2.8911e-05, PNorm = 56.6597, GNorm = 0.2866, lr_0 = 1.5627e-04
Validation rmse Energy = 1.046088
Validation R2 Energy = 0.944093
Epoch 71
Train function
Validation rmse Energy = 1.031315
Validation R2 Energy = 0.945661
Epoch 72
Train function
Loss = 2.3802e-05, PNorm = 56.6607, GNorm = 0.1371, lr_0 = 1.5010e-04
Validation rmse Energy = 1.051752
Validation R2 Energy = 0.943486
Epoch 73
Train function
Loss = 2.5332e-05, PNorm = 56.6637, GNorm = 0.2017, lr_0 = 1.4466e-04
Validation rmse Energy = 1.048714
Validation R2 Energy = 0.943812
Epoch 74
Train function
Loss = 2.5770e-05, PNorm = 56.6650, GNorm = 0.1049, lr_0 = 1.3942e-04
Validation rmse Energy = 1.035021
Validation R2 Energy = 0.945270
Epoch 75
Train function
Validation rmse Energy = 1.039606
Validation R2 Energy = 0.944784
Epoch 76
Train function
Loss = 2.1419e-05, PNorm = 56.6666, GNorm = 0.0846, lr_0 = 1.3436e-04
Validation rmse Energy = 1.037697
Validation R2 Energy = 0.944986
Epoch 77
Train function
Loss = 2.0412e-05, PNorm = 56.6684, GNorm = 0.0933, lr_0 = 1.2949e-04
Validation rmse Energy = 1.033572
Validation R2 Energy = 0.945423
Epoch 78
Train function
Validation rmse Energy = 1.038419
Validation R2 Energy = 0.944910
Epoch 79
Train function
Loss = 1.7631e-05, PNorm = 56.6696, GNorm = 0.1237, lr_0 = 1.2438e-04
Validation rmse Energy = 1.040360
Validation R2 Energy = 0.944704
Epoch 80
Train function
Loss = 1.6946e-05, PNorm = 56.6710, GNorm = 0.0530, lr_0 = 1.2027e-04
Validation rmse Energy = 1.039209
Validation R2 Energy = 0.944826
Epoch 81
Train function
Loss = 1.8042e-05, PNorm = 56.6724, GNorm = 0.2317, lr_0 = 1.1592e-04
Loss = 5.3305e-05, PNorm = 56.6725, GNorm = 0.1679, lr_0 = 1.1553e-04
Validation rmse Energy = 1.038435
Validation R2 Energy = 0.944908
Epoch 82
Train function
Validation rmse Energy = 1.034289
Validation R2 Energy = 0.945347
Epoch 83
Train function
Loss = 2.0147e-05, PNorm = 56.6739, GNorm = 0.0596, lr_0 = 1.1134e-04
Validation rmse Energy = 1.034428
Validation R2 Energy = 0.945333
Epoch 84
Train function
Loss = 1.7210e-05, PNorm = 56.6751, GNorm = 0.0821, lr_0 = 1.0730e-04
Validation rmse Energy = 1.035985
Validation R2 Energy = 0.945168
Epoch 85
Train function
Validation rmse Energy = 1.046509
Validation R2 Energy = 0.944048
Epoch 86
Train function
Loss = 1.1760e-05, PNorm = 56.6764, GNorm = 0.0947, lr_0 = 1.0341e-04
Validation rmse Energy = 1.024886
Validation R2 Energy = 0.946336
Epoch 87
Train function
Loss = 1.7818e-05, PNorm = 56.6773, GNorm = 0.0782, lr_0 = 1.0000e-04
Validation rmse Energy = 1.040877
Validation R2 Energy = 0.944649
Epoch 88
Train function
Loss = 1.8322e-05, PNorm = 56.6786, GNorm = 0.0442, lr_0 = 1.0000e-04
Loss = 3.6194e-05, PNorm = 56.6787, GNorm = 0.0863, lr_0 = 1.0000e-04
Validation rmse Energy = 1.047225
Validation R2 Energy = 0.943972
Epoch 89
Train function
Validation rmse Energy = 1.039260
Validation R2 Energy = 0.944821
Epoch 90
Train function
Loss = 1.2113e-05, PNorm = 56.6799, GNorm = 0.1507, lr_0 = 1.0000e-04
Validation rmse Energy = 1.029921
Validation R2 Energy = 0.945808
Epoch 91
Train function
Loss = 1.5624e-05, PNorm = 56.6811, GNorm = 0.1277, lr_0 = 1.0000e-04
Validation rmse Energy = 1.036522
Validation R2 Energy = 0.945111
Epoch 92
Train function
Validation rmse Energy = 1.042575
Validation R2 Energy = 0.944468
Epoch 93
Train function
Loss = 1.6611e-05, PNorm = 56.6824, GNorm = 0.0847, lr_0 = 1.0000e-04
Validation rmse Energy = 1.035707
Validation R2 Energy = 0.945197
Epoch 94
Train function
Loss = 1.1944e-05, PNorm = 56.6837, GNorm = 0.1403, lr_0 = 1.0000e-04
Validation rmse Energy = 1.030738
Validation R2 Energy = 0.945722
Epoch 95
Train function
Loss = 1.6176e-05, PNorm = 56.6847, GNorm = 0.1696, lr_0 = 1.0000e-04
Validation rmse Energy = 1.028670
Validation R2 Energy = 0.945939
Epoch 96
Train function
Validation rmse Energy = 1.043704
Validation R2 Energy = 0.944348
Epoch 97
Train function
Loss = 1.5205e-05, PNorm = 56.6859, GNorm = 0.1001, lr_0 = 1.0000e-04
Validation rmse Energy = 1.047812
Validation R2 Energy = 0.943909
Epoch 98
Train function
Loss = 1.8943e-05, PNorm = 56.6869, GNorm = 0.0952, lr_0 = 1.0000e-04
Validation rmse Energy = 1.035295
Validation R2 Energy = 0.945241
Epoch 99
Train function
Loss = 2.3393e-05, PNorm = 56.6882, GNorm = 0.4519, lr_0 = 1.0000e-04
Validation rmse Energy = 1.034547
Validation R2 Energy = 0.945320
Model 0 best validation rmse = 1.024074 on epoch 59
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "substructures_encoder.encoder.cached_zero_vector".
Loading pretrained parameter "substructures_encoder.encoder.W_o.weight".
Loading pretrained parameter "substructures_encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.179577
Model 0 test R2 Energy = 0.916759
Ensemble test rmse  Energy= 1.179577
Ensemble test R2  Energy= 0.916759
Fold 1
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': True,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_wo_fragments_and_counts'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 95,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_309/folds/fold_1',
 'save_smiles_splits': False,
 'seed': 1,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 360,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 1
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (substructures_encoder): SubstructureLayer(
    (encoder): SubstructureEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_o): Linear(in_features=165, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=1195, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,512,201
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 2.427223
Validation R2 Energy = 0.524587
Epoch 1
Train function
Loss = 1.1701e-02, PNorm = 55.5985, GNorm = 5.9101, lr_0 = 8.7143e-04
Validation rmse Energy = 1.810828
Validation R2 Energy = 0.735390
Epoch 2
Train function
Loss = 6.3772e-03, PNorm = 55.7510, GNorm = 0.9897, lr_0 = 9.7024e-04
Validation rmse Energy = 1.523762
Validation R2 Energy = 0.812636
Epoch 3
Train function
Validation rmse Energy = 1.354984
Validation R2 Energy = 0.851844
Epoch 4
Train function
Loss = 4.1998e-03, PNorm = 55.8828, GNorm = 2.3208, lr_0 = 9.3194e-04
Validation rmse Energy = 1.396852
Validation R2 Energy = 0.842547
Epoch 5
Train function
Loss = 2.1298e-03, PNorm = 55.9684, GNorm = 3.4510, lr_0 = 9.0118e-04
Validation rmse Energy = 1.122255
Validation R2 Energy = 0.898367
Epoch 6
Train function
Loss = 1.7598e-03, PNorm = 56.0175, GNorm = 1.9982, lr_0 = 8.6851e-04
Loss = 1.6367e-02, PNorm = 56.0229, GNorm = 3.0584, lr_0 = 8.6560e-04
Validation rmse Energy = 1.108343
Validation R2 Energy = 0.900871
Epoch 7
Train function
Validation rmse Energy = 1.203545
Validation R2 Energy = 0.883110
Epoch 8
Train function
Loss = 9.3197e-04, PNorm = 56.0694, GNorm = 0.8132, lr_0 = 8.3422e-04
Validation rmse Energy = 1.331232
Validation R2 Energy = 0.856992
Epoch 9
Train function
Loss = 1.0597e-03, PNorm = 56.0984, GNorm = 1.2011, lr_0 = 8.0398e-04
Validation rmse Energy = 1.085135
Validation R2 Energy = 0.904979
Epoch 10
Train function
Validation rmse Energy = 1.055593
Validation R2 Energy = 0.910082
Epoch 11
Train function
Loss = 9.0092e-04, PNorm = 56.1328, GNorm = 0.9519, lr_0 = 7.7484e-04
Validation rmse Energy = 1.037446
Validation R2 Energy = 0.913147
Epoch 12
Train function
Loss = 7.3308e-04, PNorm = 56.1591, GNorm = 0.9245, lr_0 = 7.4675e-04
Validation rmse Energy = 1.148148
Validation R2 Energy = 0.893623
Epoch 13
Train function
Loss = 1.0539e-03, PNorm = 56.1898, GNorm = 2.0479, lr_0 = 7.1969e-04
Loss = 1.1736e-02, PNorm = 56.1917, GNorm = 4.1735, lr_0 = 7.1727e-04
Validation rmse Energy = 1.004111
Validation R2 Energy = 0.918639
Epoch 14
Train function
Validation rmse Energy = 1.191432
Validation R2 Energy = 0.885451
Epoch 15
Train function
Loss = 1.2291e-03, PNorm = 56.2166, GNorm = 2.2713, lr_0 = 6.9360e-04
Validation rmse Energy = 1.073919
Validation R2 Energy = 0.906933
Epoch 16
Train function
Loss = 5.8971e-04, PNorm = 56.2447, GNorm = 1.6149, lr_0 = 6.6846e-04
Validation rmse Energy = 0.985587
Validation R2 Energy = 0.921613
Epoch 17
Train function
Validation rmse Energy = 0.932751
Validation R2 Energy = 0.929793
Epoch 18
Train function
Loss = 4.1767e-04, PNorm = 56.2741, GNorm = 0.5677, lr_0 = 6.4207e-04
Validation rmse Energy = 0.988647
Validation R2 Energy = 0.921126
Epoch 19
Train function
Loss = 4.2046e-04, PNorm = 56.2947, GNorm = 0.5713, lr_0 = 6.1879e-04
Validation rmse Energy = 0.910687
Validation R2 Energy = 0.933075
Epoch 20
Train function
Loss = 3.7815e-04, PNorm = 56.3111, GNorm = 0.6189, lr_0 = 5.9837e-04
Validation rmse Energy = 0.952929
Validation R2 Energy = 0.926722
Epoch 21
Train function
Validation rmse Energy = 0.938213
Validation R2 Energy = 0.928968
Epoch 22
Train function
Loss = 2.3622e-04, PNorm = 56.3293, GNorm = 0.3946, lr_0 = 5.7475e-04
Validation rmse Energy = 0.939957
Validation R2 Energy = 0.928704
Epoch 23
Train function
Loss = 2.7953e-04, PNorm = 56.3446, GNorm = 0.5961, lr_0 = 5.5391e-04
Validation rmse Energy = 0.911709
Validation R2 Energy = 0.932925
Epoch 24
Train function
Loss = 2.9066e-04, PNorm = 56.3573, GNorm = 0.9796, lr_0 = 5.3383e-04
Validation rmse Energy = 0.900955
Validation R2 Energy = 0.934497
Epoch 25
Train function
Validation rmse Energy = 0.870978
Validation R2 Energy = 0.938784
Epoch 26
Train function
Loss = 3.6453e-04, PNorm = 56.3745, GNorm = 0.2206, lr_0 = 5.1448e-04
Validation rmse Energy = 0.954628
Validation R2 Energy = 0.926461
Epoch 27
Train function
Loss = 2.9247e-04, PNorm = 56.3873, GNorm = 0.5516, lr_0 = 4.9583e-04
Validation rmse Energy = 0.930140
Validation R2 Energy = 0.930185
Epoch 28
Train function
Validation rmse Energy = 0.876260
Validation R2 Energy = 0.938039
Epoch 29
Train function
Loss = 2.5964e-04, PNorm = 56.3990, GNorm = 1.2545, lr_0 = 4.7626e-04
Validation rmse Energy = 0.915201
Validation R2 Energy = 0.932410
Epoch 30
Train function
Loss = 1.6362e-04, PNorm = 56.4103, GNorm = 0.4750, lr_0 = 4.6054e-04
Validation rmse Energy = 0.883377
Validation R2 Energy = 0.937029
Epoch 31
Train function
Loss = 1.6042e-04, PNorm = 56.4170, GNorm = 0.3745, lr_0 = 4.4384e-04
Loss = 3.4446e-04, PNorm = 56.4183, GNorm = 0.3116, lr_0 = 4.4236e-04
Validation rmse Energy = 0.883901
Validation R2 Energy = 0.936954
Epoch 32
Train function
Validation rmse Energy = 0.879597
Validation R2 Energy = 0.937566
Epoch 33
Train function
Loss = 1.0959e-04, PNorm = 56.4292, GNorm = 0.2206, lr_0 = 4.2632e-04
Validation rmse Energy = 0.890791
Validation R2 Energy = 0.935967
Epoch 34
Train function
Loss = 1.5933e-04, PNorm = 56.4399, GNorm = 0.5625, lr_0 = 4.1087e-04
Validation rmse Energy = 0.869171
Validation R2 Energy = 0.939038
Epoch 35
Train function
Validation rmse Energy = 0.897700
Validation R2 Energy = 0.934970
Epoch 36
Train function
Loss = 2.0198e-04, PNorm = 56.4485, GNorm = 1.1010, lr_0 = 3.9597e-04
Validation rmse Energy = 0.859936
Validation R2 Energy = 0.940326
Epoch 37
Train function
Loss = 1.1717e-04, PNorm = 56.4574, GNorm = 0.2019, lr_0 = 3.8162e-04
Validation rmse Energy = 0.915883
Validation R2 Energy = 0.932309
Epoch 38
Train function
Loss = 2.0734e-04, PNorm = 56.4692, GNorm = 0.4328, lr_0 = 3.6779e-04
Loss = 1.3768e-03, PNorm = 56.4696, GNorm = 1.0345, lr_0 = 3.6656e-04
Validation rmse Energy = 0.944606
Validation R2 Energy = 0.927997
Epoch 39
Train function
Validation rmse Energy = 0.911822
Validation R2 Energy = 0.932908
Epoch 40
Train function
Loss = 1.1549e-04, PNorm = 56.4729, GNorm = 0.1703, lr_0 = 3.5446e-04
Validation rmse Energy = 0.885759
Validation R2 Energy = 0.936688
Epoch 41
Train function
Loss = 1.0384e-04, PNorm = 56.4847, GNorm = 0.3944, lr_0 = 3.4161e-04
Validation rmse Energy = 0.940114
Validation R2 Energy = 0.928680
Epoch 42
Train function
Validation rmse Energy = 0.875665
Validation R2 Energy = 0.938123
Epoch 43
Train function
Loss = 8.3818e-05, PNorm = 56.4904, GNorm = 0.3262, lr_0 = 3.2812e-04
Validation rmse Energy = 0.874481
Validation R2 Energy = 0.938290
Epoch 44
Train function
Loss = 1.0160e-04, PNorm = 56.4984, GNorm = 0.6491, lr_0 = 3.1623e-04
Validation rmse Energy = 0.880231
Validation R2 Energy = 0.937476
Epoch 45
Train function
Loss = 7.7568e-05, PNorm = 56.5043, GNorm = 0.4046, lr_0 = 3.0579e-04
Validation rmse Energy = 0.869718
Validation R2 Energy = 0.938961
Epoch 46
Train function
Validation rmse Energy = 0.867209
Validation R2 Energy = 0.939313
Epoch 47
Train function
Loss = 5.8262e-05, PNorm = 56.5106, GNorm = 0.3715, lr_0 = 2.9372e-04
Validation rmse Energy = 0.872002
Validation R2 Energy = 0.938640
Epoch 48
Train function
Loss = 5.3850e-05, PNorm = 56.5158, GNorm = 0.1896, lr_0 = 2.8307e-04
Validation rmse Energy = 0.873937
Validation R2 Energy = 0.938367
Epoch 49
Train function
Loss = 9.0262e-05, PNorm = 56.5215, GNorm = 1.0020, lr_0 = 2.7281e-04
Validation rmse Energy = 0.861966
Validation R2 Energy = 0.940044
Epoch 50
Train function
Validation rmse Energy = 0.866963
Validation R2 Energy = 0.939347
Epoch 51
Train function
Loss = 5.7004e-05, PNorm = 56.5269, GNorm = 0.3830, lr_0 = 2.6292e-04
Validation rmse Energy = 0.870157
Validation R2 Energy = 0.938899
Epoch 52
Train function
Loss = 5.6070e-05, PNorm = 56.5318, GNorm = 0.4297, lr_0 = 2.5339e-04
Validation rmse Energy = 0.868959
Validation R2 Energy = 0.939067
Epoch 53
Train function
Validation rmse Energy = 0.862644
Validation R2 Energy = 0.939950
Epoch 54
Train function
Loss = 7.1628e-05, PNorm = 56.5372, GNorm = 0.1330, lr_0 = 2.4339e-04
Validation rmse Energy = 0.859870
Validation R2 Energy = 0.940335
Epoch 55
Train function
Loss = 5.9114e-05, PNorm = 56.5408, GNorm = 0.4801, lr_0 = 2.3535e-04
Validation rmse Energy = 0.862430
Validation R2 Energy = 0.939980
Epoch 56
Train function
Loss = 6.2109e-05, PNorm = 56.5448, GNorm = 0.4831, lr_0 = 2.2682e-04
Loss = 1.3682e-04, PNorm = 56.5451, GNorm = 0.2620, lr_0 = 2.2606e-04
Validation rmse Energy = 0.856400
Validation R2 Energy = 0.940816
Epoch 57
Train function
Validation rmse Energy = 0.856695
Validation R2 Energy = 0.940775
Epoch 58
Train function
Loss = 4.5608e-05, PNorm = 56.5492, GNorm = 0.2130, lr_0 = 2.1787e-04
Validation rmse Energy = 0.862572
Validation R2 Energy = 0.939960
Epoch 59
Train function
Loss = 3.8900e-05, PNorm = 56.5528, GNorm = 0.1892, lr_0 = 2.0997e-04
Validation rmse Energy = 0.874234
Validation R2 Energy = 0.938325
Epoch 60
Train function
Validation rmse Energy = 0.865986
Validation R2 Energy = 0.939484
Epoch 61
Train function
Loss = 3.2357e-05, PNorm = 56.5565, GNorm = 0.3732, lr_0 = 2.0236e-04
Validation rmse Energy = 0.863208
Validation R2 Energy = 0.939871
Epoch 62
Train function
Loss = 3.1568e-05, PNorm = 56.5603, GNorm = 0.1166, lr_0 = 1.9502e-04
Validation rmse Energy = 0.865507
Validation R2 Energy = 0.939551
Epoch 63
Train function
Loss = 4.0791e-05, PNorm = 56.5634, GNorm = 0.3467, lr_0 = 1.8795e-04
Loss = 1.3022e-04, PNorm = 56.5638, GNorm = 0.1253, lr_0 = 1.8732e-04
Validation rmse Energy = 0.857020
Validation R2 Energy = 0.940730
Epoch 64
Train function
Validation rmse Energy = 0.865435
Validation R2 Energy = 0.939561
Epoch 65
Train function
Loss = 4.2419e-05, PNorm = 56.5665, GNorm = 0.1284, lr_0 = 1.8114e-04
Validation rmse Energy = 0.849017
Validation R2 Energy = 0.941832
Epoch 66
Train function
Loss = 2.9489e-05, PNorm = 56.5692, GNorm = 0.2327, lr_0 = 1.7458e-04
Validation rmse Energy = 0.858156
Validation R2 Energy = 0.940573
Epoch 67
Train function
Validation rmse Energy = 0.850940
Validation R2 Energy = 0.941568
Epoch 68
Train function
Loss = 2.3722e-05, PNorm = 56.5724, GNorm = 0.1760, lr_0 = 1.6768e-04
Validation rmse Energy = 0.861077
Validation R2 Energy = 0.940168
Epoch 69
Train function
Loss = 3.4686e-05, PNorm = 56.5748, GNorm = 0.0819, lr_0 = 1.6161e-04
Validation rmse Energy = 0.851381
Validation R2 Energy = 0.941508
Epoch 70
Train function
Loss = 3.0508e-05, PNorm = 56.5767, GNorm = 0.2335, lr_0 = 1.5627e-04
Validation rmse Energy = 0.846287
Validation R2 Energy = 0.942206
Epoch 71
Train function
Validation rmse Energy = 0.854245
Validation R2 Energy = 0.941113
Epoch 72
Train function
Loss = 2.7656e-05, PNorm = 56.5797, GNorm = 0.2637, lr_0 = 1.5010e-04
Validation rmse Energy = 0.844328
Validation R2 Energy = 0.942473
Epoch 73
Train function
Loss = 2.6111e-05, PNorm = 56.5817, GNorm = 0.1906, lr_0 = 1.4466e-04
Validation rmse Energy = 0.857491
Validation R2 Energy = 0.940665
Epoch 74
Train function
Loss = 2.7129e-05, PNorm = 56.5838, GNorm = 0.3662, lr_0 = 1.3942e-04
Validation rmse Energy = 0.848899
Validation R2 Energy = 0.941848
Epoch 75
Train function
Validation rmse Energy = 0.847385
Validation R2 Energy = 0.942055
Epoch 76
Train function
Loss = 1.5778e-05, PNorm = 56.5858, GNorm = 0.0590, lr_0 = 1.3436e-04
Validation rmse Energy = 0.850563
Validation R2 Energy = 0.941620
Epoch 77
Train function
Loss = 2.1856e-05, PNorm = 56.5877, GNorm = 0.0688, lr_0 = 1.2949e-04
Validation rmse Energy = 0.848826
Validation R2 Energy = 0.941858
Epoch 78
Train function
Validation rmse Energy = 0.845507
Validation R2 Energy = 0.942312
Epoch 79
Train function
Loss = 1.7171e-05, PNorm = 56.5897, GNorm = 0.0546, lr_0 = 1.2438e-04
Validation rmse Energy = 0.852832
Validation R2 Energy = 0.941308
Epoch 80
Train function
Loss = 1.9205e-05, PNorm = 56.5914, GNorm = 0.0559, lr_0 = 1.2027e-04
Validation rmse Energy = 0.854479
Validation R2 Energy = 0.941081
Epoch 81
Train function
Loss = 1.9729e-05, PNorm = 56.5928, GNorm = 0.2100, lr_0 = 1.1592e-04
Loss = 2.3947e-04, PNorm = 56.5929, GNorm = 0.2808, lr_0 = 1.1553e-04
Validation rmse Energy = 0.852191
Validation R2 Energy = 0.941396
Epoch 82
Train function
Validation rmse Energy = 0.848053
Validation R2 Energy = 0.941964
Epoch 83
Train function
Loss = 2.0476e-05, PNorm = 56.5945, GNorm = 0.0632, lr_0 = 1.1134e-04
Validation rmse Energy = 0.848239
Validation R2 Energy = 0.941939
Epoch 84
Train function
Loss = 1.7043e-05, PNorm = 56.5960, GNorm = 0.1282, lr_0 = 1.0730e-04
Validation rmse Energy = 0.854937
Validation R2 Energy = 0.941018
Epoch 85
Train function
Validation rmse Energy = 0.851769
Validation R2 Energy = 0.941454
Epoch 86
Train function
Loss = 1.7121e-05, PNorm = 56.5977, GNorm = 0.1901, lr_0 = 1.0341e-04
Validation rmse Energy = 0.848911
Validation R2 Energy = 0.941847
Epoch 87
Train function
Loss = 1.9422e-05, PNorm = 56.5989, GNorm = 0.0593, lr_0 = 1.0000e-04
Validation rmse Energy = 0.855127
Validation R2 Energy = 0.940992
Epoch 88
Train function
Loss = 1.7698e-05, PNorm = 56.6004, GNorm = 0.1004, lr_0 = 1.0000e-04
Loss = 1.9284e-04, PNorm = 56.6005, GNorm = 0.2634, lr_0 = 1.0000e-04
Validation rmse Energy = 0.847419
Validation R2 Energy = 0.942051
Epoch 89
Train function
Validation rmse Energy = 0.852972
Validation R2 Energy = 0.941289
Epoch 90
Train function
Loss = 2.1581e-05, PNorm = 56.6015, GNorm = 0.0555, lr_0 = 1.0000e-04
Validation rmse Energy = 0.848817
Validation R2 Energy = 0.941859
Epoch 91
Train function
Loss = 1.2164e-05, PNorm = 56.6029, GNorm = 0.0797, lr_0 = 1.0000e-04
Validation rmse Energy = 0.850119
Validation R2 Energy = 0.941681
Epoch 92
Train function
Validation rmse Energy = 0.853284
Validation R2 Energy = 0.941246
Epoch 93
Train function
Loss = 1.7561e-05, PNorm = 56.6048, GNorm = 0.0894, lr_0 = 1.0000e-04
Validation rmse Energy = 0.852740
Validation R2 Energy = 0.941321
Epoch 94
Train function
Loss = 1.8457e-05, PNorm = 56.6060, GNorm = 0.0574, lr_0 = 1.0000e-04
Validation rmse Energy = 0.853672
Validation R2 Energy = 0.941192
Epoch 95
Train function
Loss = 1.5391e-05, PNorm = 56.6073, GNorm = 0.0472, lr_0 = 1.0000e-04
Validation rmse Energy = 0.844448
Validation R2 Energy = 0.942456
Epoch 96
Train function
Validation rmse Energy = 0.853321
Validation R2 Energy = 0.941241
Epoch 97
Train function
Loss = 1.5736e-05, PNorm = 56.6087, GNorm = 0.0672, lr_0 = 1.0000e-04
Validation rmse Energy = 0.847776
Validation R2 Energy = 0.942002
Epoch 98
Train function
Loss = 1.7447e-05, PNorm = 56.6098, GNorm = 0.0515, lr_0 = 1.0000e-04
Validation rmse Energy = 0.845857
Validation R2 Energy = 0.942264
Epoch 99
Train function
Loss = 1.6064e-05, PNorm = 56.6115, GNorm = 0.0876, lr_0 = 1.0000e-04
Validation rmse Energy = 0.847491
Validation R2 Energy = 0.942041
Model 0 best validation rmse = 0.844328 on epoch 72
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "substructures_encoder.encoder.cached_zero_vector".
Loading pretrained parameter "substructures_encoder.encoder.W_o.weight".
Loading pretrained parameter "substructures_encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.121221
Model 0 test R2 Energy = 0.924791
Ensemble test rmse  Energy= 1.121221
Ensemble test R2  Energy= 0.924791
Fold 2
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': True,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_wo_fragments_and_counts'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 95,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_309/folds/fold_2',
 'save_smiles_splits': False,
 'seed': 2,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 360,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 2
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (substructures_encoder): SubstructureLayer(
    (encoder): SubstructureEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_o): Linear(in_features=165, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=1195, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,512,201
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 2.773985
Validation R2 Energy = 0.285283
Epoch 1
Train function
Loss = 1.0210e-02, PNorm = 55.6031, GNorm = 4.4239, lr_0 = 8.7143e-04
Validation rmse Energy = 2.093973
Validation R2 Energy = 0.592744
Epoch 2
Train function
Loss = 6.0109e-03, PNorm = 55.7342, GNorm = 2.3397, lr_0 = 9.7024e-04
Validation rmse Energy = 1.898476
Validation R2 Energy = 0.665238
Epoch 3
Train function
Validation rmse Energy = 2.085268
Validation R2 Energy = 0.596122
Epoch 4
Train function
Loss = 3.4231e-03, PNorm = 55.8511, GNorm = 2.1497, lr_0 = 9.3194e-04
Validation rmse Energy = 1.694134
Validation R2 Energy = 0.733424
Epoch 5
Train function
Loss = 2.4339e-03, PNorm = 55.9083, GNorm = 3.3953, lr_0 = 9.0118e-04
Validation rmse Energy = 1.778330
Validation R2 Energy = 0.706269
Epoch 6
Train function
Loss = 1.7851e-03, PNorm = 55.9663, GNorm = 0.9121, lr_0 = 8.6851e-04
Loss = 8.7530e-03, PNorm = 55.9715, GNorm = 1.4851, lr_0 = 8.6560e-04
Validation rmse Energy = 1.608527
Validation R2 Energy = 0.759684
Epoch 7
Train function
Validation rmse Energy = 1.412987
Validation R2 Energy = 0.814561
Epoch 8
Train function
Loss = 1.1958e-03, PNorm = 56.0139, GNorm = 0.9086, lr_0 = 8.3422e-04
Validation rmse Energy = 1.342098
Validation R2 Energy = 0.832701
Epoch 9
Train function
Loss = 9.3179e-04, PNorm = 56.0522, GNorm = 0.5494, lr_0 = 8.0398e-04
Validation rmse Energy = 1.419992
Validation R2 Energy = 0.812717
Epoch 10
Train function
Validation rmse Energy = 1.219129
Validation R2 Energy = 0.861954
Epoch 11
Train function
Loss = 7.8380e-04, PNorm = 56.0937, GNorm = 1.2113, lr_0 = 7.7484e-04
Validation rmse Energy = 1.217876
Validation R2 Energy = 0.862237
Epoch 12
Train function
Loss = 7.2348e-04, PNorm = 56.1248, GNorm = 0.6561, lr_0 = 7.4675e-04
Validation rmse Energy = 1.194988
Validation R2 Energy = 0.867367
Epoch 13
Train function
Loss = 6.6277e-04, PNorm = 56.1477, GNorm = 0.3385, lr_0 = 7.1969e-04
Loss = 6.3777e-03, PNorm = 56.1501, GNorm = 2.1987, lr_0 = 7.1727e-04
Validation rmse Energy = 1.159351
Validation R2 Energy = 0.875159
Epoch 14
Train function
Validation rmse Energy = 1.176277
Validation R2 Energy = 0.871488
Epoch 15
Train function
Loss = 6.2538e-04, PNorm = 56.1714, GNorm = 0.8121, lr_0 = 6.9360e-04
Validation rmse Energy = 1.283928
Validation R2 Energy = 0.846889
Epoch 16
Train function
Loss = 6.2525e-04, PNorm = 56.1927, GNorm = 1.6444, lr_0 = 6.6846e-04
Validation rmse Energy = 1.176139
Validation R2 Energy = 0.871518
Epoch 17
Train function
Validation rmse Energy = 1.115134
Validation R2 Energy = 0.884500
Epoch 18
Train function
Loss = 5.4288e-04, PNorm = 56.2188, GNorm = 1.3983, lr_0 = 6.4207e-04
Validation rmse Energy = 1.112097
Validation R2 Energy = 0.885129
Epoch 19
Train function
Loss = 4.5924e-04, PNorm = 56.2399, GNorm = 1.1188, lr_0 = 6.1879e-04
Validation rmse Energy = 1.120410
Validation R2 Energy = 0.883405
Epoch 20
Train function
Loss = 2.9653e-04, PNorm = 56.2578, GNorm = 0.2431, lr_0 = 5.9837e-04
Validation rmse Energy = 1.196975
Validation R2 Energy = 0.866925
Epoch 21
Train function
Validation rmse Energy = 1.138471
Validation R2 Energy = 0.879616
Epoch 22
Train function
Loss = 2.3480e-04, PNorm = 56.2763, GNorm = 0.1799, lr_0 = 5.7475e-04
Validation rmse Energy = 1.110368
Validation R2 Energy = 0.885486
Epoch 23
Train function
Loss = 2.2660e-04, PNorm = 56.2966, GNorm = 0.6317, lr_0 = 5.5391e-04
Validation rmse Energy = 1.057401
Validation R2 Energy = 0.896150
Epoch 24
Train function
Loss = 2.3944e-04, PNorm = 56.3111, GNorm = 0.3128, lr_0 = 5.3383e-04
Validation rmse Energy = 1.151494
Validation R2 Energy = 0.876846
Epoch 25
Train function
Validation rmse Energy = 1.044003
Validation R2 Energy = 0.898765
Epoch 26
Train function
Loss = 1.8455e-04, PNorm = 56.3294, GNorm = 0.2958, lr_0 = 5.1448e-04
Validation rmse Energy = 1.058121
Validation R2 Energy = 0.896009
Epoch 27
Train function
Loss = 3.5608e-04, PNorm = 56.3379, GNorm = 0.4697, lr_0 = 4.9583e-04
Validation rmse Energy = 1.029410
Validation R2 Energy = 0.901576
Epoch 28
Train function
Validation rmse Energy = 1.048765
Validation R2 Energy = 0.897840
Epoch 29
Train function
Loss = 1.1713e-04, PNorm = 56.3560, GNorm = 0.2974, lr_0 = 4.7626e-04
Validation rmse Energy = 1.069599
Validation R2 Energy = 0.893740
Epoch 30
Train function
Loss = 1.6727e-04, PNorm = 56.3627, GNorm = 0.3067, lr_0 = 4.6054e-04
Validation rmse Energy = 1.054267
Validation R2 Energy = 0.896765
Epoch 31
Train function
Loss = 1.5354e-04, PNorm = 56.3781, GNorm = 0.3287, lr_0 = 4.4384e-04
Loss = 1.7292e-04, PNorm = 56.3793, GNorm = 0.2223, lr_0 = 4.4236e-04
Validation rmse Energy = 1.037344
Validation R2 Energy = 0.900053
Epoch 32
Train function
Validation rmse Energy = 1.042662
Validation R2 Energy = 0.899025
Epoch 33
Train function
Loss = 1.3811e-04, PNorm = 56.3871, GNorm = 0.5415, lr_0 = 4.2632e-04
Validation rmse Energy = 1.043276
Validation R2 Energy = 0.898906
Epoch 34
Train function
Loss = 7.8534e-05, PNorm = 56.3977, GNorm = 0.2956, lr_0 = 4.1087e-04
Validation rmse Energy = 1.013943
Validation R2 Energy = 0.904511
Epoch 35
Train function
Validation rmse Energy = 1.015227
Validation R2 Energy = 0.904269
Epoch 36
Train function
Loss = 7.9901e-05, PNorm = 56.4073, GNorm = 0.2894, lr_0 = 3.9597e-04
Validation rmse Energy = 1.048697
Validation R2 Energy = 0.897853
Epoch 37
Train function
Loss = 1.2897e-04, PNorm = 56.4125, GNorm = 0.5230, lr_0 = 3.8162e-04
Validation rmse Energy = 1.025765
Validation R2 Energy = 0.902271
Epoch 38
Train function
Loss = 1.0339e-04, PNorm = 56.4236, GNorm = 0.1593, lr_0 = 3.6779e-04
Loss = 7.3318e-05, PNorm = 56.4245, GNorm = 0.0912, lr_0 = 3.6656e-04
Validation rmse Energy = 1.051648
Validation R2 Energy = 0.897277
Epoch 39
Train function
Validation rmse Energy = 1.013223
Validation R2 Energy = 0.904647
Epoch 40
Train function
Loss = 6.6830e-05, PNorm = 56.4301, GNorm = 0.3245, lr_0 = 3.5446e-04
Validation rmse Energy = 1.016388
Validation R2 Energy = 0.904050
Epoch 41
Train function
Loss = 5.4177e-05, PNorm = 56.4373, GNorm = 0.3528, lr_0 = 3.4161e-04
Validation rmse Energy = 1.030930
Validation R2 Energy = 0.901285
Epoch 42
Train function
Validation rmse Energy = 1.038159
Validation R2 Energy = 0.899896
Epoch 43
Train function
Loss = 1.1120e-04, PNorm = 56.4422, GNorm = 0.6739, lr_0 = 3.2812e-04
Validation rmse Energy = 1.046374
Validation R2 Energy = 0.898305
Epoch 44
Train function
Loss = 4.6067e-05, PNorm = 56.4478, GNorm = 0.3840, lr_0 = 3.1623e-04
Validation rmse Energy = 1.024295
Validation R2 Energy = 0.902551
Epoch 45
Train function
Loss = 5.6772e-05, PNorm = 56.4515, GNorm = 0.1412, lr_0 = 3.0579e-04
Validation rmse Energy = 1.034041
Validation R2 Energy = 0.900688
Epoch 46
Train function
Validation rmse Energy = 1.025538
Validation R2 Energy = 0.902315
Epoch 47
Train function
Loss = 3.6632e-05, PNorm = 56.4580, GNorm = 0.1824, lr_0 = 2.9372e-04
Validation rmse Energy = 1.001548
Validation R2 Energy = 0.906831
Epoch 48
Train function
Loss = 3.8664e-05, PNorm = 56.4628, GNorm = 0.1853, lr_0 = 2.8307e-04
Validation rmse Energy = 1.024354
Validation R2 Energy = 0.902540
Epoch 49
Train function
Loss = 3.9439e-05, PNorm = 56.4674, GNorm = 0.4080, lr_0 = 2.7281e-04
Validation rmse Energy = 1.019100
Validation R2 Energy = 0.903537
Epoch 50
Train function
Validation rmse Energy = 1.008704
Validation R2 Energy = 0.905495
Epoch 51
Train function
Loss = 2.7373e-05, PNorm = 56.4707, GNorm = 0.0885, lr_0 = 2.6292e-04
Validation rmse Energy = 1.027313
Validation R2 Energy = 0.901976
Epoch 52
Train function
Loss = 2.6408e-05, PNorm = 56.4741, GNorm = 0.0936, lr_0 = 2.5339e-04
Validation rmse Energy = 1.025623
Validation R2 Energy = 0.902298
Epoch 53
Train function
Validation rmse Energy = 1.019185
Validation R2 Energy = 0.903521
Epoch 54
Train function
Loss = 2.2042e-05, PNorm = 56.4776, GNorm = 0.1965, lr_0 = 2.4339e-04
Validation rmse Energy = 1.025380
Validation R2 Energy = 0.902345
Epoch 55
Train function
Loss = 2.7001e-05, PNorm = 56.4798, GNorm = 0.0879, lr_0 = 2.3535e-04
Validation rmse Energy = 1.026063
Validation R2 Energy = 0.902215
Epoch 56
Train function
Loss = 2.3820e-05, PNorm = 56.4823, GNorm = 0.0474, lr_0 = 2.2682e-04
Loss = 3.9502e-05, PNorm = 56.4826, GNorm = 0.0933, lr_0 = 2.2606e-04
Validation rmse Energy = 1.017881
Validation R2 Energy = 0.903768
Epoch 57
Train function
Validation rmse Energy = 1.018125
Validation R2 Energy = 0.903722
Epoch 58
Train function
Loss = 1.9355e-05, PNorm = 56.4855, GNorm = 0.0884, lr_0 = 2.1787e-04
Validation rmse Energy = 1.024048
Validation R2 Energy = 0.902598
Epoch 59
Train function
Loss = 2.0350e-05, PNorm = 56.4877, GNorm = 0.0489, lr_0 = 2.0997e-04
Validation rmse Energy = 1.014345
Validation R2 Energy = 0.904435
Epoch 60
Train function
Validation rmse Energy = 1.017074
Validation R2 Energy = 0.903921
Epoch 61
Train function
Loss = 3.5315e-05, PNorm = 56.4916, GNorm = 0.0879, lr_0 = 2.0236e-04
Validation rmse Energy = 1.020346
Validation R2 Energy = 0.903301
Epoch 62
Train function
Loss = 1.9606e-05, PNorm = 56.4934, GNorm = 0.0448, lr_0 = 1.9502e-04
Validation rmse Energy = 1.026686
Validation R2 Energy = 0.902096
Epoch 63
Train function
Loss = 2.9442e-05, PNorm = 56.4957, GNorm = 0.1623, lr_0 = 1.8795e-04
Loss = 1.5460e-04, PNorm = 56.4959, GNorm = 0.2374, lr_0 = 1.8732e-04
Validation rmse Energy = 1.027529
Validation R2 Energy = 0.901935
Epoch 64
Train function
Validation rmse Energy = 1.021164
Validation R2 Energy = 0.903146
Epoch 65
Train function
Loss = 2.1818e-05, PNorm = 56.4974, GNorm = 0.3011, lr_0 = 1.8114e-04
Validation rmse Energy = 1.030902
Validation R2 Energy = 0.901290
Epoch 66
Train function
Loss = 2.2319e-05, PNorm = 56.4997, GNorm = 0.1996, lr_0 = 1.7458e-04
Validation rmse Energy = 1.030491
Validation R2 Energy = 0.901369
Epoch 67
Train function
Validation rmse Energy = 1.019877
Validation R2 Energy = 0.903390
Epoch 68
Train function
Loss = 1.1255e-05, PNorm = 56.5015, GNorm = 0.0630, lr_0 = 1.6768e-04
Validation rmse Energy = 1.020426
Validation R2 Energy = 0.903286
Epoch 69
Train function
Loss = 1.7328e-05, PNorm = 56.5031, GNorm = 0.1053, lr_0 = 1.6161e-04
Validation rmse Energy = 1.016177
Validation R2 Energy = 0.904090
Epoch 70
Train function
Loss = 1.6512e-05, PNorm = 56.5047, GNorm = 0.0711, lr_0 = 1.5627e-04
Validation rmse Energy = 1.019573
Validation R2 Energy = 0.903448
Epoch 71
Train function
Validation rmse Energy = 1.013615
Validation R2 Energy = 0.904573
Epoch 72
Train function
Loss = 1.1623e-05, PNorm = 56.5063, GNorm = 0.1272, lr_0 = 1.5010e-04
Validation rmse Energy = 1.020327
Validation R2 Energy = 0.903305
Epoch 73
Train function
Loss = 1.6157e-05, PNorm = 56.5076, GNorm = 0.0559, lr_0 = 1.4466e-04
Validation rmse Energy = 1.014335
Validation R2 Energy = 0.904437
Epoch 74
Train function
Loss = 1.6431e-05, PNorm = 56.5089, GNorm = 0.1863, lr_0 = 1.3942e-04
Validation rmse Energy = 1.024926
Validation R2 Energy = 0.902431
Epoch 75
Train function
Validation rmse Energy = 1.018211
Validation R2 Energy = 0.903705
Epoch 76
Train function
Loss = 1.5934e-05, PNorm = 56.5104, GNorm = 0.0925, lr_0 = 1.3436e-04
Validation rmse Energy = 1.012569
Validation R2 Energy = 0.904770
Epoch 77
Train function
Loss = 1.6718e-05, PNorm = 56.5119, GNorm = 0.0763, lr_0 = 1.2949e-04
Validation rmse Energy = 1.014918
Validation R2 Energy = 0.904327
Epoch 78
Train function
Validation rmse Energy = 1.012025
Validation R2 Energy = 0.904872
Epoch 79
Train function
Loss = 1.2563e-05, PNorm = 56.5131, GNorm = 0.1023, lr_0 = 1.2438e-04
Validation rmse Energy = 1.025127
Validation R2 Energy = 0.902393
Epoch 80
Train function
Loss = 1.6842e-05, PNorm = 56.5143, GNorm = 0.1692, lr_0 = 1.2027e-04
Validation rmse Energy = 1.022815
Validation R2 Energy = 0.902833
Epoch 81
Train function
Loss = 1.2457e-05, PNorm = 56.5156, GNorm = 0.0476, lr_0 = 1.1592e-04
Loss = 6.5884e-05, PNorm = 56.5157, GNorm = 0.0795, lr_0 = 1.1553e-04
Validation rmse Energy = 1.024945
Validation R2 Energy = 0.902428
Epoch 82
Train function
Validation rmse Energy = 1.015457
Validation R2 Energy = 0.904226
Epoch 83
Train function
Loss = 1.3806e-05, PNorm = 56.5167, GNorm = 0.0653, lr_0 = 1.1134e-04
Validation rmse Energy = 1.015791
Validation R2 Energy = 0.904163
Epoch 84
Train function
Loss = 1.2971e-05, PNorm = 56.5177, GNorm = 0.1456, lr_0 = 1.0730e-04
Validation rmse Energy = 1.014906
Validation R2 Energy = 0.904330
Epoch 85
Train function
Validation rmse Energy = 1.019942
Validation R2 Energy = 0.903378
Epoch 86
Train function
Loss = 1.1160e-05, PNorm = 56.5187, GNorm = 0.0398, lr_0 = 1.0341e-04
Validation rmse Energy = 1.021775
Validation R2 Energy = 0.903030
Epoch 87
Train function
Loss = 1.0574e-05, PNorm = 56.5196, GNorm = 0.0503, lr_0 = 1.0000e-04
Validation rmse Energy = 1.018894
Validation R2 Energy = 0.903576
Epoch 88
Train function
Loss = 1.1465e-05, PNorm = 56.5206, GNorm = 0.0919, lr_0 = 1.0000e-04
Loss = 2.8666e-05, PNorm = 56.5207, GNorm = 0.0858, lr_0 = 1.0000e-04
Validation rmse Energy = 1.015913
Validation R2 Energy = 0.904140
Epoch 89
Train function
Validation rmse Energy = 1.014724
Validation R2 Energy = 0.904364
Epoch 90
Train function
Loss = 1.0909e-05, PNorm = 56.5214, GNorm = 0.0879, lr_0 = 1.0000e-04
Validation rmse Energy = 1.013398
Validation R2 Energy = 0.904614
Epoch 91
Train function
Loss = 1.0435e-05, PNorm = 56.5221, GNorm = 0.0584, lr_0 = 1.0000e-04
Validation rmse Energy = 1.015884
Validation R2 Energy = 0.904145
Epoch 92
Train function
Validation rmse Energy = 1.013931
Validation R2 Energy = 0.904513
Epoch 93
Train function
Loss = 5.7131e-06, PNorm = 56.5230, GNorm = 0.0781, lr_0 = 1.0000e-04
Validation rmse Energy = 1.017549
Validation R2 Energy = 0.903831
Epoch 94
Train function
Loss = 1.3423e-05, PNorm = 56.5239, GNorm = 0.0371, lr_0 = 1.0000e-04
Validation rmse Energy = 1.014849
Validation R2 Energy = 0.904340
Epoch 95
Train function
Loss = 1.0645e-05, PNorm = 56.5247, GNorm = 0.0566, lr_0 = 1.0000e-04
Validation rmse Energy = 1.020482
Validation R2 Energy = 0.903276
Epoch 96
Train function
Validation rmse Energy = 1.015780
Validation R2 Energy = 0.904165
Epoch 97
Train function
Loss = 4.8087e-06, PNorm = 56.5257, GNorm = 0.0361, lr_0 = 1.0000e-04
Validation rmse Energy = 1.013177
Validation R2 Energy = 0.904655
Epoch 98
Train function
Loss = 7.4731e-06, PNorm = 56.5265, GNorm = 0.0828, lr_0 = 1.0000e-04
Validation rmse Energy = 1.016860
Validation R2 Energy = 0.903961
Epoch 99
Train function
Loss = 1.0241e-05, PNorm = 56.5272, GNorm = 0.1089, lr_0 = 1.0000e-04
Validation rmse Energy = 1.014290
Validation R2 Energy = 0.904446
Model 0 best validation rmse = 1.001548 on epoch 47
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "substructures_encoder.encoder.cached_zero_vector".
Loading pretrained parameter "substructures_encoder.encoder.W_o.weight".
Loading pretrained parameter "substructures_encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.149514
Model 0 test R2 Energy = 0.920948
Ensemble test rmse  Energy= 1.149514
Ensemble test R2  Energy= 0.920948
Fold 3
Command line
python ./scripts/SOTA/dmpnn/train.py --dataset_type regression --num_workers 0 --config_path_yaml ./params.yaml
Args
{'activation': 'ReLU',
 'additional_encoder': True,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'config_path_yaml': './params.yaml',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/raw/baselines/dmpnn/train_val_dataset.csv',
 'dataset_type': 'regression',
 'depth': 6,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'ensemble_size': 1,
 'epochs': 100,
 'features_generator': ['rdkit_wo_fragments_and_counts'],
 'features_only': False,
 'features_path': None,
 'features_scaling': False,
 'features_size': 95,
 'ffn_hidden_size': 800,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 800,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'minimize_score': True,
 'multiclass_num_classes': 3,
 'no_cuda': False,
 'no_features_scaling': True,
 'num_folds': 4,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 0,
 'pytorch_seed': 0,
 'quiet': False,
 'save_dir': './data/raw/baselines/dmpnn/logs/exp_309/folds/fold_3',
 'save_smiles_splits': False,
 'seed': 3,
 'separate_test_features_path': None,
 'separate_test_path': './data/3_final_data/split_data/freesolv_test.csv',
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_column': None,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'k-fold',
 'substructures_atom_messages': False,
 'substructures_depth': False,
 'substructures_hidden_size': 300,
 'substructures_merge': False,
 'substructures_undirected': False,
 'substructures_use_substructures': True,
 'symmetry_feature': False,
 'target_columns': ['Energy'],
 'task_names': ['Energy'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': 360,
 'undirected': False,
 'use_input_features': True,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Splitting data with seed 3
Total size = 480 | train size = 360 | val size = 120 | test size = 85
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): MPNEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_i): Linear(in_features=147, out_features=800, bias=False)
      (W_h): Linear(in_features=800, out_features=800, bias=False)
      (W_o): Linear(in_features=933, out_features=800, bias=True)
    )
  )
  (substructures_encoder): SubstructureLayer(
    (encoder): SubstructureEncoder(
      (dropout_layer): Dropout(p=0.0, inplace=False)
      (act_func): ReLU()
      (W_o): Linear(in_features=165, out_features=300, bias=True)
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=1195, out_features=800, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=800, out_features=1, bias=True)
  )
)
Number of parameters = 2,512,201
Moving model to cuda
Epoch 0
Train function
Validation rmse Energy = 4.227294
Validation R2 Energy = -0.080130
Epoch 1
Train function
Loss = 1.5255e-02, PNorm = 55.5967, GNorm = 6.1564, lr_0 = 8.7143e-04
Validation rmse Energy = 2.980860
Validation R2 Energy = 0.462926
Epoch 2
Train function
Loss = 9.3760e-03, PNorm = 55.7355, GNorm = 0.7311, lr_0 = 9.7024e-04
Validation rmse Energy = 2.547802
Validation R2 Energy = 0.607642
Epoch 3
Train function
Validation rmse Energy = 2.123338
Validation R2 Energy = 0.727485
Epoch 4
Train function
Loss = 3.7400e-03, PNorm = 55.8719, GNorm = 1.2005, lr_0 = 9.3194e-04
Validation rmse Energy = 1.678076
Validation R2 Energy = 0.829794
Epoch 5
Train function
Loss = 2.8944e-03, PNorm = 55.9621, GNorm = 0.6740, lr_0 = 9.0118e-04
Validation rmse Energy = 1.651353
Validation R2 Energy = 0.835172
Epoch 6
Train function
Loss = 2.9812e-03, PNorm = 56.0251, GNorm = 2.3298, lr_0 = 8.6851e-04
Loss = 8.9252e-03, PNorm = 56.0300, GNorm = 1.8467, lr_0 = 8.6560e-04
Validation rmse Energy = 1.669489
Validation R2 Energy = 0.831532
Epoch 7
Train function
Validation rmse Energy = 1.590292
Validation R2 Energy = 0.847136
Epoch 8
Train function
Loss = 2.0387e-03, PNorm = 56.1039, GNorm = 0.6934, lr_0 = 8.3422e-04
Validation rmse Energy = 1.424567
Validation R2 Energy = 0.877336
Epoch 9
Train function
Loss = 1.4594e-03, PNorm = 56.1547, GNorm = 1.6997, lr_0 = 8.0398e-04
Validation rmse Energy = 1.506570
Validation R2 Energy = 0.862808
Epoch 10
Train function
Validation rmse Energy = 1.278648
Validation R2 Energy = 0.901178
Epoch 11
Train function
Loss = 1.4387e-03, PNorm = 56.1950, GNorm = 1.1425, lr_0 = 7.7484e-04
Validation rmse Energy = 1.515361
Validation R2 Energy = 0.861202
Epoch 12
Train function
Loss = 1.3982e-03, PNorm = 56.2338, GNorm = 0.6901, lr_0 = 7.4675e-04
Validation rmse Energy = 1.308706
Validation R2 Energy = 0.896477
Epoch 13
Train function
Loss = 9.0592e-04, PNorm = 56.2796, GNorm = 0.6371, lr_0 = 7.1969e-04
Loss = 2.8027e-03, PNorm = 56.2829, GNorm = 1.2185, lr_0 = 7.1727e-04
Validation rmse Energy = 1.195315
Validation R2 Energy = 0.913639
Epoch 14
Train function
Validation rmse Energy = 1.171929
Validation R2 Energy = 0.916986
Epoch 15
Train function
Loss = 7.5695e-04, PNorm = 56.3064, GNorm = 0.7658, lr_0 = 6.9360e-04
Validation rmse Energy = 1.163849
Validation R2 Energy = 0.918126
Epoch 16
Train function
Loss = 5.5917e-04, PNorm = 56.3356, GNorm = 0.5178, lr_0 = 6.6846e-04
Validation rmse Energy = 1.178789
Validation R2 Energy = 0.916011
Epoch 17
Train function
Validation rmse Energy = 1.137699
Validation R2 Energy = 0.921764
Epoch 18
Train function
Loss = 3.7744e-04, PNorm = 56.3643, GNorm = 0.3956, lr_0 = 6.4207e-04
Validation rmse Energy = 1.109132
Validation R2 Energy = 0.925644
Epoch 19
Train function
Loss = 3.1357e-04, PNorm = 56.3870, GNorm = 0.3881, lr_0 = 6.1879e-04
Validation rmse Energy = 1.100357
Validation R2 Energy = 0.926816
Epoch 20
Train function
Loss = 3.4193e-04, PNorm = 56.4066, GNorm = 0.5606, lr_0 = 5.9837e-04
Validation rmse Energy = 1.089610
Validation R2 Energy = 0.928238
Epoch 21
Train function
Validation rmse Energy = 1.080106
Validation R2 Energy = 0.929485
Epoch 22
Train function
Loss = 4.1248e-04, PNorm = 56.4270, GNorm = 1.2485, lr_0 = 5.7475e-04
Validation rmse Energy = 1.128707
Validation R2 Energy = 0.922996
Epoch 23
Train function
Loss = 3.2049e-04, PNorm = 56.4499, GNorm = 0.4523, lr_0 = 5.5391e-04
Validation rmse Energy = 1.048996
Validation R2 Energy = 0.933488
Epoch 24
Train function
Loss = 2.7014e-04, PNorm = 56.4690, GNorm = 0.4488, lr_0 = 5.3383e-04
Validation rmse Energy = 1.122340
Validation R2 Energy = 0.923862
Epoch 25
Train function
Validation rmse Energy = 1.065663
Validation R2 Energy = 0.931358
Epoch 26
Train function
Loss = 2.1831e-04, PNorm = 56.4881, GNorm = 0.1967, lr_0 = 5.1448e-04
Validation rmse Energy = 1.067616
Validation R2 Energy = 0.931106
Epoch 27
Train function
Loss = 1.6086e-04, PNorm = 56.5018, GNorm = 0.3302, lr_0 = 4.9583e-04
Validation rmse Energy = 1.043173
Validation R2 Energy = 0.934225
Epoch 28
Train function
Validation rmse Energy = 1.052707
Validation R2 Energy = 0.933017
Epoch 29
Train function
Loss = 1.9935e-04, PNorm = 56.5164, GNorm = 0.8700, lr_0 = 4.7626e-04
Validation rmse Energy = 1.095936
Validation R2 Energy = 0.927403
Epoch 30
Train function
Loss = 1.7621e-04, PNorm = 56.5310, GNorm = 0.5724, lr_0 = 4.6054e-04
Validation rmse Energy = 1.026671
Validation R2 Energy = 0.936289
Epoch 31
Train function
Loss = 1.5678e-04, PNorm = 56.5429, GNorm = 0.5468, lr_0 = 4.4384e-04
Loss = 1.3194e-03, PNorm = 56.5442, GNorm = 0.4000, lr_0 = 4.4236e-04
Validation rmse Energy = 1.029488
Validation R2 Energy = 0.935939
Epoch 32
Train function
Validation rmse Energy = 1.048761
Validation R2 Energy = 0.933518
Epoch 33
Train function
Loss = 1.5648e-04, PNorm = 56.5596, GNorm = 0.3285, lr_0 = 4.2632e-04
Validation rmse Energy = 1.004371
Validation R2 Energy = 0.939027
Epoch 34
Train function
Loss = 1.1185e-04, PNorm = 56.5721, GNorm = 0.2665, lr_0 = 4.1087e-04
Validation rmse Energy = 1.002690
Validation R2 Energy = 0.939231
Epoch 35
Train function
Validation rmse Energy = 1.019248
Validation R2 Energy = 0.937207
Epoch 36
Train function
Loss = 8.0309e-05, PNorm = 56.5826, GNorm = 0.3282, lr_0 = 3.9597e-04
Validation rmse Energy = 1.006645
Validation R2 Energy = 0.938750
Epoch 37
Train function
Loss = 9.5885e-05, PNorm = 56.5911, GNorm = 0.4243, lr_0 = 3.8162e-04
Validation rmse Energy = 1.010545
Validation R2 Energy = 0.938275
Epoch 38
Train function
Loss = 8.0792e-05, PNorm = 56.5995, GNorm = 0.1771, lr_0 = 3.6779e-04
Loss = 3.2096e-04, PNorm = 56.6003, GNorm = 0.2891, lr_0 = 3.6656e-04
Validation rmse Energy = 0.997418
Validation R2 Energy = 0.939868
Epoch 39
Train function
Validation rmse Energy = 1.006435
Validation R2 Energy = 0.938776
Epoch 40
Train function
Loss = 6.7634e-05, PNorm = 56.6063, GNorm = 0.2035, lr_0 = 3.5446e-04
Validation rmse Energy = 1.027015
Validation R2 Energy = 0.936246
Epoch 41
Train function
Loss = 6.1554e-05, PNorm = 56.6150, GNorm = 0.1020, lr_0 = 3.4161e-04
Validation rmse Energy = 1.012601
Validation R2 Energy = 0.938023
Epoch 42
Train function
Validation rmse Energy = 1.044089
Validation R2 Energy = 0.934109
Epoch 43
Train function
Loss = 8.2279e-05, PNorm = 56.6231, GNorm = 0.5025, lr_0 = 3.2812e-04
Validation rmse Energy = 1.027518
Validation R2 Energy = 0.936184
Epoch 44
Train function
Loss = 6.5286e-05, PNorm = 56.6315, GNorm = 0.4051, lr_0 = 3.1623e-04
Validation rmse Energy = 0.991078
Validation R2 Energy = 0.940630
Epoch 45
Train function
Loss = 6.4163e-05, PNorm = 56.6357, GNorm = 0.1909, lr_0 = 3.0579e-04
Validation rmse Energy = 1.002769
Validation R2 Energy = 0.939221
Epoch 46
Train function
Validation rmse Energy = 1.011743
Validation R2 Energy = 0.938128
Epoch 47
Train function
Loss = 6.4418e-05, PNorm = 56.6422, GNorm = 0.5172, lr_0 = 2.9372e-04
Validation rmse Energy = 0.985223
Validation R2 Energy = 0.941329
Epoch 48
Train function
Loss = 6.1550e-05, PNorm = 56.6479, GNorm = 0.3265, lr_0 = 2.8307e-04
Validation rmse Energy = 1.016244
Validation R2 Energy = 0.937577
Epoch 49
Train function
Loss = 5.7127e-05, PNorm = 56.6540, GNorm = 0.1080, lr_0 = 2.7281e-04
Validation rmse Energy = 0.992389
Validation R2 Energy = 0.940473
Epoch 50
Train function
Validation rmse Energy = 1.010443
Validation R2 Energy = 0.938287
Epoch 51
Train function
Loss = 6.0376e-05, PNorm = 56.6592, GNorm = 0.3384, lr_0 = 2.6292e-04
Validation rmse Energy = 1.018537
Validation R2 Energy = 0.937295
Epoch 52
Train function
Loss = 4.3926e-05, PNorm = 56.6638, GNorm = 0.1051, lr_0 = 2.5339e-04
Validation rmse Energy = 1.011055
Validation R2 Energy = 0.938212
Epoch 53
Train function
Validation rmse Energy = 1.000170
Validation R2 Energy = 0.939536
Epoch 54
Train function
Loss = 4.5208e-05, PNorm = 56.6690, GNorm = 0.3634, lr_0 = 2.4339e-04
Validation rmse Energy = 0.997470
Validation R2 Energy = 0.939862
Epoch 55
Train function
Loss = 3.8319e-05, PNorm = 56.6721, GNorm = 0.1520, lr_0 = 2.3535e-04
Validation rmse Energy = 1.007912
Validation R2 Energy = 0.938596
Epoch 56
Train function
Loss = 3.5546e-05, PNorm = 56.6754, GNorm = 0.1572, lr_0 = 2.2682e-04
Loss = 7.5584e-05, PNorm = 56.6757, GNorm = 0.1394, lr_0 = 2.2606e-04
Validation rmse Energy = 1.006025
Validation R2 Energy = 0.938826
Epoch 57
Train function
Validation rmse Energy = 0.995684
Validation R2 Energy = 0.940077
Epoch 58
Train function
Loss = 2.5867e-05, PNorm = 56.6789, GNorm = 0.1061, lr_0 = 2.1787e-04
Validation rmse Energy = 1.012391
Validation R2 Energy = 0.938049
Epoch 59
Train function
Loss = 3.0715e-05, PNorm = 56.6819, GNorm = 0.1545, lr_0 = 2.0997e-04
Validation rmse Energy = 1.009633
Validation R2 Energy = 0.938386
Epoch 60
Train function
Validation rmse Energy = 1.005570
Validation R2 Energy = 0.938881
Epoch 61
Train function
Loss = 3.0784e-05, PNorm = 56.6850, GNorm = 0.1920, lr_0 = 2.0236e-04
Validation rmse Energy = 1.011253
Validation R2 Energy = 0.938188
Epoch 62
Train function
Loss = 3.7057e-05, PNorm = 56.6874, GNorm = 0.3007, lr_0 = 1.9502e-04
Validation rmse Energy = 1.002548
Validation R2 Energy = 0.939248
Epoch 63
Train function
Loss = 3.2408e-05, PNorm = 56.6908, GNorm = 0.2139, lr_0 = 1.8795e-04
Loss = 1.7131e-04, PNorm = 56.6909, GNorm = 0.2746, lr_0 = 1.8732e-04
Validation rmse Energy = 1.002929
Validation R2 Energy = 0.939202
Epoch 64
Train function
Validation rmse Energy = 1.004588
Validation R2 Energy = 0.939000
Epoch 65
Train function
Loss = 3.2111e-05, PNorm = 56.6927, GNorm = 0.2583, lr_0 = 1.8114e-04
Validation rmse Energy = 0.996249
Validation R2 Energy = 0.940009
Epoch 66
Train function
Loss = 3.5317e-05, PNorm = 56.6957, GNorm = 0.3930, lr_0 = 1.7458e-04
Validation rmse Energy = 0.999420
Validation R2 Energy = 0.939626
Epoch 67
Train function
Validation rmse Energy = 1.002398
Validation R2 Energy = 0.939266
Epoch 68
Train function
Loss = 2.3666e-05, PNorm = 56.6987, GNorm = 0.1535, lr_0 = 1.6768e-04
Validation rmse Energy = 1.003073
Validation R2 Energy = 0.939184
Epoch 69
Train function
Loss = 2.4101e-05, PNorm = 56.7016, GNorm = 0.0769, lr_0 = 1.6161e-04
Validation rmse Energy = 0.997771
Validation R2 Energy = 0.939825
Epoch 70
Train function
Loss = 2.2747e-05, PNorm = 56.7034, GNorm = 0.0520, lr_0 = 1.5627e-04
Validation rmse Energy = 1.011034
Validation R2 Energy = 0.938215
Epoch 71
Train function
Validation rmse Energy = 0.996163
Validation R2 Energy = 0.940019
Epoch 72
Train function
Loss = 1.1562e-05, PNorm = 56.7062, GNorm = 0.0724, lr_0 = 1.5010e-04
Validation rmse Energy = 1.007080
Validation R2 Energy = 0.938697
Epoch 73
Train function
Loss = 2.6178e-05, PNorm = 56.7081, GNorm = 0.1339, lr_0 = 1.4466e-04
Validation rmse Energy = 1.012353
Validation R2 Energy = 0.938054
Epoch 74
Train function
Loss = 2.3364e-05, PNorm = 56.7105, GNorm = 0.1752, lr_0 = 1.3942e-04
Validation rmse Energy = 1.003314
Validation R2 Energy = 0.939155
Epoch 75
Train function
Validation rmse Energy = 1.000724
Validation R2 Energy = 0.939469
Epoch 76
Train function
Loss = 1.8951e-05, PNorm = 56.7122, GNorm = 0.1615, lr_0 = 1.3436e-04
Validation rmse Energy = 1.003415
Validation R2 Energy = 0.939143
Epoch 77
Train function
Loss = 1.9461e-05, PNorm = 56.7140, GNorm = 0.0819, lr_0 = 1.2949e-04
Validation rmse Energy = 1.001392
Validation R2 Energy = 0.939388
Epoch 78
Train function
Validation rmse Energy = 1.000753
Validation R2 Energy = 0.939465
Epoch 79
Train function
Loss = 2.6260e-05, PNorm = 56.7159, GNorm = 0.1633, lr_0 = 1.2438e-04
Validation rmse Energy = 0.999255
Validation R2 Energy = 0.939646
Epoch 80
Train function
Loss = 1.8663e-05, PNorm = 56.7173, GNorm = 0.0935, lr_0 = 1.2027e-04
Validation rmse Energy = 1.012186
Validation R2 Energy = 0.938074
Epoch 81
Train function
Loss = 2.0304e-05, PNorm = 56.7187, GNorm = 0.1702, lr_0 = 1.1592e-04
Loss = 7.9706e-05, PNorm = 56.7188, GNorm = 0.2634, lr_0 = 1.1553e-04
Validation rmse Energy = 1.000365
Validation R2 Energy = 0.939512
Epoch 82
Train function
Validation rmse Energy = 1.000768
Validation R2 Energy = 0.939463
Epoch 83
Train function
Loss = 1.8303e-05, PNorm = 56.7203, GNorm = 0.0398, lr_0 = 1.1134e-04
Validation rmse Energy = 1.004904
Validation R2 Energy = 0.938962
Epoch 84
Train function
Loss = 1.9662e-05, PNorm = 56.7217, GNorm = 0.0660, lr_0 = 1.0730e-04
Validation rmse Energy = 1.008425
Validation R2 Energy = 0.938533
Epoch 85
Train function
Validation rmse Energy = 1.007021
Validation R2 Energy = 0.938705
Epoch 86
Train function
Loss = 2.3971e-05, PNorm = 56.7230, GNorm = 0.0779, lr_0 = 1.0341e-04
Validation rmse Energy = 1.004144
Validation R2 Energy = 0.939054
Epoch 87
Train function
Loss = 1.5778e-05, PNorm = 56.7244, GNorm = 0.0597, lr_0 = 1.0000e-04
Validation rmse Energy = 1.001766
Validation R2 Energy = 0.939343
Epoch 88
Train function
Loss = 1.6235e-05, PNorm = 56.7256, GNorm = 0.0364, lr_0 = 1.0000e-04
Loss = 3.2303e-05, PNorm = 56.7257, GNorm = 0.0799, lr_0 = 1.0000e-04
Validation rmse Energy = 1.002302
Validation R2 Energy = 0.939278
Epoch 89
Train function
Validation rmse Energy = 1.006780
Validation R2 Energy = 0.938734
Epoch 90
Train function
Loss = 1.7020e-05, PNorm = 56.7267, GNorm = 0.0408, lr_0 = 1.0000e-04
Validation rmse Energy = 1.002510
Validation R2 Energy = 0.939253
Epoch 91
Train function
Loss = 1.6110e-05, PNorm = 56.7280, GNorm = 0.1257, lr_0 = 1.0000e-04
Validation rmse Energy = 1.004381
Validation R2 Energy = 0.939026
Epoch 92
Train function
Validation rmse Energy = 1.004488
Validation R2 Energy = 0.939013
Epoch 93
Train function
Loss = 2.4594e-05, PNorm = 56.7293, GNorm = 0.2537, lr_0 = 1.0000e-04
Validation rmse Energy = 1.005516
Validation R2 Energy = 0.938888
Epoch 94
Train function
Loss = 1.1513e-05, PNorm = 56.7305, GNorm = 0.0295, lr_0 = 1.0000e-04
Validation rmse Energy = 1.002902
Validation R2 Energy = 0.939205
Epoch 95
Train function
Loss = 1.1844e-05, PNorm = 56.7316, GNorm = 0.0570, lr_0 = 1.0000e-04
Validation rmse Energy = 1.004076
Validation R2 Energy = 0.939063
Epoch 96
Train function
Validation rmse Energy = 1.003276
Validation R2 Energy = 0.939160
Epoch 97
Train function
Loss = 1.7377e-05, PNorm = 56.7330, GNorm = 0.0995, lr_0 = 1.0000e-04
Validation rmse Energy = 1.006857
Validation R2 Energy = 0.938724
Epoch 98
Train function
Loss = 1.3606e-05, PNorm = 56.7344, GNorm = 0.0539, lr_0 = 1.0000e-04
Validation rmse Energy = 1.005889
Validation R2 Energy = 0.938842
Epoch 99
Train function
Loss = 1.7219e-05, PNorm = 56.7356, GNorm = 0.1077, lr_0 = 1.0000e-04
Validation rmse Energy = 1.000238
Validation R2 Energy = 0.939527
Model 0 best validation rmse = 0.985223 on epoch 47
Loading pretrained parameter "encoder.encoder.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.W_i.weight".
Loading pretrained parameter "encoder.encoder.W_h.weight".
Loading pretrained parameter "encoder.encoder.W_o.weight".
Loading pretrained parameter "encoder.encoder.W_o.bias".
Loading pretrained parameter "substructures_encoder.encoder.cached_zero_vector".
Loading pretrained parameter "substructures_encoder.encoder.W_o.weight".
Loading pretrained parameter "substructures_encoder.encoder.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse Energy = 1.098893
Model 0 test R2 Energy = 0.927757
Ensemble test rmse  Energy= 1.098893
Ensemble test R2  Energy= 0.927757
4-fold cross validation
	Seed 0 ==> test rmse = 1.179577
	Seed 0 ==> test R2 = 0.916759
	Seed 1 ==> test rmse = 1.121221
	Seed 1 ==> test R2 = 0.924791
	Seed 2 ==> test rmse = 1.149514
	Seed 2 ==> test R2 = 0.920948
	Seed 3 ==> test rmse = 1.098893
	Seed 3 ==> test R2 = 0.927757
Overall val rmse Energy= 0.963793 +/- 0.070339
Overall val R2 Energy = 0.934264 +/- 0.015950
Overall test rmse Energy = 1.137301 +/- 0.030291
Overall test R2 Energy = 0.922564 +/- 0.004130
Elapsed time = 0:10:47
